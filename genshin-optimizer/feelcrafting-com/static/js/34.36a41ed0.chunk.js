"use strict";(self.webpackChunkgenshin_optimizer=self.webpackChunkgenshin_optimizer||[]).push([[34],{96034:function(e,n,t){t.r(n),t.d(n,{default:function(){return PageSettings}});var s,a,r,o,i,l,c,d,x,u,h,p,j,Z,g=t(39504),f=t(20890),m=t(94721),b=t(10757),v=t(22020),C=t(76899),y=t(3992),w=t(29439),D=t(30168),k=t(53174),I=t(74223),P=t(80184),O=(0,I.Z)((0,P.jsx)("path",{d:"M9 3 5 6.99h3V14h2V6.99h3L9 3zm7 14.01V10h-2v7.01h-3L15 21l4-3.99h-3z"}),"ImportExport"),S=(0,I.Z)((0,P.jsx)("path",{d:"M5 20h14v-2H5v2zm0-10h4v6h6v-6h4l-7-7-7 7z"}),"Upload"),K=t(72456),M=(0,I.Z)((0,P.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),G=t(61889),z=t(24518),L=t(81918),B=t(64554),H=t(72791),R=t(71310),V=t(10600),E=t(82095),W=t(9321),T=t(66101),$=t(24711),U=t(60393),_=t(74165),F=t(15861),N=t(54483),A=(0,I.Z)((0,P.jsx)("path",{d:"M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.89 2 1.99 2H15v-8h5V8l-6-6zm-1 7V3.5L18.5 9H13zm4 12.66V16h5.66v2h-2.24l2.95 2.95-1.41 1.41L19 19.41v2.24h-2z"}),"FileOpen"),J=t(9912),Y=t(72247),q=t(66934),Q=t(40165),X=t(23741),ee=(0,q.ZP)("input")({display:"none"});function UploadCard(e){var n,t=e.index,d=e.onReplace,x=(0,H.useContext)(T.t).databases[t],u=(0,v.$)("settings").t,h=(0,H.useState)(""),p=(0,w.Z)(h,2),j=p[0],Z=p[1],m=(0,H.useState)(""),b=(0,w.Z)(m,2),I=b[0],O=b[1],S=(0,H.useState)(""),K=(0,w.Z)(S,2),M=K[0],L=K[1],V=(0,H.useState)(!1),E=(0,w.Z)(V,2),W=E[0],$=E[1],U=(0,H.useState)(!1),q=(0,w.Z)(U,2),ne=q[0],te=q[1],se=null!==(n=(0,H.useMemo)((function(){if(j){var e;try{if("object"!==typeof(e=JSON.parse(j)))return void L("uploadCard.error.jsonParse")}catch(r){return void L("uploadCard.error.jsonParse")}if("GOOD"===e.format){var n=new X.N;n.copyFrom(x.storage);var s=new T.M(t+1,n),a=s.importGOOD(e,W,ne);return a?{importResult:a,importedDatabase:s}:void L("uploadCard.error.goInvalid")}L("uploadCard.error.unknown")}}),[j,x,W,ne,t]))&&void 0!==n?n:{},ae=se.importResult,re=se.importedDatabase,oe=function(){var e=(0,F.Z)((0,_.Z)().mark((function _callee(e){var n,t;return(0,_.Z)().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:n=e.target.files[0],e.target.value=null,n&&O(n.name),(t=new FileReader).onload=function(){return Z(t.result)},t.readAsText(n);case 6:case"end":return s.stop()}}),_callee)})));return function onUpload(n){return e.apply(this,arguments)}}();return(0,P.jsxs)(R.Z,{children:[(0,P.jsx)(g.Z,{sx:{py:1},children:(0,P.jsx)(C.c,{t:u,i18nKey:"settings:uploadCard.title"})}),(0,P.jsxs)(g.Z,{children:[(0,P.jsxs)(G.ZP,{container:!0,spacing:2,sx:{mb:1},children:[(0,P.jsx)(G.ZP,{item:!0,children:(0,P.jsxs)("label",{htmlFor:"icon-button-file",children:[(0,P.jsx)(ee,{accept:".json",id:"icon-button-file",type:"file",onChange:oe}),(0,P.jsx)(z.Z,{component:"span",color:"info",startIcon:(0,P.jsx)(A,{}),children:u(s||(s=(0,D.Z)(["uploadCard.buttons.open"])))})]})}),(0,P.jsx)(G.ZP,{item:!0,flexGrow:1,children:(0,P.jsx)(y.Z,{sx:{px:2,py:1},children:(0,P.jsx)(f.Z,{children:I?(0,P.jsxs)("span",{children:[(0,P.jsx)(N.G,{icon:k.w49})," ",I]}):(0,P.jsxs)("span",{children:[(0,P.jsx)(N.G,{icon:k.acZ})," ",(0,P.jsx)(C.c,{t:u,i18nKey:"settings:uploadCard.hint"})]})})})})]}),(0,P.jsxs)(B.Z,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[(0,P.jsx)(Q.Z,{title:(0,P.jsx)(f.Z,{children:u(ne?a||(a=(0,D.Z)(["uploadCard.tooltip.ignoreDup"])):r||(r=(0,D.Z)(["uploadCard.tooltip.detectdup"])))}),placement:"top",arrow:!0,children:(0,P.jsx)(B.Z,{sx:{flexGrow:1,flexBasis:"10em"},children:(0,P.jsx)(z.Z,{fullWidth:!0,disabled:!j,color:ne?"primary":"success",onClick:function onClick(){return te(!ne)},startIcon:ne?(0,P.jsx)(J.Z,{}):(0,P.jsx)(Y.Z,{}),children:u(o||(o=(0,D.Z)(["uploadCard.buttons.detectDups"])))})})}),(0,P.jsx)(Q.Z,{title:(0,P.jsx)(f.Z,{children:u(W?i||(i=(0,D.Z)(["uploadCard.tooltip.keepNotInImport"])):l||(l=(0,D.Z)(["uploadCard.tooltip.delNotInImport"])))}),placement:"top",arrow:!0,children:(0,P.jsx)(B.Z,{sx:{flexGrow:1,flexBasis:"10em"},children:(0,P.jsx)(z.Z,{fullWidth:!0,disabled:!j,color:W?"primary":"success",onClick:function onClick(){return $(!W)},startIcon:W?(0,P.jsx)(J.Z,{}):(0,P.jsx)(Y.Z,{}),children:u(c||(c=(0,D.Z)(["uploadCard.buttons.delNotInImport"])))})})})]}),(0,P.jsx)(f.Z,{gutterBottom:!0,variant:"caption",children:(0,P.jsx)(C.c,{t:u,i18nKey:"settings:uploadCard.hintPaste"})}),(0,P.jsx)(B.Z,{component:"textarea",sx:{width:"100%",fontFamily:"monospace",minHeight:"10em",mb:2,resize:"vertical"},value:j,onChange:function onChange(e){return Z(e.target.value)}}),ae&&re?(0,P.jsx)(GOODUploadInfo,{importResult:ae,importedDatabase:re}):u(M)]}),(0,P.jsx)(GOUploadAction,{index:t,importedDatabase:re,reset:function reset(){Z(""),O(""),d()}})]})}function GOODUploadInfo(e){var n=e.importResult,t=n.source,s=n.artifacts,a=n.characters,r=n.weapons,o=e.importedDatabase,i=(0,v.$)("settings").t;return(0,P.jsxs)(y.Z,{children:[(0,P.jsx)(g.Z,{sx:{py:1},children:(0,P.jsxs)(f.Z,{children:[(0,P.jsx)(C.c,{t:i,i18nKey:"uploadCard.dbSource"}),(0,P.jsxs)("strong",{children:[" ",t]})]})}),(0,P.jsx)(m.Z,{}),(0,P.jsx)(g.Z,{children:(0,P.jsxs)(G.ZP,{container:!0,spacing:2,children:[(0,P.jsx)(G.ZP,{item:!0,flexGrow:1,children:(0,P.jsx)(MergeResult,{result:s,dbTotal:o.arts.values.length,type:"arts"})}),(0,P.jsx)(G.ZP,{item:!0,flexGrow:1,children:(0,P.jsx)(MergeResult,{result:r,dbTotal:o.weapons.values.length,type:"weapons"})}),(0,P.jsx)(G.ZP,{item:!0,flexGrow:1,children:(0,P.jsx)(MergeResult,{result:a,dbTotal:o.chars.values.length,type:"chars"})})]})})]})}function MergeResult(e){var n,t=e.result,s=e.dbTotal,a=e.type,r=(0,v.$)("settings").t,o=t.import;return(0,P.jsxs)(R.Z,{children:[(0,P.jsx)(g.Z,{sx:{py:1},children:(0,P.jsxs)(f.Z,{children:[(0,P.jsx)(C.c,{t:r,i18nKey:"count.".concat(a)})," ",o]})}),(0,P.jsx)(m.Z,{}),(0,P.jsxs)(g.Z,{children:[(0,P.jsxs)(f.Z,{children:[(0,P.jsx)(C.c,{t:r,i18nKey:"count.new"})," ",(0,P.jsx)("strong",{children:t.new.length})," / ",o]}),(0,P.jsxs)(f.Z,{children:[(0,P.jsx)(C.c,{t:r,i18nKey:"count.unchanged"})," ",(0,P.jsx)("strong",{children:t.unchanged.length})," / ",o]}),(0,P.jsxs)(f.Z,{children:[(0,P.jsx)(C.c,{t:r,i18nKey:"count.upgraded"})," ",(0,P.jsx)("strong",{children:t.upgraded.length})," / ",o]}),!!t.remove.length&&(0,P.jsxs)(f.Z,{color:"warning.main",children:[(0,P.jsx)(C.c,{t:r,i18nKey:"count.removed"})," ",(0,P.jsx)("strong",{children:t.remove.length})]}),!!t.notInImport&&(0,P.jsxs)(f.Z,{children:[(0,P.jsx)(C.c,{t:r,i18nKey:"count.notInImport"})," ",(0,P.jsx)("strong",{children:t.notInImport})]}),(0,P.jsxs)(f.Z,{children:[(0,P.jsx)(C.c,{t:r,i18nKey:"count.dbTotal"})," ",(0,P.jsx)("strong",{children:t.beforeMerge})," -> ",(0,P.jsx)("strong",{children:s})]}),!(null===(n=t.invalid)||void 0===n||!n.length)&&(0,P.jsxs)("div",{children:[(0,P.jsxs)(f.Z,{color:"error.main",children:[(0,P.jsx)(C.c,{t:r,i18nKey:"count.invalid"})," ",(0,P.jsx)("strong",{children:t.invalid.length})," / ",o]}),(0,P.jsx)(B.Z,{component:"textarea",sx:{width:"100%",fontFamily:"monospace",minHeight:"10em",resize:"vertical"},value:JSON.stringify(t.invalid,void 0,2),disabled:!0})]})]})]})}function GOUploadAction(e){var n=e.index,t=e.importedDatabase,s=e.reset,a=(0,H.useContext)(T.t),r=a.databases,o=a.setDatabase,i=r[n],l=(0,v.$)("settings").t,c=(0,H.useCallback)((function(){t&&(t.swapStorage(i),o(n,t),t.toExtraLocalDB(),s())}),[i,n,t,s,o]);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(m.Z,{}),(0,P.jsx)(g.Z,{sx:{py:1},children:(0,P.jsx)(z.Z,{color:t?"success":"error",disabled:!t,onClick:c,startIcon:(0,P.jsx)(N.G,{icon:k.Y9i}),children:(0,P.jsx)(C.c,{t:l,i18nKey:"settings:uploadCard.replaceDatabase"})})})]})}function DatabaseCard(){var e=(0,v.$)(["settings"]).t;return(0,P.jsxs)(R.Z,{children:[(0,P.jsx)(g.Z,{sx:{py:1},children:(0,P.jsx)(f.Z,{variant:"subtitle1",children:e(d||(d=(0,D.Z)(["DatabaseCard.title"])))})}),(0,P.jsx)(m.Z,{}),(0,P.jsx)(g.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:(0,P.jsx)(G.ZP,{container:!0,spacing:2,columns:{xs:1,md:2},children:(0,U.w6)(0,3).map((function(e){return(0,P.jsx)(G.ZP,{item:!0,xs:1,children:(0,P.jsx)(DataCard,{index:e})},e)}))})})]})}function DataCard(e){var n=e.index,t=(0,H.useContext)(T.t),s=t.databases,a=t.database,r=t.setDatabase,o=s[n],i=(0,H.useState)(o.dbMeta.get()),l=(0,w.Z)(i,2),c=l[0],d=c.name,b=c.lastEdit,I=l[1];(0,H.useEffect)((function(){return o.dbMeta.follow((function(e,n){return I(n)}))}),[o]),(0,H.useEffect)((function(){return I(o.dbMeta.get())}),[o]);var R=a===o,U=(0,$.Z)(),_=(0,w.Z)(U,3),F=_[0],N=_[1],A=_[2],J=(0,v.$)(["settings"]).t,Y=o.chars.keys.length,q=o.arts.values.length,Q=o.weapons.values.length,X=Boolean(Y||q||Q),ee=(0,H.useCallback)((function(){return navigator.clipboard.writeText(JSON.stringify(o.exportGOOD())).then((function(){return alert("Copied database to clipboard.")})).catch(console.error)}),[o]),ne=(0,H.useCallback)((function(){window.confirm('Are you sure you want to delete "'.concat(d,'"?'))&&(o.clear(),o.toExtraLocalDB())}),[o,d]),te=(0,H.useCallback)((function(){var e=(new Date).toISOString().split(".")[0].replace("T","_").replaceAll(":","-"),n=JSON.stringify(o.exportGOOD()),t="".concat(d.trim().replaceAll(" ","_"),"_").concat(e,".json"),s=document.createElement("a");s.download=t,s.href="data:".concat("application/json;charset=utf-8",",").concat(encodeURIComponent(n)),s.target="_blank",document.body.appendChild(s),s.click(),document.body.removeChild(s)}),[o,d]),se=(0,H.useCallback)((function(){R||(a.toExtraLocalDB(),o.swapStorage(a),r(n,o))}),[n,r,a,R,o]),ae=(0,H.useState)(d),re=(0,w.Z)(ae,2),oe=re[0],ie=re[1];(0,H.useEffect)((function(){return ie(d)}),[d]);var le=(0,H.useCallback)((function(){o.dbMeta.set({name:oe}),o.toExtraLocalDB()}),[oe,o]),ce=(0,H.useCallback)((function(e){return"Enter"===e.key&&le()}),[le]);return(0,P.jsxs)(y.Z,{sx:{height:"100%",boxShadow:R?"0px 0px 0px 2px green inset":void 0},children:[(0,P.jsxs)(g.Z,{sx:{display:"flex",gap:1,justifyContent:"space-between"},children:[(0,P.jsx)(V.el,{value:oe,sx:{borderRadius:1,px:1,flexGrow:1},onChange:function onChange(e){return ie(e.target.value)},onBlur:le,onKeyDown:ce}),!R&&(0,P.jsx)(z.Z,{startIcon:(0,P.jsx)(O,{}),onClick:se,color:"warning",children:J(x||(x=(0,D.Z)(["DatabaseCard.button.swap"])))}),(0,P.jsx)(L.Z,{color:R?"success":"secondary",label:R?J(u||(u=(0,D.Z)(["DatabaseCard.currentDB"]))):"".concat(J(h||(h=(0,D.Z)(["DatabaseCard.title"])))," ").concat(o.dbIndex)})]}),(0,P.jsx)(m.Z,{}),(0,P.jsx)(g.Z,{children:(0,P.jsxs)(B.Z,{display:"flex",gap:2,children:[(0,P.jsxs)(B.Z,{flexGrow:1,children:[(0,P.jsxs)(f.Z,{noWrap:!0,children:[(0,P.jsx)(C.c,{t:J,i18nKey:"count.chars"})," ",(0,P.jsx)("strong",{children:Y})]}),(0,P.jsxs)(f.Z,{noWrap:!0,children:[(0,P.jsx)(C.c,{t:J,i18nKey:"count.arts"})," ",(0,P.jsx)("strong",{children:q})]}),(0,P.jsxs)(f.Z,{noWrap:!0,children:[(0,P.jsx)(C.c,{t:J,i18nKey:"count.weapons"})," ",(0,P.jsx)("strong",{children:Q})]}),!!b&&(0,P.jsx)(f.Z,{noWrap:!0,children:(0,P.jsx)("strong",{children:new Date(b).toLocaleString()})})]}),(0,P.jsx)(B.Z,{children:(0,P.jsxs)(G.ZP,{container:!0,spacing:1,columns:{xs:2},children:[(0,P.jsx)(G.ZP,{item:!0,xs:1,children:(0,P.jsx)(z.Z,{fullWidth:!0,disabled:!X,color:"info",onClick:ee,startIcon:(0,P.jsx)(E.Z,{icon:k.Yjj}),children:(0,P.jsx)(C.c,{t:J,i18nKey:"DatabaseCard.button.copy"})})}),(0,P.jsxs)(G.ZP,{item:!0,xs:1,children:[(0,P.jsx)(W.Z,{open:F,onClose:A,children:(0,P.jsx)(UploadCard,{index:n,onReplace:A})}),(0,P.jsx)(z.Z,{fullWidth:!0,component:"span",color:"info",startIcon:(0,P.jsx)(S,{}),onClick:N,children:J(p||(p=(0,D.Z)(["DatabaseCard.button.upload"])))})]}),(0,P.jsx)(G.ZP,{item:!0,xs:1,children:(0,P.jsx)(z.Z,{fullWidth:!0,disabled:!X,onClick:te,startIcon:(0,P.jsx)(K.Z,{}),children:J(j||(j=(0,D.Z)(["DatabaseCard.button.download"])))})}),(0,P.jsx)(G.ZP,{item:!0,xs:1,children:(0,P.jsx)(z.Z,{fullWidth:!0,disabled:!X,color:"error",onClick:ne,startIcon:(0,P.jsx)(M,{}),children:J(Z||(Z=(0,D.Z)(["DatabaseCard.button.delete"])))})})]})})]})})]})}var ne=t(23786),te=t(33890),se=t(25617),ae=t(72828);function LanguageCard(){var e=(0,v.$)().t;return(0,P.jsxs)(R.Z,{children:[(0,P.jsxs)(g.Z,{sx:{py:1},children:[e("settings:languageCard.selectLanguage")," ",(0,P.jsx)(se.Z,{color:"warning",children:e("ui:underConstruction")})]}),(0,P.jsx)(m.Z,{}),(0,P.jsx)(g.Z,{children:(0,P.jsx)(LanguageDropdown,{})})]})}var re={chs:"\u7b80\u4f53\u4e2d\u6587",cht:"\u7e41\u9ad4\u4e2d\u6587",de:"Deutsch",en:"English",es:"espa\xf1ol",fr:"fran\xe7ais",id:"Bahasa Indonesia",ja:"\u65e5\u672c\u8a9e",ko:"\ud55c\uad6d\uc5b4",pt:"Portugu\xeas",ru:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a",th:"\u0e20\u0e32\u0e29\u0e32\u0e44\u0e17\u0e22",vi:"Ti\u1ebfng Vi\u1ec7t"};function LanguageDropdown(){var e=(0,v.$)(["ui","settings"]),n=e.t,t=e.i18n,s=function onSetLanguage(e){return function(){return t.changeLanguage(e)}},a=t.languages[0];return(0,P.jsx)(te.Z,{fullWidth:!0,title:n("settings:languageCard.languageFormat",{language:n("languages:".concat(a))}),children:ae.C.map((function(e){return(0,P.jsxs)(ne.Z,{selected:a===e,disabled:a===e,onClick:s(e),children:[(0,P.jsx)(C.c,{i18nKey:"languages:".concat(e)}),e!==a?" (".concat(re[e],")"):""]},e)}))})}function PageSettings(){var e=(0,v.$)(["settings"]).t;return b.ZP.send({hitType:"pageview",page:"/setting"}),(0,P.jsxs)(y.Z,{sx:{my:1},children:[(0,P.jsx)(g.Z,{sx:{py:1},children:(0,P.jsx)(f.Z,{variant:"subtitle1",children:(0,P.jsx)(C.c,{t:e,i18nKey:"title"})})}),(0,P.jsx)(m.Z,{}),(0,P.jsxs)(g.Z,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,P.jsx)(LanguageCard,{}),(0,P.jsx)(DatabaseCard,{})]})]})}},72247:function(e,n,t){var s=t(74223),a=t(80184);n.Z=(0,s.Z)((0,a.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox")},9912:function(e,n,t){var s=t(74223),a=t(80184);n.Z=(0,s.Z)((0,a.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank")},72456:function(e,n,t){var s=t(74223),a=t(80184);n.Z=(0,s.Z)((0,a.jsx)("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download")}}]);
//# sourceMappingURL=34.36a41ed0.chunk.js.map