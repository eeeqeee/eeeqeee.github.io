"use strict";(self.webpackChunkgenshin_optimizer=self.webpackChunkgenshin_optimizer||[]).push([[213],{70867:function(e,t,n){n.d(t,{mY:function(){return ArtifactMainStatMultiAutocomplete},N5:function(){return ArtifactSetMultiAutocomplete},Y4:function(){return ArtifactSetSingleAutocomplete},mW:function(){return ArtifactSubstatMultiAutocomplete}});var r=n(29439),a=n(1413),i=n(45987),s=n(13967),o=n(94198),l=n(58165),c=n(81918),u=n(90493),d=n(64554),f=n(79834),h=n(72791),p=n(22020),x=n(31148),m=n(72828),y=n(79406),v=n(42320),g=n(50765),Z=n(24351),j=n(91702),b=n(23786),S=n(57064),k=n(49900),w=n(80184);function MenuItemWithImage(e){var t=e.value,n=e.image,r=void 0===n?"":n,i=e.text,s=e.theme,o=e.isSelected,l=e.addlElement,c=e.props;return(0,w.jsxs)(b.Z,(0,a.Z)((0,a.Z)({value:t},c),{},{children:[(0,w.jsx)(S.Z,{children:r}),(0,w.jsx)(k.Z,{primaryTypographyProps:{style:{fontWeight:o?s.typography.fontWeightMedium:s.typography.fontWeightRegular}},children:i}),l&&l]}),t)}var K=n(68244),C=n(10157),A=n(75545),P=["allArtifactKeysWithGrouper","selectedArtifactKeys","setArtifactKeys","getName","getImage","label"],I=["artSetKeys","setArtSetKeys"],T=["mainStatKeys","setMainStatKeys"],M=["substatKeys","setSubstatKeys"],_=["allArtifactKeysWithGrouper","selectedArtifactKey","setArtifactKey","getName","getImage","label","disable","showDefault","defaultText","defaultIcon"],E=["artSetKey","setArtSetKey","label"];function ArtifactMultiAutocomplete(e){var t=e.allArtifactKeysWithGrouper,n=e.selectedArtifactKeys,r=e.setArtifactKeys,u=e.getName,d=e.getImage,f=e.label,p=(0,i.Z)(e,P),x=(0,s.Z)(),m=(0,h.useMemo)((function(){return t.map((function(e){var t=e.key,n=e.grouper;return{key:t,label:u(t),grouper:n}}))}),[t,u]);return(0,w.jsx)(o.Z,(0,a.Z)({autoHighlight:!0,multiple:!0,disableCloseOnSelect:!0,options:m,value:n.map((function(e){return{key:e,label:u(e)}})),onChange:function handleChange(e,t){r(t.map((function(e){return e.key})))},getOptionLabel:function getOptionLabel(e){return e.label},isOptionEqualToValue:function isOptionEqualToValue(e,t){return e.key===t.key},renderInput:function renderInput(e){return(0,w.jsx)(l.Z,(0,a.Z)((0,a.Z)({},e),{},{label:f,variant:"filled",InputLabelProps:{style:{color:x.palette.text.primary}},color:n.length?"success":"primary",type:"search"}))},renderOption:function renderOption(e,t){return(0,w.jsx)(MenuItemWithImage,{value:t.key,image:(0,w.jsx)(j.Z,{color:y.ZP.getVariant(t.key),children:d(t.key)}),text:(0,w.jsx)(j.Z,{color:y.ZP.getVariant(t.key),children:t.label}),theme:x,isSelected:n.includes(t.key),props:e},t.key)},renderTags:function renderTags(e,t){return e.map((function(e,n){var r=Z.Kj.find((function(t){return e.key==="".concat(t,"_dmg_")})),i=r||void 0;return(0,h.createElement)(c.Z,(0,a.Z)((0,a.Z)({},t({index:n})),{},{key:e.key,icon:d(e.key),label:e.label,color:i}))}))}},p))}function ArtifactSetMultiAutocomplete(e){var t=e.artSetKeys,n=e.setArtSetKeys,s=(0,i.Z)(e,I),o=(0,v.Z)((function(){return x.y.getAll}),[]),l=(0,p.$)(["artifact","artifactNames_gen"]).t;if(!o)return null;var c=Object.entries(x.y.setKeysByRarities(o)).flatMap((function(e){var t=(0,r.Z)(e,2),n=t[0];return t[1].map((function(e){return{key:e,grouper:+n}}))})).sort(sortByRarityAndName);return(0,w.jsx)(ArtifactMultiAutocomplete,(0,a.Z)({allArtifactKeysWithGrouper:c,selectedArtifactKeys:t,setArtifactKeys:n,getName:function getName(e){return l("artifactNames_gen:".concat(e))},getImage:function getImage(e){return o(e).defIcon},label:l("artifact:autocompleteLabels.sets"),groupBy:function groupBy(e){var t,n;return null!==(t=null===(n=e.grouper)||void 0===n?void 0:n.toString())&&void 0!==t?t:""},renderGroup:function renderGroup(e){return e.group&&(0,w.jsxs)(u.Z,{component:d.Z,children:[(0,w.jsxs)(f.Z,{sx:{top:"-1em"},children:[e.group," ",(0,w.jsx)(C.q,{stars:+e.group})]},"".concat(e.group,"Header")),e.children]},e.group)}},s))}function ArtifactMainStatMultiAutocomplete(e){var t=e.mainStatKeys,n=e.setMainStatKeys,r=(0,i.Z)(e,T),s=(0,p.$)("artifact").t;return(0,w.jsx)(ArtifactMultiAutocomplete,(0,a.Z)({allArtifactKeysWithGrouper:g.r.map((function(e){return{key:e}})),selectedArtifactKeys:t,setArtifactKeys:n,getName:function getName(e){return y.ZP.getArtStr(e)},getImage:function getImage(e){return A.Z[e]},label:s("autocompleteLabels.mainStats")},r))}function ArtifactSubstatMultiAutocomplete(e){var t=e.substatKeys,n=e.setSubstatKeys,r=(0,i.Z)(e,M),s=(0,p.$)("artifact").t;return(0,w.jsx)(ArtifactMultiAutocomplete,(0,a.Z)({allArtifactKeysWithGrouper:g._.map((function(e){return{key:e}})),selectedArtifactKeys:t,setArtifactKeys:n,getName:function getName(e){return y.ZP.getArtStr(e)},getImage:function getImage(e){return A.Z[e]},label:s("autocompleteLabels.substats")},r))}function ArtifactSingleAutocomplete(e){var t=e.allArtifactKeysWithGrouper,n=e.selectedArtifactKey,r=e.setArtifactKey,l=e.getName,c=e.getImage,u=e.label,d=e.disable,f=void 0===d?function(){return!1}:d,p=e.showDefault,x=void 0!==p&&p,m=e.defaultText,y=void 0===m?"":m,v=(e.defaultIcon,(0,i.Z)(e,_)),g=(0,s.Z)(),Z=(0,h.useMemo)((function(){return(x?[{key:"",label:y}]:[]).concat(t.map((function(e){var t=e.key,n=e.grouper;return{key:t,label:l(t),grouper:n}})))}),[t,l,y,x]);return(0,w.jsx)(o.Z,(0,a.Z)({autoHighlight:!0,options:Z,clearIcon:n?void 0:"",value:{key:n,label:l(n)},onChange:function onChange(e,t,n){return("change"!==e.type||"clear"!==n)&&r(t?t.key:"")},getOptionLabel:function getOptionLabel(e){return e.label?e.label:y},isOptionEqualToValue:function isOptionEqualToValue(e,t){return e.key===t.key},getOptionDisabled:function getOptionDisabled(e){return f(e.key)},renderInput:function renderInput(e){return(0,w.jsx)(K.Z,(0,a.Z)((0,a.Z)({},e),{},{label:u,startAdornment:c(n),hasValue:!!n}))},renderOption:function renderOption(e,t){return(0,w.jsx)(MenuItemWithImage,{value:t.key,image:c(t.key),text:t.label,theme:g,isSelected:n===t.key,props:e},t.key)}},v))}function ArtifactSetSingleAutocomplete(e){var t=e.artSetKey,n=e.setArtSetKey,s=e.label,o=void 0===s?"":s,l=(0,i.Z)(e,E),c=(0,v.Z)((function(){return x.y.getAll}),[]),h=(0,p.$)(["artifact","artifactNames_gen"]).t;if(o=o||h("artifact:autocompleteLabels.set"),!c)return null;var m=Object.entries(x.y.setKeysByRarities(c)).flatMap((function(e){var t=(0,r.Z)(e,2),n=t[0];return t[1].map((function(e){return{key:e,grouper:+n}}))})).sort(sortByRarityAndName);return(0,w.jsx)(ArtifactSingleAutocomplete,(0,a.Z)({allArtifactKeysWithGrouper:m,selectedArtifactKey:t,setArtifactKey:n,getName:function getName(e){return e&&h("artifactNames_gen:".concat(e))},getImage:function getImage(e){return e?c(e).defIcon:(0,w.jsx)(w.Fragment,{})},label:o,groupBy:function groupBy(e){var t,n;return null!==(t=null===(n=e.grouper)||void 0===n?void 0:n.toString())&&void 0!==t?t:""},renderGroup:function renderGroup(e){return e.group&&(0,w.jsxs)(u.Z,{component:d.Z,children:[(0,w.jsxs)(f.Z,{sx:{top:"-1em"},children:[e.group," ",(0,w.jsx)(C.q,{stars:+e.group})]},"".concat(e.group,"Header")),e.children]},e.group)}},l))}function sortByRarityAndName(e,t){if(e.grouper>t.grouper)return-1;if(e.grouper<t.grouper)return 1;var n=m.Z.t("artifactNames_gen:".concat(e.key)),r=m.Z.t("artifactNames_gen:".concat(t.key));return n<r?-1:n>r?1:0}},92443:function(e,t,n){n.d(t,{Z:function(){return TextButton}});var r=n(1413),a=n(45987),i=n(66934),s=n(24518),o=n(80184),l=["children","disabled"],c=(0,i.ZP)(s.Z)((function(e){var t=e.theme;return{"&.Mui-disabled":{backgroundColor:t.palette.primary.dark,color:t.palette.text.secondary}}}));function TextButton(e){var t=e.children,n=(e.disabled,(0,a.Z)(e,l));return(0,o.jsx)(c,(0,r.Z)((0,r.Z)({},n),{},{disabled:!0,children:t}))}},66585:function(e,t,n){n.r(t),n.d(t,{default:function(){return ArtifactEditor}});var r,a=n(30168),i=n(93433),s=n(29439),o=n(1413),l=n(53174),c=n(54483),u=n(43245),d=n(98268),f=n(68087),h=n(49670),p=n(54091),x=n(66934),m=n(13967),y=n(95193),v=n(47047),g=n(9585),Z=n(39504),j=n(61889),b=n(64554),S=n(2199),k=n(24518),w=n(20890),K=n(23786),C=n(13239),A=n(94070),P=n(72791),I=n(22020),T=n(76899),M=n(70867),_=n(45987),E=n(24351),R=n(33890),F=n(10157),N=n(80184),O=["rarity","onChange","filter"];function ArtifactRarityDropdown(e){var t=e.rarity,n=e.onChange,i=e.filter,s=(0,_.Z)(e,O),l=(0,I.$)("artifact").t;return(0,N.jsx)(R.Z,(0,o.Z)((0,o.Z)({},s),{},{title:t?(0,N.jsx)(F.q,{stars:t}):l(r||(r=(0,a.Z)(["editor.rarity"]))),color:t?"success":"primary",children:[5,4,3].map((function(e){return(0,N.jsx)(K.Z,{disabled:!i(e),onClick:function onClick(){return n(e)},children:(0,N.jsx)(F.q,{stars:e})},e)}))}))}var D,W=n(57064),B=n(49900),G=n(94721),L=n(95614),V=["slotKey","onChange","hasUnselect"];function ArtifactSlotDropdown(e){var t=e.slotKey,n=void 0===t?"":t,r=e.onChange,i=e.hasUnselect,s=void 0!==i&&i,l=(0,_.Z)(e,V),c=(0,I.$)(["artifact","ui"]).t;return(0,N.jsxs)(R.Z,(0,o.Z)((0,o.Z)({title:c(n?"artifact:slotName:".concat(n):"artifact:slot"),color:n?"success":"primary",startIcon:n?(0,L.Ir)(n):void 0},l),{},{children:[s&&(0,N.jsxs)(K.Z,{selected:""===n,disabled:""===n,onClick:function onClick(){return r("")},children:[(0,N.jsx)(W.Z,{children:(0,N.jsx)(h.Z,{})}),(0,N.jsx)(B.Z,{children:c(D||(D=(0,a.Z)(["ui:unselect"])))})]}),s&&(0,N.jsx)(G.Z,{}),E.eV.map((function(e){return(0,N.jsxs)(K.Z,{selected:n===e,disabled:n===e,onClick:function onClick(){return r(e)},children:[(0,N.jsx)(W.Z,{children:(0,L.Ir)(e)}),(0,N.jsx)(B.Z,{children:c("artifact:slotName:".concat(e))})]},e)}))]}))}var U=n(3992),z=n(71310),q=n(68198),$=n(58165),H=["value","onChange","disabled","float"];function CustomNumberTextField(e){var t=e.value,n=e.onChange,r=e.disabled,a=void 0!==r&&r,i=e.float,l=void 0!==i&&i,c=(0,_.Z)(e,H),u=(0,P.useState)(""),d=(0,s.Z)(u,2),f=d[0],h=d[1],p=(0,P.useCallback)((function(){if(""===f)return n(0);var e=l?parseFloat:parseInt;n(e(f))}),[n,f,l]);return(0,P.useEffect)((function(){var e;return h(null!==(e=null===t||void 0===t?void 0:t.toString())&&void 0!==e?e:"")}),[t,h]),(0,N.jsx)($.Z,(0,o.Z)({value:f,"aria-label":"custom-input",type:"number",onChange:function onChange(e){return h(e.target.value)},onBlur:p,disabled:a,onKeyDown:function onKeyDown(e){return"Enter"===e.key&&p()}},c))}var Y=n(55942),X=n(9321),J=n(87174),Q=n(75545),ee=n(98620),te=n(31148),ne=n(51329),re=n(66101),ae=n(79406),ie=n(68544),se=n(42320),oe=n(50765),le=JSON.parse('{"5":{"def_":{"24.0":"24.1"},"critRate_":{"8.5":"8.6","19.5":"19.4","23.0":"22.9"}}}');var ce=n(60393),ue=n(72838),de=n(55221),fe=n(901);function SubstatEfficiencyDisplayCard(e){var t=e.efficiency,n=e.max,r=void 0!==n&&n,a=e.t,i=e.valid,s=r?"maxSubEff":"curSubEff";return(0,N.jsx)(z.Z,{sx:{py:1,px:2},children:(0,N.jsxs)(j.ZP,{container:!0,spacing:1,children:[(0,N.jsx)(j.ZP,{item:!0,children:a("editor.".concat(s))}),(0,N.jsx)(j.ZP,{item:!0,flexGrow:1,children:(0,N.jsx)(de.Z,{title:(0,N.jsxs)("span",{children:[(0,N.jsx)(w.Z,{variant:"h6",children:a("editor.".concat(s))}),(0,N.jsx)(w.Z,{children:(0,N.jsx)(T.c,{t:a,i18nKey:"editor.".concat(s,"Desc")})})]})})}),(0,N.jsx)(j.ZP,{item:!0,xs:"auto",children:(0,N.jsx)(fe.Z,{valid:i,max:900,value:i?t:"ERR"})})]})})}var he,pe,xe,me,ye,ve,ge,Ze=n(10600),je=n(25617),be=n(92443);function SubstatInput(e){var t,n=e.index,r=e.artifact,s=e.setSubstat,o=(0,I.$)("artifact").t,l=null!==r&&void 0!==r?r:{},c=l.mainStatKey,u=void 0===c?"":c,d=l.rarity,f=void 0===d?5:d,h=null!==(t=null===r||void 0===r?void 0:r.substats[n])&&void 0!==t?t:{},p=h.key,x=void 0===p?"":p,m=h.value,y=void 0===m?0:m,v=h.rolls,g=void 0===v?[]:v,Z=h.efficiency,C=void 0===Z?0:Z,A=g.reduce((function(e,t){return e+t}),0),P=ae.ZP.unit(x),M=g.length,_="",E=[],F=0;if(r){var O=r.rarity,D=ee.ZP.rollInfo(O),G=D.numUpgrades,L=D.high;F=G+L-3-M,E=x?ee.ZP.getSubstatRollData(x,O):[]}var V=7-E.length;return!M&&x&&y&&(_=_||o(he||(he=(0,a.Z)(["editor.substat.error.noCalc"])))),F<0&&(_=_||o("editor.substat.error.noOverRoll",{value:F+M})),(0,N.jsxs)(z.Z,{children:[(0,N.jsx)(b.Z,{sx:{display:"flex"},children:(0,N.jsxs)(S.Z,{size:"small",sx:{width:"100%",display:"flex"},children:[(0,N.jsxs)(R.Z,{startIcon:x?Q.Z[x]:void 0,title:x?ae.ZP.getArtStr(x):o("editor.substat.substatFormat",{value:n+1}),disabled:!r,color:x?"success":"primary",sx:{whiteSpace:"nowrap"},children:[x&&(0,N.jsx)(K.Z,{onClick:function onClick(){return s(n,{key:"",value:0})},children:o(pe||(pe=(0,a.Z)(["editor.substat.noSubstat"])))}),oe._.filter((function(e){return u!==e})).map((function(e){return(0,N.jsxs)(K.Z,{selected:x===e,disabled:x===e,onClick:function onClick(){return s(n,{key:e,value:0})},children:[(0,N.jsx)(W.Z,{children:Q.Z[e]}),(0,N.jsx)(B.Z,{children:ae.ZP.getArtStr(e)})]},e)}))]}),(0,N.jsx)(Ze.CC,{sx:{flexBasis:30,flexGrow:1},children:(0,N.jsx)(Ze.ZP,{float:"%"===P,placeholder:o(xe||(xe=(0,a.Z)(["editor.substat.selectSub"]))),value:x?y:void 0,onChange:function onChange(e){return s(n,{key:x,value:null!==e&&void 0!==e?e:0})},disabled:!x,error:!!_,sx:{px:1},inputProps:{sx:{textAlign:"right"}}})}),!!E.length&&(0,N.jsx)(be.Z,{children:o(me||(me=(0,a.Z)(["editor.substat.nextRolls"])))}),E.map((function(e,t){var r,a,i,o=(0,ae.qs)(A+e,P);return o=null!==(r=null===(a=le[f])||void 0===a||null===(i=a[x])||void 0===i?void 0:i[o])&&void 0!==r?r:o,(0,N.jsx)(k.Z,{color:"roll".concat((0,ce.uZ)(V+t,1,6)),disabled:y&&!M||F<=0,onClick:function onClick(){return s(n,{key:x,value:parseFloat(o)})},children:o},t)}))]})}),(0,N.jsx)(b.Z,{sx:{p:1},children:_?(0,N.jsx)(je.Z,{color:"error",children:o(ye||(ye=(0,a.Z)(["ui:error"])))}):(0,N.jsxs)(j.ZP,{container:!0,children:[(0,N.jsx)(j.ZP,{item:!0,children:(0,N.jsx)(je.Z,{color:0===M?"secondary":"roll".concat((0,ce.uZ)(M,1,6)),children:M?o("editor.substat.RollCount",{count:M}):o(ve||(ve=(0,a.Z)(["editor.substat.noRoll"])))})}),(0,N.jsx)(j.ZP,{item:!0,flexGrow:1,children:!!g.length&&(0,i.Z)(g).sort().map((function(e,t){return(0,N.jsx)(w.Z,{component:"span",color:"roll".concat((0,ce.uZ)(V+E.indexOf(e),1,6),".main"),sx:{ml:1},children:(0,ae.qs)(e,P)},"".concat(t,".").concat(e))}))}),(0,N.jsx)(j.ZP,{item:!0,xs:"auto",flexShrink:1,children:(0,N.jsx)(w.Z,{children:(0,N.jsxs)(T.c,{t:o,i18nKey:"editor.substat.eff",color:"text.secondary",children:["Efficiency: ",(0,N.jsx)(fe.Z,{valid:!0,max:100*M,value:C||o(ge||(ge=(0,a.Z)(["editor.substat.noStat"])))})]})})})]})})]})}var Se=n.p+"static/media/scan_art_main.66f01e51a69c518e4278.png",ke=n.p+"static/media/snippet.d223e79704fd95bcb783.png";function UploadExplainationModal(e){var t=e.modalShow,n=e.hide;return(0,N.jsx)(X.Z,{open:t,onClose:n,children:(0,N.jsxs)(U.Z,{children:[(0,N.jsx)(Z.Z,{sx:{py:1},children:(0,N.jsxs)(j.ZP,{container:!0,children:[(0,N.jsx)(j.ZP,{item:!0,flexGrow:1,children:(0,N.jsx)(w.Z,{variant:"subtitle1",children:"How do Upload Screenshots for parsing"})}),(0,N.jsx)(j.ZP,{item:!0,children:(0,N.jsx)(q.Z,{onClick:n})})]})}),(0,N.jsx)(G.Z,{}),(0,N.jsxs)(Z.Z,{children:[(0,N.jsxs)(A.Z,{variant:"outlined",severity:"warning",children:["NOTE: Artifact Scanning currently only work for ",(0,N.jsx)("strong",{children:"ENGLISH"})," artifacts."]}),(0,N.jsxs)(j.ZP,{container:!0,spacing:1,mt:1,children:[(0,N.jsx)(j.ZP,{item:!0,xs:8,md:4,children:(0,N.jsx)(b.Z,{component:"img",alt:"snippet of the screen to take",src:ke,width:"100%",height:"auto"})}),(0,N.jsxs)(j.ZP,{item:!0,xs:12,md:8,children:[(0,N.jsx)(w.Z,{gutterBottom:!0,children:"Using screenshots can dramatically decrease the amount of time you manually input in stats on the Genshin Optimizer."}),(0,N.jsx)(w.Z,{variant:"h5",children:"Where to snip the screenshot."}),(0,N.jsxs)(w.Z,{gutterBottom:!0,children:["In game, Open your bag, and navigate to the artifacts tab. Select the artifact you want to scan with Genshin Optimizer. ",(0,N.jsx)("b",{children:"Only artifact from this screen can be scanned."})]}),(0,N.jsx)(w.Z,{variant:"h6",children:"Single artifact"}),(0,N.jsxs)(w.Z,{gutterBottom:!0,children:["To take a screenshot, in Windows, the shortcut is ",(0,N.jsx)("strong",{children:"Shift + WindowsKey + S"}),". Once you selected the region, the image is automatically included in your clipboard."]}),(0,N.jsx)(w.Z,{variant:"h6",children:"Multiple artifacts"}),(0,N.jsxs)(w.Z,{gutterBottom:!0,children:["To take advantage of batch uploads, you can use a tool like ",(0,N.jsx)("a",{href:"https://picpick.app/",target:"_blank",rel:"noreferrer",children:"PicPick"})," to create a macro to easily to screenshot a region to screenshot multiple artifacts at once."]}),(0,N.jsx)(w.Z,{variant:"h5",children:"What to include in the screenshot."}),(0,N.jsx)(w.Z,{children:"As shown in the Image, starting from the top with the artifact name, all the way to the set name(the text in green). "})]}),(0,N.jsxs)(j.ZP,{item:!0,xs:12,md:7,children:[(0,N.jsx)(w.Z,{variant:"h5",children:"Adding Screenshot to Genshin Optimizer"}),(0,N.jsx)(w.Z,{children:"At this point, you should have the artifact snippet either saved to your harddrive, or in your clipboard."}),(0,N.jsx)(w.Z,{gutterBottom:!0,children:'You can click on the box next to "Browse" to browse the files in your harddrive for multiple screenshots.'}),(0,N.jsxs)(w.Z,{children:["For single screenshots from the snippets, just press ",(0,N.jsx)("strong",{children:"Ctrl + V"})," to paste from your clipboard."]}),(0,N.jsxs)(w.Z,{gutterBottom:!0,children:["You should be able to see a Preview of your artifact snippet, and after waiting a few seconds, the artifact set and the substats will be filled in in the ",(0,N.jsx)("b",{children:"Artifact Editor"}),"."]}),(0,N.jsx)(w.Z,{variant:"h5",children:"Finishing the Artifact"}),(0,N.jsxs)(w.Z,{children:["Unfortunately, computer vision is not 100%. There will always be cases where something is not scanned properly. You should always double check the scanned artifact values! Once the artifact has been filled, Click on ",(0,N.jsx)("strong",{children:"Add Artifact"})," to finish editing the artifact."]})]}),(0,N.jsx)(j.ZP,{item:!0,xs:8,md:5,children:(0,N.jsx)(b.Z,{component:"img",alt:"main screen after importing stats",src:Se,width:"100%",height:"auto"})})]})]}),(0,N.jsx)(G.Z,{}),(0,N.jsx)(Z.Z,{sx:{py:1},children:(0,N.jsx)(q.Z,{large:!0,onClick:n})})]})})}var we=n(37762),Ke=n(74165),Ce=n(15861),Ae=n(31362),Pe=n(91702),Ie=n(15671),Te=n(43144),Me=function(){function BorrowManager(e,t){(0,Ie.Z)(this,BorrowManager),this.data={},this.init=void 0,this.deinit=void 0,this.init=e,this.deinit=t}return(0,Te.Z)(BorrowManager,[{key:"borrow",value:function(){var e=(0,Ce.Z)((0,Ke.Z)().mark((function _callee(e,t){var n,r;return(0,Ke.Z)().wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return this.data[e]||(this.data[e]={value:this.init(e),refCount:0}),(n=this.data[e]).refCount+=1,a.next=5,t(n.value);case 5:return r=a.sent,n.refCount-=1,n.refCount||(delete this.data[e],this.deinit(e,n.value)),a.abrupt("return",r);case 9:case"end":return a.stop()}}),_callee,this)})));return function borrow(t,n){return e.apply(this,arguments)}}()}]),BorrowManager}(),_e={r:255,g:204,b:50},Ee=new Me(function(){var e=(0,Ce.Z)((0,Ke.Z)().mark((function _callee2(e){var t,n;return(0,Ke.Z)().wrap((function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:return t=(0,Ae.createScheduler)(),n=Array(2).fill(0).map(function(){var n=(0,Ce.Z)((0,Ke.Z)().mark((function _callee(n){var r;return(0,Ke.Z)().wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return r=(0,Ae.createWorker)({errorHandler:console.error}),n.next=3,r.load();case 3:return n.next=5,r.loadLanguage(e);case 5:return n.next=7,r.initialize(e);case 7:t.addWorker(r);case 8:case"end":return n.stop()}}),_callee)})));return function(e){return n.apply(this,arguments)}}()),r.next=4,Promise.any(n);case 4:return r.abrupt("return",t);case 5:case"end":return r.stop()}}),_callee2)})));return function(t){return e.apply(this,arguments)}}(),(function(e,t){t.then((function(e){return e.terminate()}))})),Re=function queueReducer(e,t){switch(t.type){case"upload":return{processed:e.processed,outstanding:[].concat((0,i.Z)(e.outstanding),(0,i.Z)(t.files))};case"processing":return{processed:e.processed,outstanding:(0,i.Z)(e.outstanding)};case"processed":return e.outstanding[0].file===t.file?{processed:[].concat((0,i.Z)(e.processed),[t.result]),outstanding:e.outstanding.slice(1)}:e;case"pop":return{processed:e.processed.slice(1),outstanding:e.outstanding};case"clear":return{processed:[],outstanding:[]}}};function processEntry(e){if(!e.result){var t=e.file,n=e.fileName;e.imageURL=$e(t),e.result=e.imageURL.then(function(){var e=(0,Ce.Z)((0,Ke.Z)().mark((function _callee3(e){var r,a,i,o,l,c;return(0,Ke.Z)().wrap((function _callee3$(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,te.y.getAll;case 2:return r=u.sent,u.next=5,ocr(e);case 5:return a=u.sent,i=findBestArtifact(r,a.rarities,parseSetKeys(a.artifactSetTexts,r),parseSlotKeys(a.whiteTexts),parseSubstats(a.substatTexts),parseMainStatKeys(a.whiteTexts),parseMainStatValues(a.whiteTexts)),o=(0,s.Z)(i,2),l=o[0],c=o[1],u.abrupt("return",{file:t,result:{fileName:n,imageURL:e,artifact:l,texts:c}});case 8:case"end":return u.stop()}}),_callee3)})));return function(t){return e.apply(this,arguments)}}())}}var Fe,Ne,Oe,De,We,Be,Ge,Le,Ve,Ue,ze,qe,$e=function fileToURL(e){return new Promise((function(t){var n=new FileReader;n.onloadend=function(e){var n=e.target;return t(n.result)},n.readAsDataURL(e)}))},He=function urlToImageData(e){return new Promise((function(t){var n=new Image;n.onload=function(e){var n=e.target;return t(function imageToImageData(e){var t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0,e.width,e.height),n.getImageData(0,0,e.width,e.height)}(n))},n.src=e}))};function imageDataToCanvas(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e,0,0),t}function ocr(e){return _ocr.apply(this,arguments)}function _ocr(){return(_ocr=(0,Ce.Z)((0,Ke.Z)().mark((function _callee4(e){var t,n,r,a,i,o,l,c,u,d,f;return(0,Ke.Z)().wrap((function _callee4$(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,He(e);case 2:return t=h.sent,n=t.width,r=Math.floor(t.height/2),a={rectangle:{top:r,left:0,width:n,height:r}},i=[textsFromImage(bandPass(t,[140,140,140],[255,255,255],{mode:"bw",region:"top"})),textsFromImage(bandPass(t,[30,50,80],[160,160,160],{region:"bot"}),a),textsFromImage(bandPass(t,[30,160,30],[200,255,200],{mode:"bw",region:"bot"}),a)],o=parseRarities(t.data,t.width,t.height),h.next=9,Promise.all(i);case 9:return l=h.sent,c=(0,s.Z)(l,3),u=c[0],d=c[1],f=c[2],h.abrupt("return",{whiteTexts:u,substatTexts:d,artifactSetTexts:f,rarities:o});case 15:case"end":return h.stop()}}),_callee4)})))).apply(this,arguments)}function textsFromImage(e){return _textsFromImage.apply(this,arguments)}function _textsFromImage(){return _textsFromImage=(0,Ce.Z)((0,Ke.Z)().mark((function _callee6(e){var t,n,r,a=arguments;return(0,Ke.Z)().wrap((function _callee6$(i){for(;;)switch(i.prev=i.next){case 0:return t=a.length>1&&void 0!==a[1]?a[1]:void 0,n=imageDataToCanvas(e),i.next=4,Ee.borrow("eng",function(){var e=(0,Ce.Z)((0,Ke.Z)().mark((function _callee5(e){return(0,Ke.Z)().wrap((function _callee5$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e;case 2:return r.next=4,r.sent.addJob("recognize",n,t);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),_callee5)})));return function(t){return e.apply(this,arguments)}}());case 4:return r=i.sent,i.abrupt("return",r.data.lines.map((function(e){return e.text})));case 6:case"end":return i.stop()}}),_callee6)}))),_textsFromImage.apply(this,arguments)}function findBestArtifact(e,t,n,r,a,o,l){var c,u=(0,i.Z)(new Set([].concat((0,i.Z)(n),["EmblemOfSeveredFate"]))),d=-1,f=[{setKey:"EmblemOfSeveredFate",rarity:3,level:0,slotKey:"flower",mainStatKey:"hp",substats:[],location:"",lock:!1,exclude:!1}],h=(0,ce.O)(E.En,(function(t){var r=0;n.size&&(r+=(0,i.Z)(n).reduce((function(n,r){return n+(e(r).rarity.includes(t)?1:0)}),0)/n.size);if(a.length){var s=a.reduce((function(e,n){return e+(ee.ZP.getSubstatRolls(n.key,n.value,t).length?1:0)}),0);r+=s/a.length*2}return r})),p=(0,we.Z)(E.eV);try{for(p.s();!(c=p.n()).done;){var x,m=c.value,y=(0,we.Z)(ee.ZP.slotMainStats(m));try{var v=function _loop(){for(var t=x.value,a=(r.has(m)?1:0)+(o.has(t)?1:0),i=l.filter((function(e){return"%"!==e.unit||"%"===ae.ZP.unit(t)})).map((function(e){return e.mainStatValue})),c=function _loop2(){var r=(0,s.Z)(y[p],2),o=r[0],l=r[1],c=parseInt(o),h=u.filter((function(t){return e(t).rarity.includes(c)})),x=a+l;if(x+2<d)return"continue";var v,g=(0,we.Z)(i);try{var Z=function _loop3(){var e,r=v.value,a=ee.ZP.mainStatValues(c,t),i=Math.max(0,a.findIndex((function(e){return e>=r}))),s=a[i],o=x+(s===r?1:0),l=(0,we.Z)(h);try{for(l.s();!(e=l.n()).done;){var u=e.value,p=o+(n.has(u)?1:0);p>=d&&(p>d&&(f=[]),d=p,f.push({setKey:u,rarity:c,level:i,slotKey:m,mainStatKey:t,substats:[],location:"",lock:!1,exclude:!1}))}}catch(y){l.e(y)}finally{l.f()}};for(g.s();!(v=g.n()).done;)Z()}catch(w){g.e(w)}finally{g.f()}if(x>=d){var j,b=(0,we.Z)(h);try{for(b.s();!(j=b.n()).done;){var S=j.value,k=x+(n.has(S)?1:0);k>d&&(f=[]),d=k,f.push({setKey:S,rarity:c,level:0,slotKey:m,mainStatKey:t,substats:[],location:"",lock:!1,exclude:!1})}}catch(w){b.e(w)}finally{b.f()}}},p=0,y=Object.entries(h);p<y.length;p++)c()};for(y.s();!(x=y.n()).done;)v()}catch(A){y.e(A)}finally{y.f()}}}catch(A){p.e(A)}finally{p.f()}var g={},Z={setKey:new Set,rarity:new Set,level:new Set,slotKey:new Set,mainStatKey:new Set,mainStatVal:new Set},j=f[0],b=ee.ZP.mainStatValue(j.mainStatKey,j.rarity,j.level);j.substats=a.filter((function(e,t){return e.key!==j.mainStatKey&&a.slice(0,t).every((function(t){return t.key!==e.key}))}));for(var S=j.substats.length;S<4;S++)j.substats.push({key:"",value:0});for(var k=0,w=f;k<w.length;k++){var K=w[k];Z.setKey.add(K.setKey),Z.rarity.add(K.rarity),Z.level.add(K.level),Z.slotKey.add(K.slotKey),Z.mainStatKey.add(K.mainStatKey)}function unknownText(e,t,n){return(0,N.jsxs)(N.Fragment,{children:["Unknown ",t," : Set to ",(0,N.jsx)(Pe.Z,{color:"error",children:n(e)})]})}function detectedText(e,t,n){return(0,N.jsxs)(N.Fragment,{children:["Detected ",t," ",(0,N.jsx)(Pe.Z,{color:"success",children:n(e)})]})}function inferredText(e,t,n){return(0,N.jsxs)(N.Fragment,{children:["Inferred ",t," ",(0,N.jsx)(Pe.Z,{color:"warning",children:n(e)})]})}function addText(e,t,n,r){var a=new Set((0,i.Z)(Z[e]).filter((function(e){return t.has(e)})));a.size>1?g[e]=function ambiguousText(e,t,n,r){return(0,N.jsxs)(N.Fragment,{children:["Ambiguous ",n," ",(0,N.jsx)(Pe.Z,{color:"error",children:r(e)})," : May also be ",t.filter((function(t){return t!==e})).map((function(e,t){return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("b",{children:t>0?"/":""}),(0,N.jsx)(Pe.Z,{color:"warning",children:r(e)})]})}))]})}(j[e],(0,i.Z)(t),n,r):1===a.size?g[e]=detectedText(j[e],n,r):Z[e].size>1?g[e]=unknownText(j[e],n,r):g[e]=inferredText(j[e],n,r)}addText("setKey",n,"Set",(function(t){return e(t).name})),addText("rarity",t,"Rarity",(function(e){return(0,N.jsxs)(N.Fragment,{children:[e," ",1!==e?"Stars":"Star"]})})),addText("slotKey",r,"Slot",(function(e){return(0,N.jsx)(N.Fragment,{children:ee.ZP.slotName(e)})})),addText("mainStatKey",o,"Main Stat",(function(e){return(0,N.jsx)(N.Fragment,{children:ae.ZP.getStr(e)})})),g.substats=(0,N.jsx)(N.Fragment,{children:j.substats.filter((function(e){return""!==e.key})).map((function(e,t){return(0,N.jsx)("div",{children:detectedText(e,"Sub Stat",(function(e){return(0,N.jsxs)(N.Fragment,{children:[ae.ZP.getStr(e.key),"+",(0,ae.qs)(e.value,ae.ZP.unit(e.key)),ae.ZP.unit(e.key)]})}))},t)}))});var C=function valueStrFunc(e){return(0,N.jsxs)(N.Fragment,{children:[(0,ae.qs)(e,ae.ZP.unit(j.mainStatKey)),ae.ZP.unit(j.mainStatKey)]})};return l.find((function(e){return e.mainStatValue===b}))?o.has(j.mainStatKey)?(g.level=detectedText(j.level,"Level",(function(e){return"+"+e})),g.mainStatVal=detectedText(b,"Main Stat value",C)):(g.level=inferredText(j.level,"Level",(function(e){return"+"+e})),g.mainStatVal=inferredText(b,"Main Stat value",C)):(g.level=unknownText(j.level,"Level",(function(e){return"+"+e})),g.mainStatVal=unknownText(b,"Main Stat value",C)),[j,g]}function parseSetKeys(e,t){var n,r=new Set([]),a=(0,we.Z)(e);try{for(a.s();!(n=a.n()).done;){var i,s=n.value,o=(0,we.Z)(E.q2);try{for(o.s();!(i=o.n()).done;){var l=i.value;(0,ce.UX)(s.replace(/\W/g,""),t(l).nameRaw.replace(/\W/g,""))<=2&&r.add(l)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){a.e(c)}finally{a.f()}return r}function parseRarities(e,t,n){for(var r=e,a=0,i=0,s=new Set([]),o=0;o<n;o++){for(var l=0,c=!1,u=0;u<t;u++){var d=4*(o*t+u);colorCloseEnough({r:r[d],g:r[d+1],b:r[d+2]},_e)?c||(c=!0,l++):c=!1}a!==l?(a=l,i=1):a&&++i>=10&&s.add((0,ce.uZ)(a,3,5))}return s}function colorCloseEnough(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=function intCloseEnough(e,t){return Math.abs(e-t)<=n};return r(e.r,t.r)&&r(e.g,t.g)&&r(e.b,t.b)}function parseSlotKeys(e){var t,n=new Set,r=(0,we.Z)(e);try{for(r.s();!(t=r.n()).done;){var a,i=t.value,s=(0,we.Z)(E.eV);try{for(s.s();!(a=s.n()).done;){var o=a.value;(0,ce.UX)(i.replace(/\W/g,""),ee.ZP.slotName(o).replace(/\W/g,""))<=2&&n.add(o)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){r.e(l)}finally{r.f()}return n}function parseMainStatKeys(e){var t,n=new Set([]),r=(0,we.Z)(e);try{for(r.s();!(t=r.n()).done;){var a,i=t.value,s=(0,we.Z)(oe.r);try{for(s.s();!(a=s.n()).done;){var o,l,c,u=a.value;i.toLowerCase().includes(null!==(o=null===(l=ae.ZP.getStr(u))||void 0===l?void 0:l.toLowerCase())&&void 0!==o?o:"")&&n.add(u),u.includes("_bonu")&&(0,ce.UX)(i.replace(/\W/g,""),(null!==(c=ae.ZP.getStr(u))&&void 0!==c?c:"").replace(/\W/g,""))<=1&&n.add(u)}}catch(d){s.e(d)}finally{s.f()}}}catch(d){r.e(d)}finally{r.f()}return n}function parseMainStatValues(e){var t,n=[],r=(0,we.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=/(\d+[,|\\.]+\d)%/,s=i.exec(a);s&&n.push({mainStatValue:parseFloat(s[1].replace(/,/g,".").replace(/\.{2,}/g,".")),unit:"%"}),(s=(i=/(\d+[,|\\.]\d{3}|\d{2,3})/).exec(a))&&n.push({mainStatValue:parseInt(s[1].replace(/[,|\\.]+/g,""))})}}catch(o){r.e(o)}finally{r.f()}return n}function parseSubstats(e){var t,n=[],r=(0,we.Z)(e);try{var a=function _loop4(){var e=t.value;e=e.replace(/^[\W]+/,"").replace(/\n/,""),oe._.forEach((function(t){var r=ae.ZP.getStr(t),a=("%"===ae.ZP.unit(t)?new RegExp(r+"\\s*\\+\\s*(\\d+[\\.|,]+\\d)%","im"):new RegExp(r+"\\s*\\+\\s*(\\d+,\\d+|\\d+)($|\\s)","im")).exec(e);a&&n.push({key:t,value:parseFloat(a[1].replace(/,/g,".").replace(/\.{2,}/g,"."))})}))};for(r.s();!(t=r.n()).done;)a()}catch(i){r.e(i)}finally{r.f()}return n.slice(0,4)}function bandPass(e,t,n,r){for(var a=r.region,i=void 0===a?"all":a,s=r.mode,o=void 0===s?"color":s,l=Uint8ClampedArray.from(e.data),c="top"===i,u="bot"===i,d="all"===i,f="bw"===o,h="invert"===o,p=Math.floor(e.width*(e.height/2)*4),x=0;x<l.length;x+=4){var m=l[x],y=l[x+1],v=l[x+2];(d||c&&x<p||u&&x>p)&&m>=t[0]&&m<=n[0]&&y>=t[1]&&y<=n[1]&&v>=t[2]&&v<=n[2]?f?l[x]=l[x+1]=l[x+2]=0:h&&(l[x]=255-m,l[x+1]=255-y,l[x+2]=255-v):l[x]=l[x+1]=l[x+2]=255}return new ImageData(l,e.width,e.height)}var Ye=new Set(oe._);function artifactReducer(e,t){switch(t.type){case"reset":return;case"substat":var n=t.index,r=t.substat,a=r.key?e.substats.findIndex((function(e){return e.key===r.key})):-1;if(-1===a||a===n)e.substats[n]=r;else{var i=[e.substats[a],e.substats[n]];e.substats[n]=i[0],e.substats[a]=i[1]}return(0,o.Z)({},e);case"overwrite":return t.artifact;case"update":return(0,o.Z)((0,o.Z)({},e),t.artifact)}}var Xe=(0,x.ZP)("input")({display:"none"});function ArtifactEditor(e){var t,n,r=e.artifactIdToEdit,x=void 0===r?"":r,_=e.cancelEdit,F=e.allowUpload,O=void 0!==F&&F,D=e.allowEmpty,W=void 0!==D&&D,B=e.disableSet,G=void 0!==B&&B,L=e.disableSlot,V=void 0!==L&&L,$=(0,I.$)("artifact").t,H=(0,se.Z)((function(){return te.y.getAll}),[]),oe=(0,P.useContext)(re.t).database,le=(0,P.useState)(!1),de=(0,s.Z)(le,2),fe=de[0],he=de[1],pe=(0,ie.Z)(),xe=(0,s.Z)(pe,2),me=xe[0],ye=xe[1];(0,P.useEffect)((function(){return oe.arts.followAny(ye)}),[oe,ye]);var ve=(0,P.useReducer)(artifactReducer,void 0),ge=(0,s.Z)(ve,2),Ze=ge[0],je=ge[1],be=(0,P.useMemo)((function(){return Ze&&(0,ne.BG)(Ze)}),[Ze]),Se=(0,P.useState)(!1),ke=(0,s.Z)(Se,2),we=ke[0],Ke=ke[1],Ce=(0,P.useReducer)(Re,{processed:[],outstanding:[]}),Ae=(0,s.Z)(Ce,2),Pe=Ae[0],Ie=Pe.processed,Te=Pe.outstanding,Me=Ae[1],_e=Ie[0],Ee=Te[0],$e=(0,se.Z)((function(){return null===Ee||void 0===Ee?void 0:Ee.imageURL}),[null===Ee||void 0===Ee?void 0:Ee.imageURL]),He=(0,se.Z)((function(){return null===Ee||void 0===Ee?void 0:Ee.result}),[null===Ee||void 0===Ee?void 0:Ee.result]),Je=Ie.length+Te.length,Qe=null!==(t=null===_e||void 0===_e?void 0:_e.imageURL)&&void 0!==t?t:$e,et=null!==_e&&void 0!==_e?_e:{},tt=et.artifact,nt=et.texts,rt=!(null===be||void 0===be||!be.location)||V;(0,P.useEffect)((function(){!be&&tt&&je({type:"overwrite",artifact:tt})}),[be,tt,je]),(0,P.useEffect)((function(){var e=Math.min(16-Ie.length,3,Te.length),t=e&&!Te[0].result;Te.slice(0,e).forEach(processEntry),t&&Me({type:"processing"})}),[Ie.length,Te]),(0,P.useEffect)((function(){He&&Me((0,o.Z)({type:"processed"},He))}),[He,Me]);var at=(0,P.useCallback)((function(e){he(!0),Me({type:"upload",files:(0,i.Z)(e).map((function(e){return{file:e,fileName:e.name}}))})}),[Me,he]),it=(0,P.useCallback)((function(){return Me({type:"clear"})}),[Me]);(0,P.useEffect)((function(){var e=function pasteFunc(e){return at(e.clipboardData.files)};return O&&window.addEventListener("paste",e),function(){O&&window.removeEventListener("paste",e)}}),[at,O]);var st=(0,P.useCallback)((function(e){at(e.target.files),e.target.value=null}),[at]),ot=(0,P.useMemo)((function(){var e,t=me&&x&&oe.arts.get(x);if(t)return{old:t,oldType:"edit"};if(void 0===be)return{old:void 0,oldType:""};var n=me&&oe.arts.findDups(be),r=n.duplicated,a=n.upgraded;return{old:null!==(e=r[0])&&void 0!==e?e:a[0],oldType:0!==r.length?"duplicate":"upgrade"}}),[be,x,oe,me]),lt=ot.old,ct=ot.oldType,ut=(0,P.useMemo)((function(){if(!be)return{artifact:void 0,errors:[]};var e=(0,ne.m1)(be,x);return lt&&(e.artifact.location=lt.location,e.artifact.exclude=lt.exclude),e}),[be,x,lt]),dt=ut.artifact,ft=ut.errors;(0,P.useEffect)((function(){"new"===x&&(he(!0),je({type:"reset"}));var e=x&&me&&oe.arts.get(x);e&&(he(!0),je({type:"overwrite",artifact:(0,ce.I8)(e)}))}),[x,oe,me]);var ht=be?null===H||void 0===H?void 0:H(be.setKey):void 0,pt=(0,P.useCallback)((function(){null===_||void 0===_||_(),Me({type:"pop"}),je({type:"reset"})}),[_,je]),xt=(0,P.useCallback)((function(e){var t,n,r=e.setKey?H(e.setKey):ht;function pick(e,t,n){return e&&t.includes(e)?e:null!==n&&void 0!==n?n:t[0]}e.setKey&&(e.rarity=pick(null===be||void 0===be?void 0:be.rarity,r.rarity,Math.max.apply(Math,(0,i.Z)(r.rarity))),e.slotKey=pick(null===be||void 0===be?void 0:be.slotKey,r.slots)),e.rarity&&(e.level=null!==(t=null===be||void 0===be?void 0:be.level)&&void 0!==t?t:0),e.level&&(e.level=(0,ce.uZ)(e.level,0,4*(null!==(n=e.rarity)&&void 0!==n?n:be.rarity))),e.slotKey&&(e.mainStatKey=pick(null===be||void 0===be?void 0:be.mainStatKey,ee.ZP.slotMainStats(e.slotKey))),e.mainStatKey&&(e.substats=[0,1,2,3].map((function(t){return be&&be.substats[t].key!==e.mainStatKey?be.substats[t]:{key:"",value:0}}))),je({type:"update",artifact:e})}),[be,H,ht,je]),mt=(0,P.useCallback)((function(e,t){je({type:"substat",index:e,substat:t})}),[je]),yt=!ft.length,vt=null!==be&&void 0!==be?be:{},gt=vt.rarity,Zt=void 0===gt?5:gt,jt=vt.level,bt=void 0===jt?0:jt,St=vt.slotKey,kt=void 0===St?"flower":St,wt=dt?ee.ZP.getArtifactEfficiency(dt,Ye):{},Kt=wt.currentEfficiency,Ct=void 0===Kt?0:Kt,At=wt.maxEfficiency,Pt=void 0===At?0:At,It=Ie.length||Te.length,Tt=(0,P.useCallback)((function(e){It&&e.preventDefault(),he(!1),_()}),[It,he,_]),Mt=(0,m.Z)(),_t=(0,y.Z)(Mt.breakpoints.up("md")),Et=be?E.Kj.find((function(e){return be.mainStatKey.includes(e)})):void 0,Rt=be?null!==Et&&void 0!==Et?Et:"success":"primary",Ft=(0,P.useCallback)((function(e){return xt({setKey:e})}),[xt]),Nt=(0,P.useCallback)((function(e){return""===e||!(!rt||"circlet"===kt||"PrayersForDestiny"!==e&&"PrayersForIllumination"!==e&&"PrayersForWisdom"!==e&&"PrayersToSpringtime"!==e)}),[rt,kt]);return(0,N.jsx)(X.Z,{open:fe,onClose:Tt,children:(0,N.jsx)(P.Suspense,{fallback:(0,N.jsx)(v.Z,{variant:"rectangular",sx:{width:"100%",height:fe?"100%":64}}),children:(0,N.jsxs)(U.Z,{children:[(0,N.jsx)(UploadExplainationModal,{modalShow:we,hide:function hide(){return Ke(!1)}}),(0,N.jsx)(g.Z,{title:(0,N.jsx)(T.c,{t:$,i18nKey:"editor.title",children:"Artifact Editor"}),action:(0,N.jsx)(q.Z,{disabled:!!It,onClick:Tt})}),(0,N.jsxs)(Z.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,N.jsxs)(j.ZP,{container:!0,spacing:1,columns:{xs:1,md:2},children:[(0,N.jsxs)(j.ZP,{item:!0,xs:1,display:"flex",flexDirection:"column",gap:1,children:[(0,N.jsxs)(b.Z,{sx:{display:"flex",gap:1,mb:1},children:[(0,N.jsx)(M.Y4,{disabled:G,showDefault:!0,disableClearable:!0,size:"small",artSetKey:null!==(n=null===be||void 0===be?void 0:be.setKey)&&void 0!==n?n:"",setArtSetKey:Ft,sx:function sx(e){return{flexGrow:1,".MuiFilledInput-root":{borderBottomRightRadius:e.shape.borderRadius,borderBottomLeftRadius:e.shape.borderRadius}}},defaultText:$("editor.unknownSetName"),disable:Nt}),(0,N.jsx)(ArtifactRarityDropdown,{rarity:be?Zt:void 0,onChange:function onChange(e){return xt({rarity:e})},filter:function filter(e){var t,n;return!(null===ht||void 0===ht||null===(t=ht.rarity)||void 0===t||null===(n=t.includes)||void 0===n||!n.call(t,e))},disabled:!ht})]}),(0,N.jsxs)(b.Z,{component:"div",display:"flex",children:[(0,N.jsx)(CustomNumberTextField,{id:"filled-basic",label:"Level",variant:"filled",sx:{flexShrink:1,flexGrow:1,mr:1,my:0},margin:"dense",size:"small",value:bt,disabled:!ht,placeholder:"0~".concat(4*Zt),onChange:function onChange(e){return xt({level:e})}}),(0,N.jsxs)(S.Z,{children:[(0,N.jsx)(k.Z,{onClick:function onClick(){return xt({level:bt-1})},disabled:!ht||0===bt,children:"-"}),Zt?(0,i.Z)(Array(Zt+1).keys()).map((function(e){return 4*e})).map((function(e){return(0,N.jsx)(k.Z,{onClick:function onClick(){return xt({level:e})},disabled:!ht||bt===e,children:e},e)})):null,(0,N.jsx)(k.Z,{onClick:function onClick(){return xt({level:bt+1})},disabled:!ht||bt===4*Zt,children:"+"})]})]}),(0,N.jsxs)(b.Z,{component:"div",display:"flex",children:[(0,N.jsx)(ArtifactSlotDropdown,{disabled:rt||!ht,slotKey:kt,onChange:function onChange(e){return xt({slotKey:e})}}),(0,N.jsx)(z.Z,{sx:{p:1,ml:1,flexGrow:1},children:(0,N.jsx)(P.Suspense,{fallback:(0,N.jsx)(v.Z,{width:"60%"}),children:(0,N.jsx)(w.Z,{color:"text.secondary",children:null!==ht&&void 0!==ht&&ht.getSlotName(be.slotKey)?(0,N.jsxs)("span",{children:[(0,N.jsx)(Y.Z,{src:ht.slotIcons[be.slotKey]})," ",null===ht||void 0===ht?void 0:ht.getSlotName(be.slotKey)]}):$(Ne||(Ne=(0,a.Z)(["editor.unknownPieceName"])))})})})]}),(0,N.jsxs)(b.Z,{component:"div",display:"flex",children:[(0,N.jsx)(R.Z,{startIcon:null!==be&&void 0!==be&&be.mainStatKey?Q.Z[be.mainStatKey]:void 0,title:(0,N.jsx)("b",{children:be?ae.ZP.getArtStr(be.mainStatKey):$(Oe||(Oe=(0,a.Z)(["mainStat"])))}),disabled:!ht,color:Rt,children:ee.ZP.slotMainStats(kt).map((function(e){return(0,N.jsx)(K.Z,{selected:(null===be||void 0===be?void 0:be.mainStatKey)===e,disabled:(null===be||void 0===be?void 0:be.mainStatKey)===e,onClick:function onClick(){return xt({mainStatKey:e})},children:(0,N.jsx)(J._,{statKey:e})},e)}))}),(0,N.jsx)(z.Z,{sx:{p:1,ml:1,flexGrow:1},children:(0,N.jsx)(w.Z,{color:"text.secondary",children:be?"".concat((0,ae.qs)(ee.ZP.mainStatValue(be.mainStatKey,Zt,bt),ae.ZP.unit(be.mainStatKey))).concat(ae.ZP.unit(be.mainStatKey)):$(De||(De=(0,a.Z)(["mainStat"])))})})]}),(0,N.jsx)(SubstatEfficiencyDisplayCard,{valid:yt,efficiency:Ct,t:$}),Ct!==Pt&&(0,N.jsx)(SubstatEfficiencyDisplayCard,{max:!0,valid:yt,efficiency:Pt,t:$}),O&&(0,N.jsx)(z.Z,{children:(0,N.jsx)(Z.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:(0,N.jsxs)(P.Suspense,{fallback:(0,N.jsx)(v.Z,{width:"100%",height:"100"}),children:[(0,N.jsxs)(j.ZP,{container:!0,spacing:1,alignItems:"center",children:[(0,N.jsx)(j.ZP,{item:!0,flexGrow:1,children:(0,N.jsxs)("label",{htmlFor:"contained-button-file",children:[(0,N.jsx)(Xe,{accept:"image/*",id:"contained-button-file",multiple:!0,type:"file",onChange:st}),(0,N.jsx)(k.Z,{component:"span",startIcon:(0,N.jsx)(u.Z,{}),children:"Upload Screenshot (or Ctrl-V)"})]})}),(0,N.jsx)(j.ZP,{item:!0,children:(0,N.jsx)(k.Z,{color:"info",sx:{px:2,minWidth:0},onClick:function onClick(){return Ke(!0)},children:(0,N.jsx)(w.Z,{children:(0,N.jsx)(c.G,{icon:l.Fuz})})})})]}),Qe&&(0,N.jsx)(b.Z,{display:"flex",justifyContent:"center",children:(0,N.jsx)(b.Z,{component:"img",src:Qe,width:"100%",maxWidth:350,height:"auto",alt:"Screenshot to parse for artifact values"})}),Je>0&&(0,N.jsx)(U.Z,{sx:{pl:2},children:(0,N.jsxs)(j.ZP,{container:!0,spacing:1,alignItems:"center",children:[!_e&&Ee&&(0,N.jsx)(j.ZP,{item:!0,children:(0,N.jsx)(C.Z,{size:"1em"})}),(0,N.jsx)(j.ZP,{item:!0,flexGrow:1,children:(0,N.jsx)(w.Z,{children:(0,N.jsxs)("span",{children:["Screenshots in file-queue: ",(0,N.jsx)("b",{children:Je})]})})}),(0,N.jsx)(j.ZP,{item:!0,children:(0,N.jsx)(k.Z,{size:"small",color:"error",onClick:it,children:"Clear file-queue"})})]})})]})})})]}),(0,N.jsxs)(j.ZP,{item:!0,xs:1,display:"flex",flexDirection:"column",gap:1,children:[[0,1,2,3].map((function(e){return(0,N.jsx)(SubstatInput,{index:e,artifact:dt,setSubstat:mt},e)})),nt&&(0,N.jsx)(z.Z,{children:(0,N.jsxs)(Z.Z,{children:[(0,N.jsx)("div",{children:nt.slotKey}),(0,N.jsx)("div",{children:nt.mainStatKey}),(0,N.jsx)("div",{children:nt.mainStatVal}),(0,N.jsx)("div",{children:nt.rarity}),(0,N.jsx)("div",{children:nt.level}),(0,N.jsx)("div",{children:nt.substats}),(0,N.jsx)("div",{children:nt.setKey})]})})]})]}),lt&&(0,N.jsxs)(j.ZP,{container:!0,sx:{justifyContent:"space-around"},spacing:1,children:[(0,N.jsx)(j.ZP,{item:!0,xs:12,md:5.5,lg:4,children:(0,N.jsxs)(z.Z,{children:[(0,N.jsx)(w.Z,{sx:{textAlign:"center"},py:1,variant:"h6",color:"text.secondary",children:$("edit"!==ct?"duplicate"===ct?We||(We=(0,a.Z)(["editor.dupArt"])):Be||(Be=(0,a.Z)(["editor.upArt"])):Ge||(Ge=(0,a.Z)(["editor.beforeEdit"])))}),(0,N.jsx)(ue.Z,{artifactObj:lt})]})}),_t&&(0,N.jsx)(j.ZP,{item:!0,md:1,display:"flex",alignItems:"center",justifyContent:"center",children:(0,N.jsx)(z.Z,{sx:{display:"flex"},children:(0,N.jsx)(d.Z,{sx:{fontSize:40}})})}),(0,N.jsx)(j.ZP,{item:!0,xs:12,md:5.5,lg:4,children:(0,N.jsxs)(z.Z,{children:[(0,N.jsx)(w.Z,{sx:{textAlign:"center"},py:1,variant:"h6",color:"text.secondary",children:$(Le||(Le=(0,a.Z)(["editor.preview"])))}),(0,N.jsx)(ue.Z,{artifactObj:dt})]})})]}),!yt&&(0,N.jsx)(A.Z,{variant:"filled",severity:"error",children:ft.map((function(e,t){return(0,N.jsx)("div",{children:e},t)}))}),(0,N.jsxs)(j.ZP,{container:!0,spacing:2,children:[(0,N.jsx)(j.ZP,{item:!0,children:"edit"===ct?(0,N.jsx)(k.Z,{startIcon:(0,N.jsx)(f.Z,{}),onClick:function onClick(){oe.arts.set(lt.id,Ze),W?pt():(he(!1),_())},disabled:!Ze||!yt,color:"primary",children:$(Ve||(Ve=(0,a.Z)(["editor.btnSave"])))}):(0,N.jsx)(k.Z,{startIcon:(0,N.jsx)(f.Z,{}),onClick:function onClick(){oe.arts.new(be),W?pt():(he(!1),_())},disabled:!be||!yt,color:"duplicate"===ct?"warning":"primary",children:$(Ue||(Ue=(0,a.Z)(["editor.btnAdd"])))})}),(0,N.jsx)(j.ZP,{item:!0,flexGrow:1,children:W&&(0,N.jsx)(k.Z,{startIcon:(0,N.jsx)(h.Z,{}),disabled:!be,onClick:function onClick(){(function canClearArtifact(){return window.confirm($(Fe||(Fe=(0,a.Z)(["editor.clearPrompt"]))))})()&&pt()},color:"error",children:$(ze||(ze=(0,a.Z)(["editor.btnClear"])))})}),(0,N.jsx)(j.ZP,{item:!0,children:!1}),lt&&"edit"!==ct&&(0,N.jsx)(j.ZP,{item:!0,children:(0,N.jsx)(k.Z,{startIcon:(0,N.jsx)(p.Z,{}),onClick:function onClick(){oe.arts.set(lt.id,Ze),W?pt():he(!1)},disabled:!Ze||!yt,color:"success",children:$(qe||(qe=(0,a.Z)(["editor.btnUpdate"])))})})]})]})]})})})}}}]);
//# sourceMappingURL=213.88786dce.chunk.js.map