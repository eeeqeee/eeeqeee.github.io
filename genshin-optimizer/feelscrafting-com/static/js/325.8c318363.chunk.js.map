{"version":3,"file":"static/js/325.8c318363.chunk.js","mappings":"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","sources":["Components/MenuItemWithImage.tsx","Components/Artifact/ArtifactAutocomplete.tsx","Components/Artifact/ArtifactLevelSlider.tsx","Components/Card/CardHeaderCustom.tsx","Components/Conditional/ConditionalSelector.tsx","Components/Conditional/ConditionalDisplay.tsx","Components/DocumentDisplay.tsx","Components/LevelSelect.tsx","Components/RefinementDropdown.tsx","Components/TextButton.tsx","Context/GraphContext.tsx","PageCharacter/CharacterDisplay/CharSelectDropdown.tsx","PageCharacter/CharacterDisplay/FormulaModal.tsx","Components/ExpandButton.tsx","Components/StatInput.tsx","Components/EnemyEditor.tsx","PageCharacter/CharacterDisplay/StatModal.tsx","Context/OptimizationTargetContext.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/common.ts","Components/Artifact/SetEffectDisplay.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/useBuildSetting.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ArtifactSetConfig.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/AssumeFullLevelToggle.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BonusStatsCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BuildAlert.tsx","Components/Artifact/ArtifactCardNano.tsx","Components/Character/StatDisplayComponent.tsx","Components/Weapon/WeaponCardNano.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ArtifactSetBadges.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/BuildDisplayItem.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/useBuildResult.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ChartCard/CustomDot.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ChartCard/CustomTooltip.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ChartCard/EnhancedPoint.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/ChartCard/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/MainStatSelectionCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/OptimizationTargetEditorList.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/StatFilterCard.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/UseEquipped.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/Components/UseExcluded.tsx","PageCharacter/CharacterDisplay/Tabs/TabOptimize/foreground.ts","PageCharacter/CharacterDisplay/Tabs/TabOptimize/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabOverview/CompareBuildButton.tsx","PageCharacter/CharacterDisplay/Tabs/TabOverview/ArtifactSwapModal.tsx","PageCharacter/CharacterDisplay/Tabs/TabOverview/WeaponSwapModal.tsx","PageCharacter/CharacterDisplay/Tabs/TabOverview/EquipmentSection.tsx","PageCharacter/CharacterDisplay/Tabs/TabOverview/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabTalent.tsx","PageCharacter/CharacterDisplay/Tabs/TabTeambuffs.tsx","PageCharacter/CharacterDisplay/Tabs/TabTheorycraft/index.tsx","PageCharacter/CharacterDisplay/Tabs/TabTheorycraft/useCharTC.tsx","PageCharacter/CharacterDisplay/TravelerElementSelect.tsx","PageCharacter/CharacterDisplay/TravelerGenderSelect.tsx","PageCharacter/CharacterDisplay/index.tsx","PageWeapon/WeaponCard.tsx"],"sourcesContent":["import { ListItemIcon, ListItemText, MenuItem, Theme } from \"@mui/material\";\n\ntype MenuItemWithImageProps = {\n  value: string\n  image?: Displayable\n  text: Displayable\n  theme: Theme\n  isSelected?: boolean\n  addlElement?: Displayable\n  props?: object\n}\n\nexport default function MenuItemWithImage({ value, image = \"\", text, theme, isSelected, addlElement, props }: MenuItemWithImageProps) {\n  return <MenuItem key={value} value={value} {...props}>\n    <ListItemIcon>{image}</ListItemIcon>\n    <ListItemText primaryTypographyProps={{ style: { fontWeight: isSelected ? theme.typography.fontWeightMedium : theme.typography.fontWeightRegular } }}>\n      {text}\n    </ListItemText>\n    {addlElement && addlElement}\n  </MenuItem>\n}\n","import { Autocomplete, AutocompleteProps, AutocompleteRenderGroupParams, Box, Chip, List, ListSubheader, TextField, useTheme } from '@mui/material';\nimport { useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { ArtifactSheet } from '../../Data/Artifacts/ArtifactSheet';\nimport i18n from '../../i18n';\nimport KeyMap from '../../KeyMap';\nimport usePromise from '../../ReactHooks/usePromise';\nimport { allMainStatKeys, allSubstatKeys, MainStatKey, SubstatKey } from '../../Types/artifact';\nimport { allElementsWithPhy, ArtifactRarity, ArtifactSetKey } from '../../Types/consts';\nimport ColorText from '../ColoredText';\nimport MenuItemWithImage from '../MenuItemWithImage';\nimport SolidColoredTextField from '../SolidColoredTextfield';\nimport { StarsDisplay } from '../StarDisplay';\nimport StatIcon from '../StatIcon';\n\ntype Grouper = string | number | undefined\n\ntype ArtifactMultiAutocompleteKey = ArtifactSetKey | MainStatKey | SubstatKey\ntype ArtifactMultiAutocompleteOption<T extends ArtifactMultiAutocompleteKey, G extends Grouper> = {\n  key: T\n  label: string\n  grouper?: G\n}\ntype ArtifactMultiAutocompleteProps<T extends ArtifactMultiAutocompleteKey, G extends Grouper> = Omit<AutocompleteProps<ArtifactMultiAutocompleteOption<T, G>, true, false, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\n  allArtifactKeysWithGrouper: readonly { key: T, grouper?: G }[]\n  selectedArtifactKeys: T[]\n  setArtifactKeys: (keys: T[]) => void\n  getName: (key: T) => string\n  getImage: (key: T) => JSX.Element\n  label: string\n}\nfunction ArtifactMultiAutocomplete<T extends ArtifactMultiAutocompleteKey, G extends Grouper>({ allArtifactKeysWithGrouper, selectedArtifactKeys, setArtifactKeys, getName, getImage, label, ...props }:\n  ArtifactMultiAutocompleteProps<T, G>) {\n  const theme = useTheme()\n\n  const handleChange = (_, value: ArtifactMultiAutocompleteOption<T, G>[]) => {\n    setArtifactKeys(value.map(v => v.key))\n  }\n  const options = useMemo(() => allArtifactKeysWithGrouper.map(({ key, grouper }) => ({ key, label: getName(key), grouper })), [allArtifactKeysWithGrouper, getName])\n  return <Autocomplete\n    autoHighlight\n    multiple\n    disableCloseOnSelect\n    options={options}\n    value={selectedArtifactKeys.map(key => ({ key: key, label: getName(key) }))}\n    onChange={handleChange}\n    getOptionLabel={(option) => option.label}\n    isOptionEqualToValue={(option, value) => option.key === value.key}\n    renderInput={(params) => <TextField\n      {...params}\n      label={label}\n      variant=\"filled\"\n      InputLabelProps={{ style: { color: theme.palette.text.primary } }}\n      color={selectedArtifactKeys.length ? \"success\" : \"primary\"}\n      type=\"search\"\n    />}\n    renderOption={(props, option) => (\n      <MenuItemWithImage\n        key={option.key}\n        value={option.key}\n        image={<ColorText color={KeyMap.getVariant(option.key)}>{getImage(option.key)}</ColorText>}\n        text={<ColorText color={KeyMap.getVariant(option.key)}>{option.label}</ColorText>}\n        theme={theme}\n        isSelected={selectedArtifactKeys.includes(option.key)}\n        props={props}\n      />\n    )}\n    renderTags={(selected, getTagProps) => selected.map((value, index) => {\n      const element = allElementsWithPhy.find(ele => value.key === `${ele}_dmg_`)\n      const color = element ? element : undefined\n      return <Chip {...getTagProps({ index })} key={value.key} icon={getImage(value.key)} label={value.label} color={color} />\n    })}\n    {...props}\n  />\n}\n\ntype ArtifactSetMultiAutocompleteProps = Omit<AutocompleteProps<ArtifactMultiAutocompleteOption<ArtifactSetKey, ArtifactRarity>, true, false, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\n  artSetKeys: ArtifactSetKey[]\n  setArtSetKeys: (keys: ArtifactSetKey[]) => void\n}\nexport function ArtifactSetMultiAutocomplete({ artSetKeys, setArtSetKeys, ...props }: ArtifactSetMultiAutocompleteProps) {\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\n  const { t } = useTranslation([\"artifact\", \"artifactNames_gen\"])\n  if (!artifactSheets) return null\n\n  const allArtifactSetsAndRarities = Object.entries(ArtifactSheet.setKeysByRarities(artifactSheets))\n    .flatMap(([rarity, sets]) => sets.map(set => ({ key: set, grouper: +rarity as ArtifactRarity })))\n    .sort(sortByRarityAndName)\n\n  return <ArtifactMultiAutocomplete<ArtifactSetKey, ArtifactRarity>\n    allArtifactKeysWithGrouper={allArtifactSetsAndRarities}\n    selectedArtifactKeys={artSetKeys}\n    setArtifactKeys={setArtSetKeys}\n    getName={(key: ArtifactSetKey) => t(`artifactNames_gen:${key}`)}\n    getImage={(key: ArtifactSetKey) => artifactSheets(key).defIcon}\n    label={t(\"artifact:autocompleteLabels.sets\")}\n    groupBy={(option) => option.grouper?.toString() ?? \"\"}\n    renderGroup={(params: AutocompleteRenderGroupParams) => params.group && <List key={params.group} component={Box}>\n      <ListSubheader key={`${params.group}Header`} sx={{ top: \"-1em\" }}>\n        {params.group} <StarsDisplay stars={+params.group as ArtifactRarity} />\n      </ListSubheader>\n      {params.children}\n    </List>}\n    {...props}\n  />\n}\n\ntype ArtifactMainStatMultiAutocompleteProps = Omit<AutocompleteProps<ArtifactMultiAutocompleteOption<MainStatKey, undefined>, true, false, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\n  mainStatKeys: MainStatKey[]\n  setMainStatKeys: (keys: MainStatKey[]) => void\n}\nexport function ArtifactMainStatMultiAutocomplete({ mainStatKeys, setMainStatKeys, ...props }: ArtifactMainStatMultiAutocompleteProps) {\n  const { t } = useTranslation(\"artifact\")\n  return <ArtifactMultiAutocomplete<MainStatKey, undefined>\n    allArtifactKeysWithGrouper={allMainStatKeys.map(key => ({ key }))}\n    selectedArtifactKeys={mainStatKeys}\n    setArtifactKeys={setMainStatKeys}\n    getName={(key: MainStatKey) => KeyMap.getArtStr(key)}\n    getImage={(key: MainStatKey) => StatIcon[key]}\n    label={t(\"autocompleteLabels.mainStats\")}\n    {...props}\n  />\n}\n\ntype ArtifactSubstatMultiAutocompleteProps = Omit<AutocompleteProps<ArtifactMultiAutocompleteOption<SubstatKey, undefined>, true, false, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\n  substatKeys: SubstatKey[]\n  setSubstatKeys: (keys: SubstatKey[]) => void\n}\nexport function ArtifactSubstatMultiAutocomplete({ substatKeys, setSubstatKeys, ...props }: ArtifactSubstatMultiAutocompleteProps) {\n  const { t } = useTranslation(\"artifact\")\n  return <ArtifactMultiAutocomplete<SubstatKey, undefined>\n    allArtifactKeysWithGrouper={allSubstatKeys.map(key => ({ key }))}\n    selectedArtifactKeys={substatKeys}\n    setArtifactKeys={setSubstatKeys}\n    getName={(key: SubstatKey) => KeyMap.getArtStr(key)}\n    getImage={(key: SubstatKey) => StatIcon[key]}\n    label={t(\"autocompleteLabels.substats\")}\n    {...props}\n  />\n}\n\ntype ArtifactSingleAutocompleteKey = ArtifactSetKey | MainStatKey | SubstatKey | \"\"\ntype ArtifactSingleAutocompleteOption<T extends ArtifactSingleAutocompleteKey, G extends Grouper> = {\n  key: T\n  label: string\n  grouper?: G\n}\ntype ArtifactSingleAutocompleteProps<T extends ArtifactSingleAutocompleteKey, G extends Grouper> = Omit<AutocompleteProps<ArtifactSingleAutocompleteOption<T, G>, false, true, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\n  allArtifactKeysWithGrouper: readonly { key: T, grouper?: G }[]\n  selectedArtifactKey: T\n  setArtifactKey: (key: T | \"\") => void\n  getName: (key: T) => string\n  getImage: (key: T) => JSX.Element\n  label: string\n  disable?: (v: any) => boolean\n  showDefault?: boolean\n  defaultText?: string\n  defaultIcon?: Displayable\n}\nfunction ArtifactSingleAutocomplete<T extends ArtifactSingleAutocompleteKey, G extends Grouper>({ allArtifactKeysWithGrouper, selectedArtifactKey, setArtifactKey, getName, getImage, label, disable = () => false, showDefault = false, defaultText = \"\", defaultIcon = \"\", ...props }:\n  ArtifactSingleAutocompleteProps<T, G>) {\n  const theme = useTheme();\n\n  const options = useMemo(() =>\n    (showDefault\n      ? [{ key: \"\" as T, label: defaultText }]\n      : []\n    ).concat(allArtifactKeysWithGrouper.map(({ key, grouper }) => (\n      { key, label: getName(key), grouper }\n    ))), [allArtifactKeysWithGrouper, getName, defaultText, showDefault])\n\n  return <Autocomplete\n    autoHighlight\n    options={options}\n    clearIcon={selectedArtifactKey ? undefined : \"\"} // Hide the clear icon if the value is already default\n    value={{ key: selectedArtifactKey, label: getName(selectedArtifactKey) }}\n    onChange={(event, newValue, reason) => (event.type !== \"change\" || reason !== \"clear\") && setArtifactKey(newValue ? newValue.key : \"\")}\n    getOptionLabel={(option) => option.label ? option.label : defaultText}\n    isOptionEqualToValue={(option, value) => option.key === value.key}\n    getOptionDisabled={option => disable(option.key)}\n    renderInput={(props) => <SolidColoredTextField\n      {...props}\n      label={label}\n      startAdornment={getImage(selectedArtifactKey)}\n      hasValue={selectedArtifactKey ? true : false}\n    />}\n    renderOption={(props, option) => (\n      <MenuItemWithImage\n        key={option.key}\n        value={option.key}\n        image={getImage(option.key)}\n        text={option.label}\n        theme={theme}\n        isSelected={selectedArtifactKey === option.key}\n        props={props}\n      />\n    )}\n    {...props}\n  />\n}\n\ntype ArtifactSetSingleAutocompleteProps = Omit<AutocompleteProps<ArtifactSingleAutocompleteOption<ArtifactSetKey | \"\", ArtifactRarity>, false, true, false>, \"title\" | \"children\" | \"onChange\" | \"options\" | \"renderInput\" | \"value\"> & {\n  artSetKey: ArtifactSetKey | \"\"\n  setArtSetKey: (key: ArtifactSetKey | \"\") => void\n  label?: string\n  disable?: (v: any) => boolean\n  showDefault?: boolean\n  defaultText?: string\n  defaultIcon?: Displayable\n}\nexport function ArtifactSetSingleAutocomplete({ artSetKey, setArtSetKey, label = \"\", ...props }: ArtifactSetSingleAutocompleteProps) {\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\n  const { t } = useTranslation([\"artifact\", \"artifactNames_gen\"])\n  label = label ? label : t(\"artifact:autocompleteLabels.set\")\n  if (!artifactSheets) return null\n\n  const allArtifactSetsAndRarities = Object.entries(ArtifactSheet.setKeysByRarities(artifactSheets))\n    .flatMap(([rarity, sets]) => sets.map(set => ({ key: set, grouper: +rarity as ArtifactRarity })))\n    .sort(sortByRarityAndName)\n\n  return <ArtifactSingleAutocomplete<ArtifactSetKey | \"\", ArtifactRarity>\n    allArtifactKeysWithGrouper={allArtifactSetsAndRarities}\n    selectedArtifactKey={artSetKey}\n    setArtifactKey={setArtSetKey}\n    getName={(key: ArtifactSetKey | \"\") => key && t(`artifactNames_gen:${key}`)}\n    getImage={(key: ArtifactSetKey | \"\") => key ? artifactSheets(key).defIcon : <></>}\n    label={label}\n    groupBy={(option) => option.grouper?.toString() ?? \"\"}\n    renderGroup={(params: AutocompleteRenderGroupParams) => params.group && <List key={params.group} component={Box}>\n      <ListSubheader key={`${params.group}Header`} sx={{ top: \"-1em\" }}>\n        {params.group} <StarsDisplay stars={+params.group as ArtifactRarity} />\n      </ListSubheader>\n      {params.children}\n    </List>}\n    {...props}\n  />\n}\n\nfunction sortByRarityAndName(a: { key: ArtifactSetKey, grouper: ArtifactRarity }, b: { key: ArtifactSetKey, grouper: ArtifactRarity }) {\n  if (a.grouper > b.grouper) {\n    return -1\n  }\n  if (a.grouper < b.grouper) {\n    return 1\n  }\n\n  const aName = i18n.t(`artifactNames_gen:${a.key}`)\n  const bName = i18n.t(`artifactNames_gen:${b.key}`)\n  if (aName < bName) {\n    return -1\n  }\n  if (aName > bName) {\n    return 1\n  }\n\n  return 0\n}\n","import { Card, Slider } from \"@mui/material\"\nimport { useCallback, useEffect, useState } from \"react\"\nimport { clamp } from \"../../Util/Util\"\nimport CustomNumberInput from \"../CustomNumberInput\"\n\nexport default function ArtifactLevelSlider({ levelLow, levelHigh, setLow, setHigh, setBoth, dark = false, disabled = false, showLevelText = false }: {\n  levelLow: number,\n  levelHigh: number,\n  setLow: (low: number) => void,\n  setHigh: (high: number) => void,\n  setBoth: (low: number, high: number) => void,\n  dark?: boolean,\n  disabled?: boolean,\n  showLevelText?: boolean,\n}) {\n  const [sliderLow, setsliderLow] = useState(levelLow)\n  const [sliderHigh, setsliderHigh] = useState(levelHigh)\n  const setSlider = useCallback(\n    (e: unknown, value: number | number[]) => {\n      if (typeof value == \"number\") throw new TypeError()\n      const [l, h] = value\n      setsliderLow(l)\n      setsliderHigh(h)\n    },\n    [setsliderLow, setsliderHigh])\n  useEffect(() => setsliderLow(levelLow), [setsliderLow, levelLow])\n\n  useEffect(() => setsliderHigh(levelHigh), [setsliderHigh, levelHigh])\n  return <Card sx={{ width: \"100%\", display: \"flex\", alignItems: \"center\", bgcolor: dark ? \"contentDark.main\" : \"contentLight.main\" }}>\n    <CustomNumberInput\n      value={sliderLow}\n      onChange={val => setLow(clamp(val, 0, levelHigh))}\n      sx={{ px: 1, pl: showLevelText ? 2 : undefined, width: showLevelText ? 100 : 50, }}\n      inputProps={{ sx: { textAlign: showLevelText ? \"right\" : \"center\" } }}\n      startAdornment={showLevelText ? \"Level: \" : undefined}\n      disabled={disabled}\n    />\n    <Slider sx={{ width: 100, flexGrow: 1, mx: 2 }}\n      getAriaLabel={() => 'Arifact Level Range'}\n      value={[sliderLow, sliderHigh]}\n      onChange={setSlider}\n      onChangeCommitted={(e, value) => setBoth(value[0], value[1])}\n      valueLabelDisplay=\"auto\"\n      min={0} max={20} step={1} marks\n      disabled={disabled}\n    />\n    <CustomNumberInput\n      value={sliderHigh}\n      onChange={val => setHigh(clamp(val, levelLow, 20))}\n      sx={{ px: 1, width: 50, }}\n      inputProps={{ sx: { textAlign: \"center\" } }}\n      disabled={disabled}\n    />\n  </Card>\n}\n","import { Typography, Box } from \"@mui/material\";\n\nexport default function CardHeaderCustom({ avatar, title, action }: { avatar?: Displayable, title: Displayable, action?: Displayable }) {\n  return <Box display=\"flex\" gap={1} p={2} alignItems=\"center\" >\n    {avatar}\n    <Typography variant=\"subtitle1\" sx={{ flexGrow: 1 }}>{title}</Typography>\n    {action && <Typography variant=\"caption\">{action}</Typography>}\n  </Box>\n}\n","import { CheckBox, CheckBoxOutlineBlank } from '@mui/icons-material';\nimport { Button, ButtonGroup, ButtonProps, Divider, MenuItem } from '@mui/material';\nimport React, { useCallback, useContext } from 'react';\nimport { CharacterContext } from '../../Context/CharacterContext';\nimport { DataContext } from '../../Context/DataContext';\nimport { DocumentConditional, IDocumentConditionalExclusive, IDocumentConditionalMultiple } from '../../Types/sheet';\nimport { deepClone, deletePropPath, layeredAssignment } from '../../Util/Util';\nimport DropdownButton from '../DropdownMenu/DropdownButton';\nimport SqBadge from '../SqBadge';\nimport { Translate } from '../Translate';\n\ninterface ConditionalSelectorProps {\n  conditional: DocumentConditional,\n  disabled?: boolean,\n}\nexport default function ConditionalSelector({ conditional, disabled = false, }: ConditionalSelectorProps) {\n  if (Object.keys(conditional.states).length === 1 && \"path\" in conditional) {\n    return <SimpleConditionalSelector conditional={conditional} disabled={disabled} />\n  } else if (\"path\" in conditional) {\n    return <ExclusiveConditionalSelector conditional={conditional} disabled={disabled} />\n  } else /*if (\"path\" in Object.entries(conditional.states)[0]) */ {\n    return <MultipleConditionalSelector conditional={conditional} disabled={disabled} />\n  }\n}\n\ninterface SimpleConditionalSelectorProps extends ConditionalSelectorProps {\n  conditional: IDocumentConditionalExclusive\n}\nfunction SimpleConditionalSelector({ conditional, disabled }: SimpleConditionalSelectorProps) {\n  const { character, characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const setConditional = useCallback((v?: string) => {\n    const conditionalValues = deepClone(character.conditional)\n    if (v) {\n      layeredAssignment(conditionalValues, conditional.path, v)\n    } else {\n      deletePropPath(conditionalValues, conditional.path)\n    }\n    characterDispatch({ conditional: conditionalValues })\n  }, [conditional, character, characterDispatch])\n\n  const conditionalValue = data.get(conditional.value).value\n  const [stateKey, st] = Object.entries(conditional.states)[0]\n  const badge = getStateBadge(st.name)\n  const condName = getCondName(conditional.name)\n\n  return <Button fullWidth size=\"small\" sx={{ borderRadius: 0 }} color={conditionalValue ? \"success\" : \"primary\"} onClick={() => setConditional(conditionalValue ? undefined : stateKey)} disabled={disabled} startIcon={conditionalValue ? <CheckBox /> : <CheckBoxOutlineBlank />}>\n    {condName} {badge}\n  </Button>\n}\n\ninterface ExclusiveConditionalSelectorProps extends ConditionalSelectorProps {\n  conditional: IDocumentConditionalExclusive\n}\nfunction ExclusiveConditionalSelector({ conditional, disabled }: ExclusiveConditionalSelectorProps) {\n  const { character, characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const setConditional = useCallback((v?: string) => {\n    const conditionalValues = deepClone(character.conditional)\n    if (v) {\n      layeredAssignment(conditionalValues, conditional.path, v)\n    } else {\n      deletePropPath(conditionalValues, conditional.path)\n    }\n    characterDispatch({ conditional: conditionalValues })\n  }, [conditional, character, characterDispatch])\n\n  const conditionalValue = data.get(conditional.value).value\n  const state = conditionalValue ? conditional.states[conditionalValue] : undefined\n  const badge = state ? getStateBadge(state.name) : <SqBadge color=\"secondary\">Not Active</SqBadge>\n  const condName = getCondName(conditional.name)\n\n  return <DropdownButton fullWidth size=\"small\" sx={{ borderRadius: 0 }} color={conditionalValue ? \"success\" : \"primary\"} title={<span>{condName} {badge}</span>} disabled={disabled}>\n    <MenuItem onClick={() => setConditional()} selected={!state} disabled={!state}>\n      <span>Not Active</span>\n    </MenuItem>\n    <Divider />\n    {Object.entries(conditional.states).map(([stateKey, st]) =>\n      <MenuItem key={stateKey} onClick={() => setConditional(stateKey)} selected={conditionalValue === stateKey} disabled={conditionalValue === stateKey} >{st.name}</MenuItem>)}\n  </DropdownButton>\n}\n\ninterface MultipleConditionalSelectorProps extends ConditionalSelectorProps {\n  conditional: IDocumentConditionalMultiple\n}\nfunction MultipleConditionalSelector({ conditional, disabled }: MultipleConditionalSelectorProps) {\n  const { character, characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const setConditional = useCallback((path: readonly string[], v?: string) => {\n    const conditionalValues = deepClone(character.conditional)\n    if (v) {\n      layeredAssignment(conditionalValues, path, v)\n    } else {\n      deletePropPath(conditionalValues, path)\n    }\n    characterDispatch({ conditional: conditionalValues })\n  }, [character, characterDispatch])\n\n  return <ButtonGroup fullWidth orientation=\"vertical\" disableElevation color=\"secondary\" >\n    {Object.entries(conditional.states).map(([stateKey, st]) => {\n      const conditionalValue = data.get(st.value).value\n      const isSelected = conditionalValue === stateKey\n      return <Button\n        color={isSelected ? \"success\" : \"primary\"}\n        disabled={disabled}\n        fullWidth\n        key={stateKey}\n        onClick={() => setConditional(st.path, conditionalValue ? undefined : stateKey)}\n        size=\"small\"\n        startIcon={isSelected ? <CheckBox /> : <CheckBoxOutlineBlank />}\n        sx={{ borderRadius: 0 }}\n      >\n        {getCondName(st.name)}\n      </Button>\n    })}\n  </ButtonGroup>\n}\n\nfunction isElement(disp: Displayable): disp is JSX.Element {\n  return (typeof disp !== \"string\")\n}\n\n// Use colored badges instead of colored text inside these buttons\nfunction getStateBadge(stateName: Displayable | undefined): Displayable {\n  if (!stateName) return \"\"\n\n  let badgeColor: ButtonProps['color'] = \"primary\"\n  let badgeText = stateName\n  if (stateName && isElement(stateName)) {\n    if (stateName.props.color) {\n      badgeColor = stateName.props.color\n      badgeText = <span>{stateName.props.children}</span>\n    }\n  }\n  return <SqBadge sx={{ ml: 0.5 }} color={badgeColor}>{badgeText}</SqBadge>\n}\n\n// Use colored badges instead of colored text inside these buttons\nfunction getCondName(condName: Displayable): Displayable {\n  if (isElement(condName)) {\n    const key = condName.props.key18\n    const ns = condName.props.ns\n    const values = condName.props.values\n    return <Translate ns={ns} key18={key} values={values} useBadge />\n  }\n  return condName\n}\n","import { CardContent } from \"@mui/material\"\nimport { useContext } from \"react\"\nimport { DataContext } from \"../../Context/DataContext\"\nimport { DocumentConditional, DocumentSection } from \"../../Types/sheet\"\nimport { evalIfFunc } from \"../../Util/Util\"\nimport CardDark from \"../Card/CardDark\"\nimport { HeaderDisplay } from \"../DocumentDisplay\"\nimport FieldsDisplay from \"../FieldDisplay\"\nimport ConditionalSelector from \"./ConditionalSelector\"\n\ntype ConditionalDisplayProps = {\n  conditional: DocumentConditional,\n  hideHeader?: boolean | ((section: DocumentSection) => boolean),\n  hideDesc?: boolean,\n}\n\nexport default function ConditionalDisplay({ conditional, hideHeader = false, hideDesc = false }: ConditionalDisplayProps) {\n  const { data } = useContext(DataContext)\n  let fields\n  if (\"path\" in conditional) {\n    const condVal = data.get(conditional.value).value\n    fields = condVal && conditional.states[condVal]?.fields\n  } else /* if (\"path\" in Object.entries(conditional.states)[0]) */ {\n    fields = Object.values(conditional.states).flatMap(state => {\n      const stateVal = data.get(state.value).value\n      return stateVal ? state.fields : []\n    })\n  }\n  return <CardDark>\n    {!evalIfFunc(hideHeader, conditional) && <HeaderDisplay header={conditional.header} hideDesc={hideDesc} />}\n    <CardContent sx={{ p: 0, \"&:last-child\": { pb: 0 } }}>\n      <ConditionalSelector conditional={conditional} />\n    </CardContent>\n    {fields && <FieldsDisplay fields={fields} />}\n  </CardDark>\n}\n","import { Box, Divider, Typography } from \"@mui/material\"\nimport { useContext } from \"react\"\nimport { DataContext } from \"../Context/DataContext\"\nimport { DocumentSection, IDocumentFields, IDocumentHeader, IDocumentText } from \"../Types/sheet\"\nimport { evalIfFunc } from \"../Util/Util\"\nimport CardDark from \"./Card/CardDark\"\nimport CardHeaderCustom from \"./Card/CardHeaderCustom\"\nimport ConditionalDisplay from \"./Conditional/ConditionalDisplay\"\nimport FieldsDisplay from \"./FieldDisplay\"\nimport InfoTooltip from \"./InfoTooltip\"\n\ntype DocumentDisplayProps = {\n  sections: DocumentSection[],\n  teamBuffOnly?: boolean,\n  hideDesc?: boolean,\n  hideHeader?: boolean | ((section: DocumentSection) => boolean),\n}\n\nexport default function DocumentDisplay({ sections, teamBuffOnly, hideDesc = false, hideHeader = false }: DocumentDisplayProps) {\n  const { data } = useContext(DataContext)\n  if (!sections.length) return null\n  const sectionDisplays = sections.map((s, i) => {\n    // If we can't show this section, return null\n    if (s.canShow && !data.get(s.canShow).value) return null\n    // If we are showing only teambuffs, and this section is not a teambuff, return null\n    if (teamBuffOnly && !s.teamBuff) return null\n    return <SectionDisplay section={s} key={i} hideDesc={hideDesc} hideHeader={hideHeader} />\n  }).filter(s => s)\n  if (!sectionDisplays.length) return null\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>{sectionDisplays}</Box>\n}\n\nfunction SectionDisplay({ section, hideDesc = false, hideHeader = false }: { section: DocumentSection, hideDesc?: boolean, hideHeader?: boolean | ((section: DocumentSection) => boolean) }) {\n  if (\"fields\" in section) {\n    return <FieldsSectionDisplay section={section} hideDesc={hideDesc} hideHeader={hideHeader} />\n  } else if (\"states\" in section) {\n    return <ConditionalDisplay conditional={section} hideDesc={hideDesc} hideHeader={hideHeader} />\n  } else /* if (\"text\" in section) */ {\n    return <TextSectionDisplay section={section} />\n  }\n}\n\nfunction FieldsSectionDisplay({ section, hideDesc, hideHeader }: { section: IDocumentFields, hideDesc?: boolean, hideHeader?: boolean | ((section: DocumentSection) => boolean) }) {\n  return <CardDark>\n    {!evalIfFunc(hideHeader, section) && section.header &&\n      <HeaderDisplay header={section.header} hideDesc={hideDesc} hideDivider={section.fields.length === 0} />\n    }\n    <FieldsDisplay fields={section.fields} />\n  </CardDark>\n}\n\nfunction TextSectionDisplay({ section }: { section: IDocumentText }) {\n  const { data } = useContext(DataContext)\n  return <div>\n    {evalIfFunc(section.text, data)}\n  </div>\n}\n\nexport function HeaderDisplay({ header, hideDesc, hideDivider }: { header: IDocumentHeader, hideDesc?: boolean, hideDivider?: boolean | ((section: DocumentSection) => boolean) }) {\n  const { data } = useContext(DataContext)\n  let { icon, title, action } = header\n  icon = evalIfFunc(icon, data)\n  const description = !hideDesc && evalIfFunc(header.description, data)\n  const displayTitle = hideDesc ? title : <span>{title} <InfoTooltip title={<Typography>{description}</Typography>} /></span>\n  return <>\n    <CardHeaderCustom avatar={icon} title={displayTitle} action={action} />\n    {!hideDivider && <Divider />}\n  </>\n}\n","import { Button, ButtonGroup, MenuItem } from '@mui/material';\nimport { useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { ambiguousLevel, ambiguousLevelLow, ascensionMaxLevel, ascensionMaxLevelLow, maxLevel, maxLevelLow, milestoneLevels, milestoneLevelsLow } from '../Data/LevelData';\nimport { Ascension } from '../Types/consts';\nimport { clamp } from '../Util/Util';\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from './CustomNumberInput';\nimport DropdownButton from './DropdownMenu/DropdownButton';\n\nexport default function LevelSelect({ level, ascension, setBoth, useLow = false }: { level: number, ascension: Ascension, setBoth: (action: { level?: number, ascension?: Ascension }) => void, useLow?: boolean }) {\n  const { t } = useTranslation(\"ui\")\n  const ascensionMaxLevels = useLow ? ascensionMaxLevelLow : ascensionMaxLevel\n  const setLevel = useCallback((level: number = 1) => {\n    level = clamp(level, 1, useLow ? maxLevelLow : maxLevel)\n    const ascension = ascensionMaxLevels.findIndex(ascenML => level <= ascenML) as Ascension\n    setBoth({ level, ascension })\n  }, [setBoth, ascensionMaxLevels, useLow])\n  const setAscension = useCallback(() => {\n    const lowerAscension = ascensionMaxLevels.findIndex(ascenML => level !== 90 && level === ascenML) as Ascension\n    if (ascension === lowerAscension) setBoth({ ascension: (ascension + 1) as Ascension })\n    else setBoth({ ascension: lowerAscension })\n  }, [setBoth, ascensionMaxLevels, ascension, level])\n  return <ButtonGroup sx={{ bgcolor: t => t.palette.contentDark.main }} >\n    <CustomNumberInputButtonGroupWrapper >\n      <CustomNumberInput onChange={setLevel} value={level}\n        startAdornment=\"Lv. \"\n        inputProps={{ min: 1, max: 90, sx: { textAlign: \"center\", width: \"3em\" } }}\n        sx={{ height: \"100%\", pl: 2 }} />\n    </CustomNumberInputButtonGroupWrapper>\n    <Button sx={{ pl: 1, whiteSpace: 'nowrap' }} disabled={!(useLow ? ambiguousLevelLow : ambiguousLevel)(level)} onClick={setAscension}><strong>/ {ascensionMaxLevel[ascension]}</strong></Button>\n    <DropdownButton title={t(\"selectlevel\")} sx={{ flexGrow: 1 }}>\n      {[...(useLow ? milestoneLevelsLow : milestoneLevels)].map(([lv, as]) => {\n        const selected = lv === level && as === ascension\n        return <MenuItem key={`${lv}/${as}`} selected={selected} disabled={selected} onClick={() => setBoth({ level: lv, ascension: as })}>\n          {lv === ascensionMaxLevels[as] ? `Lv. ${lv}` : `Lv. ${lv}/${ascensionMaxLevels[as]}`}\n        </MenuItem>\n      })}\n    </DropdownButton>\n  </ButtonGroup>\n}\n","import { MenuItem } from \"@mui/material\"\nimport { useTranslation } from \"react-i18next\"\nimport { allRefinement, Refinement } from \"../Types/consts\"\nimport DropdownButton from \"./DropdownMenu/DropdownButton\"\n\nexport default function RefinementDropdown({ refinement, setRefinement }: { refinement: Refinement, setRefinement: (r: Refinement) => void }) {\n  const { t } = useTranslation(\"ui\")\n  return <DropdownButton title={t(\"refinement\", { value: refinement })}>\n    {allRefinement.map(r =>\n      <MenuItem key={r} onClick={() => setRefinement(r)} selected={refinement === r} disabled={refinement === r}>\n        {t(\"refinement\", { value: r })}\n      </MenuItem>)}\n  </DropdownButton>\n}\n","import { Button, ButtonProps, styled } from \"@mui/material\";\n\nconst DisabledButton = styled(Button)(({ theme }) => ({\n  \"&.Mui-disabled\": {\n    backgroundColor: theme.palette.primary.dark,\n    color: theme.palette.text.secondary,\n  }\n}))\n\nexport default function TextButton({ children, disabled, ...props }: ButtonProps) {\n  return <DisabledButton {...props} disabled  >\n    {children}\n  </DisabledButton>\n}\n","import { createContext } from \"react\"\nimport { NumNode } from \"../Formula/type\"\nimport { Build } from \"../PageCharacter/CharacterDisplay/Tabs/TabOptimize/common\"\n\nexport type ChartData = {\n  valueNode: NumNode,\n  plotNode: NumNode,\n  data: Build[]\n}\nexport type GraphContextObj = {\n  chartData?: ChartData\n  setChartData: (data: ChartData | undefined) => void\n  graphBuilds: string[][] | undefined\n  setGraphBuilds: (builds: string[][] | undefined) => void\n}\nexport const GraphContext = createContext({} as GraphContextObj)\n","import { Button } from '@mui/material';\nimport React, { Suspense, useContext, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport ThumbSide from '../../Components/Character/ThumbSide';\nimport { CharacterContext } from '../../Context/CharacterContext';\nimport useCharSelectionCallback from '../../ReactHooks/useCharSelectionCallback';\n\nconst CharacterSelectionModal = React.lazy(() => import('../CharacterSelectionModal'))\n\nexport default function CharSelectDropdown() {\n  const { t } = useTranslation(\"page_character\")\n  const { characterSheet } = useContext(CharacterContext)\n  const [showModal, setshowModal] = useState(false)\n  const setCharacter = useCharSelectionCallback()\n  return <>\n    <Suspense fallback={false}>\n      <CharacterSelectionModal show={showModal} onHide={() => setshowModal(false)} onSelect={setCharacter} />\n    </Suspense>\n    <Button color=\"info\" onClick={() => setshowModal(true)} startIcon={<ThumbSide src={characterSheet?.thumbImgSide} />} >{characterSheet?.name ?? t(\"selectCharacter\")}</Button>\n  </>\n}\n","import { ExpandMore } from '@mui/icons-material';\nimport { Accordion, AccordionDetails, AccordionSummary, Box, CardContent, CardHeader, Divider, Skeleton, Typography } from '@mui/material';\nimport { MutableRefObject, Suspense, useCallback, useContext, useEffect, useRef, useState } from 'react';\nimport AmpReactionModeText from '../../Components/AmpReactionModeText';\nimport CardDark from '../../Components/Card/CardDark';\nimport CardHeaderCustom from '../../Components/Card/CardHeaderCustom';\nimport CardLight from '../../Components/Card/CardLight';\nimport CloseButton from '../../Components/CloseButton';\nimport ColorText from '../../Components/ColoredText';\nimport ImgIcon from '../../Components/Image/ImgIcon';\nimport ModalWrapper from \"../../Components/ModalWrapper\";\nimport SqBadge from '../../Components/SqBadge';\nimport { DataContext } from '../../Context/DataContext';\nimport { FormulaDataContext } from '../../Context/FormulaDataContext';\nimport { DatabaseContext } from '../../Database/Database';\nimport { getDisplayHeader, getDisplaySections } from '../../Formula/DisplayUtil';\nimport { DisplaySub, Variant } from '../../Formula/type';\nimport { NodeDisplay, nodeVStr } from '../../Formula/uiData';\nimport usePromise from '../../ReactHooks/usePromise';\nimport { allAmpReactions, AmpReactionKey } from '../../Types/consts';\n\nexport default function FormulaModal() {\n  const { modalOpen } = useContext(FormulaDataContext)\n  const { setFormulaData } = useContext(FormulaDataContext)\n  const onCloseHandler = useCallback(() => setFormulaData?.(undefined, undefined), [setFormulaData])\n  return <ModalWrapper open={!!modalOpen} onClose={onCloseHandler}>\n    <CardDark>\n      <CardHeader title=\"Formulas & Calculations\" action={<CloseButton onClick={onCloseHandler} />} />\n      <CardContent sx={{ pt: 0 }}>\n        <CalculationDisplay />\n      </CardContent>\n    </CardDark>\n  </ModalWrapper>\n}\n\nfunction CalculationDisplay() {\n  const { data } = useContext(DataContext)\n  const { data: contextData } = useContext(FormulaDataContext)\n  const sections = getDisplaySections(contextData ?? data)\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />} >\n    <Box sx={{ mr: -1, mb: -1 }}>\n      {sections.map(([key, Nodes]) =>\n        <FormulaCalc key={key} displayNs={Nodes} sectionKey={key} />)}\n    </Box>\n  </Suspense>\n}\nfunction FormulaCalc({ sectionKey, displayNs }: { displayNs: DisplaySub<NodeDisplay>, sectionKey: string }) {\n  const { data } = useContext(DataContext)\n  const { database } = useContext(DatabaseContext)\n  const { data: contextData } = useContext(FormulaDataContext)\n  const header = usePromise(() => getDisplayHeader(contextData ?? data, sectionKey, database), [contextData, data, sectionKey])\n  if (!header) return null\n  if (Object.entries(displayNs).every(([_, node]) => node.isEmpty)) return null\n  const { title, icon, action } = header\n  return <CardLight sx={{ mb: 1 }}>\n    <CardHeaderCustom avatar={icon && <ImgIcon size={2} sx={{ m: -1 }} src={icon} />} title={title} action={action && <SqBadge>{action}</SqBadge>} />\n    <Divider />\n    <CardContent>\n      {Object.entries(displayNs).map(([key, node]) => !node.isEmpty && <FormulaAccordian key={key} node={node} />)}\n    </CardContent>\n  </CardLight>\n}\nfunction FormulaAccordian({ node }: { node: NodeDisplay }) {\n  const { node: contextNode } = useContext(FormulaDataContext)\n  const [expanded, setExpanded] = useState(false);\n  const handleChange = useCallback((e: React.SyntheticEvent, isExpanded: boolean) => setExpanded(isExpanded), [])\n  const scrollRef = useRef<HTMLDivElement>() as MutableRefObject<HTMLDivElement | null>\n\n  useEffect(() => {\n    if (node === contextNode) setTimeout(() => scrollRef?.current?.scrollIntoView?.({ behavior: \"smooth\" }), 300)\n  }, [scrollRef, node, contextNode])\n\n  return <Accordion sx={{ bgcolor: \"contentDark.main\" }} expanded={node === contextNode || expanded} onChange={handleChange} ref={scrollRef} >\n    <AccordionSummary expandIcon={<ExpandMore />} >\n      <Typography><ColorText color={node.info.variant}>{node.info.name}</ColorText> <strong>{nodeVStr(node)}</strong></Typography>\n      {allAmpReactions.includes(node.info.variant as any) && <Box sx={{ display: \"inline-block\", ml: \"auto\", mr: 2 }}>\n        <AmpReactionModeText reaction={node.info.variant as AmpReactionKey} trigger={node.info.subVariant as Variant} />\n      </Box>}\n    </AccordionSummary>\n    <AccordionDetails >\n      {node.formulas.map((subform, i) => <Typography key={i} component=\"div\">{subform}</Typography>)}\n    </AccordionDetails>\n  </Accordion>\n}\n","import { IconButton, IconButtonProps, styled } from \"@mui/material\";\n\ninterface ExpandMoreProps extends IconButtonProps {\n  expand: boolean;\n}\nconst ExpandButton = styled((props: ExpandMoreProps) => {\n  const { expand, ...other } = props;\n  return <IconButton {...other} />;\n})(({ theme, expand }) => ({\n  transform: !expand ? 'rotate(0deg)' : 'rotate(180deg)',\n  marginLeft: 'auto',\n  transition: (theme as any).transitions.create('transform', {\n    duration: (theme as any).transitions.duration.shortest,\n  }),\n}));\n\nexport default ExpandButton","import { Replay } from \"@mui/icons-material\"\nimport { Button, ButtonGroup, ButtonGroupProps, styled } from \"@mui/material\"\nimport { ReactNode } from \"react\"\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"./CustomNumberInput\"\nimport TextButton from \"./TextButton\"\n\ntype StatInputInput = ButtonGroupProps & {\n  name: Displayable,\n  children?: ReactNode,\n  value: number,\n  placeholder?: string,\n  defaultValue?: number,\n  onValueChange: (newValue: number | undefined) => void,\n  percent?: boolean,\n  disabled?: boolean,\n  onReset?: () => void\n}\nconst FlexButtonGroup = styled(ButtonGroup)({\n  display: \"flex\"\n})\n\nexport default function StatInput({ name, children, value, placeholder, defaultValue = 0, onValueChange, percent = false, disabled = false, onReset, ...restProps }: StatInputInput) {\n\n  return <FlexButtonGroup {...restProps} >\n    {children}\n    <TextButton sx={{ px: 1 }}>\n      {name}\n    </TextButton>\n    <CustomNumberInputButtonGroupWrapper sx={{ flexBasis: \"10em\", flexGrow: 1 }} >\n      <CustomNumberInput\n        sx={{ px: 1 }}\n        inputProps={{\n          sx: { textAlign: \"right\" }\n        }}\n        float={percent}\n        placeholder={placeholder}\n        value={value}\n        onChange={onValueChange}\n        disabled={disabled}\n        endAdornment={percent ? \"%\" : undefined}\n      />\n    </CustomNumberInputButtonGroupWrapper>\n    <Button sx={{ flexShrink: 2 }} size=\"small\" color=\"error\" onClick={() => onReset ? onReset() : onValueChange(defaultValue)} disabled={disabled || value === defaultValue} >\n      <Replay />\n    </Button>\n  </FlexButtonGroup>\n}\n","import { CheckBox, CheckBoxOutlineBlank, ExpandMore, Replay } from \"@mui/icons-material\";\nimport { Box, Button, CardContent, Chip, Collapse, Grid, Typography } from \"@mui/material\";\nimport { useCallback, useContext, useState } from 'react';\nimport { useTranslation } from \"react-i18next\";\nimport { CharacterContext } from \"../Context/CharacterContext\";\nimport { DataContext } from \"../Context/DataContext\";\nimport { uiInput as input } from \"../Formula\";\nimport { nodeVStr } from \"../Formula/uiData\";\nimport KeyMap from '../KeyMap';\nimport { allElementsWithPhy, ElementKeyWithPhy } from \"../Types/consts\";\nimport CardLight from \"./Card/CardLight\";\nimport ColorText from \"./ColoredText\";\nimport ExpandButton from \"./ExpandButton\";\nimport StatIcon from \"./StatIcon\";\nimport StatInput from \"./StatInput\";\n\nexport function EnemyExpandCard() {\n  const { t } = useTranslation(\"ui\")\n  const { characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const [expanded, setexpanded] = useState(false)\n  const toggle = useCallback(() => setexpanded(!expanded), [setexpanded, expanded])\n  const eLvlNode = data.get(input.enemy.level)\n  const eDefRed = data.get(input.enemy.defRed)\n  const eDefIgn = data.get(input.enemy.defIgn)\n  const onReset = useCallback(() => characterDispatch({ enemyOverride: {} }), [characterDispatch])\n\n  return <CardLight>\n    <CardContent sx={{ display: \"flex\", gap: 1, alignItems: \"center\", flexWrap: \"wrap\" }}>\n      <Chip size=\"small\" color=\"success\" label={<span>{eLvlNode.info.name} <strong>{eLvlNode.value}</strong></span>} />\n      {allElementsWithPhy.map(element => <Typography key={element} ><EnemyResText element={element} /></Typography>)}\n      <Typography>DEF Red. {nodeVStr(eDefRed)}</Typography>\n      <Typography>DEF Ignore {nodeVStr(eDefIgn)}</Typography>\n      <Box flexGrow={1} display=\"flex\" justifyContent=\"flex-end\" gap={1}>\n        <Button size=\"small\" color=\"error\" onClick={onReset} startIcon={<Replay />}>{t`reset`}</Button>\n        <ExpandButton\n          expand={expanded}\n          onClick={toggle}\n          aria-expanded={expanded}\n          aria-label=\"show more\"\n          size=\"small\"\n          sx={{ marginLeft: 0 }}\n        >\n          <ExpandMore />\n        </ExpandButton>\n      </Box>\n    </CardContent>\n    <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\n      <CardContent sx={{ pt: 0 }}>\n        <EnemyEditor />\n      </CardContent>\n    </Collapse>\n  </CardLight>\n}\n\nexport function EnemyResText({ element }: { element: ElementKeyWithPhy }) {\n  const { data } = useContext(DataContext)\n  const node = data.get(input.enemy[`${element}_res_`])\n  const immune = !isFinite(node.value)\n  const content = immune ? <span >{StatIcon[element]} &#8734;</span> :\n    <span >{StatIcon[element]} <strong>{nodeVStr(node)}</strong></span>\n  return <ColorText color={element}>{content}</ColorText>\n}\n\nexport function EnemyEditor({ bsProps = { xs: 12, md: 6 } }: { bsProps?: object }) {\n  const { character: { enemyOverride }, characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const defaultVal = 10\n\n  const eLvl = enemyOverride.enemyLevel ?? data.get(input.lvl).value\n  const eDefRed = enemyOverride.enemyDefIgn_ ?? 0\n  const eDefIgn = enemyOverride.enemyDefRed_ ?? 0\n  return <Grid container spacing={1}>\n    <Grid item {...bsProps}>\n      <Button fullWidth sx={{ height: \"100%\" }} size=\"small\" component=\"a\" color=\"warning\" href=\"https://genshin-impact.fandom.com/wiki/Resistance#Base_Enemy_Resistances\" target=\"_blank\" rel=\"noreferrer\">\n        To get the specific resistance values of enemies, please visit the wiki.\n      </Button>\n    </Grid>\n    <Grid item {...bsProps}>\n      <StatInput\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\n        name={<b>{KeyMap.get(\"enemyLevel\")}</b>}\n        value={eLvl}\n        placeholder={KeyMap.getStr(\"enemyLevel\")}\n        defaultValue={data.get(input.lvl).value}\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyLevel\", value })}\n        onReset={() => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyLevel\", value: undefined })}\n      />\n    </Grid>\n    {allElementsWithPhy.map(eleKey => {\n      const statKey = `${eleKey}_enemyRes_`\n      const val = enemyOverride[statKey]\n      const elementImmunity = val === Number.MAX_VALUE\n      return <Grid item key={eleKey} {...bsProps}>\n        <StatInput\n          sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\n          name={<ColorText color={eleKey}><b>{KeyMap.get(statKey)}</b></ColorText>}\n          value={val !== undefined ? (elementImmunity ? Infinity : val) : 10}\n          placeholder={elementImmunity ? \"∞ \" : KeyMap.getStr(statKey)}\n          defaultValue={defaultVal}\n          onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey, value })}\n          disabled={elementImmunity}\n          percent\n        >\n          <Button color={eleKey} onClick={() => characterDispatch({ type: \"enemyOverride\", statKey, value: elementImmunity ? defaultVal : Number.MAX_VALUE })} startIcon={elementImmunity ? <CheckBox /> : <CheckBoxOutlineBlank />} >\n            Immunity\n          </Button>\n        </StatInput>\n      </Grid>\n    })}\n    <Grid item {...bsProps}>\n      <StatInput\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\n        name={<b>{KeyMap.get(\"enemyDefIgn_\")}</b>}\n        value={eDefRed}\n        placeholder={KeyMap.getStr(\"enemyDefIgn_\")}\n        defaultValue={0}\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyDefIgn_\", value })}\n        percent\n      />\n    </Grid>\n    <Grid item {...bsProps}>\n      <StatInput\n        sx={{ bgcolor: t => t.palette.contentLight.main, width: \"100%\" }}\n        name={<b>{KeyMap.get(\"enemyDefRed_\")}</b>}\n        value={eDefIgn}\n        placeholder={KeyMap.getStr(\"enemyDefRed_\")}\n        defaultValue={0}\n        onValueChange={value => characterDispatch({ type: \"enemyOverride\", statKey: \"enemyDefRed_\", value })}\n        percent\n      />\n    </Grid>\n    <Grid item xs={12}>\n      <small>Note: Genshin Impact halves resistance shred values below 0%. For the sake of calculations enter the RAW value and GO will do the rest. (e.g. 10% - 20% = -10%)</small>\n    </Grid>\n  </Grid>\n}\n","import { CardContent, CardHeader, Grid, ListItem, Stack, Typography, Box } from \"@mui/material\";\nimport { useCallback, useContext, useMemo } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport CardDark from \"../../Components/Card/CardDark\";\nimport CardLight from \"../../Components/Card/CardLight\";\nimport CloseButton from \"../../Components/CloseButton\";\nimport ColorText from \"../../Components/ColoredText\";\nimport { EnemyExpandCard } from \"../../Components/EnemyEditor\";\nimport { FieldDisplayList, NodeFieldDisplay } from \"../../Components/FieldDisplay\";\nimport ModalWrapper from \"../../Components/ModalWrapper\";\nimport StatEditorList from \"../../Components/StatEditorList\";\nimport { CharacterContext } from \"../../Context/CharacterContext\";\nimport { DataContext } from \"../../Context/DataContext\";\nimport { FormulaDataContext } from \"../../Context/FormulaDataContext\";\nimport { allInputPremodKeys, uiInput as input } from \"../../Formula\";\nimport { ReadNode } from \"../../Formula/type\";\nimport { nodeVStr } from \"../../Formula/uiData\";\nimport { allEleDmgKeys, allEleResKeys } from \"../../KeyMap\";\n\nconst cols = {\n  xs: 1, md: 2, lg: 3\n}\n\nexport default function StatModal({ open, onClose }) {\n  const { t } = useTranslation(\"page_character\")\n  return <ModalWrapper open={open} onClose={onClose}>\n    <CardDark>\n      <CardHeader title={t`addStats.title`} action={<CloseButton onClick={onClose} />} />\n      <CardContent sx={{ pt: 0 }}>\n        <Stack spacing={1}>\n          <BonusStatsEditor />\n          <EnemyExpandCard />\n          <MainStatsCards />\n        </Stack>\n      </CardContent></CardDark>\n  </ModalWrapper>\n}\nconst keys = [...allInputPremodKeys]\nconst wrapperFunc = (e: JSX.Element, key?: string) => <Grid item key={key} xs={1}>{e}</Grid>\nfunction BonusStatsEditor() {\n  const { character: { bonusStats }, characterDispatch } = useContext(CharacterContext)\n  const setFilter = useCallback((bonusStats) => characterDispatch({ bonusStats }), [characterDispatch],)\n  return <CardLight>\n    <CardContent sx={{ display: \"flex\" }}>\n      <Grid container columns={cols} sx={{ pt: 1 }} spacing={1}>\n        <StatEditorList statKeys={keys} statFilters={bonusStats} setStatFilters={setFilter} wrapperFunc={wrapperFunc} />\n      </Grid>\n    </CardContent>\n  </CardLight>\n}\n\nconst mainBaseKeys = [\"hp\", \"atk\", \"def\"] as const\nconst mainSubKeys = [\"eleMas\", \"critRate_\", \"critDMG_\", \"enerRech_\", \"heal_\"] as const\nconst mainReadNodes = [...mainBaseKeys, ...mainSubKeys].map(k => input.total[k])\nconst mainEditKeys = [\"atk_\", \"atk\", \"hp_\", \"hp\", \"def_\", \"def\", ...mainSubKeys] as const\n\nconst otherStatKeys = [\n  ...allEleDmgKeys,\n  ...allEleResKeys,\n  \"stamina\", \"incHeal_\", \"shield_\", \"cdRed_\"\n] as const\n\nconst miscStatkeys = allInputPremodKeys.filter(k => !mainEditKeys.includes(k as any) && !otherStatKeys.includes(k as any))\n\n\nfunction StatDisplayContent({ nodes, extra }: { nodes: ReadNode<number>[], extra?: Displayable }) {\n  const { data, oldData } = useContext(DataContext)\n  const { setFormulaData } = useContext(FormulaDataContext)\n  return <FieldDisplayList >\n    {nodes.map(rn => <NodeFieldDisplay component={ListItem} key={JSON.stringify(rn.info)} node={data.get(rn)} oldValue={oldData?.get(rn)?.value} data={data} setFormulaData={setFormulaData} />)}\n    {extra}\n  </FieldDisplayList>\n}\n\nfunction MainStatsCards() {\n  const { characterSheet } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const specialNode = data.get(input.special)\n  const charEle = characterSheet.elementKey\n  const isMelee = characterSheet.isMelee()\n\n  const otherStatReadNodes = useMemo(() => {\n    const nodes = otherStatKeys.filter(k => {\n      if (k.includes(charEle)) return false\n      if (isMelee && k.includes(\"physical\")) return true\n      return true\n    }).map(k => input.total[k])\n\n    return nodes.filter(n => !!data.get(n).value)\n  }, [data, charEle, isMelee])\n\n\n  const miscStatReadNodes = useMemo(() => miscStatkeys.map(k => input.total[k]).filter(n => data.get(n).value), [data])\n\n  return <CardLight><CardContent>\n    <Grid container columns={cols} spacing={1}>\n      <Grid item xs={1}>\n        <StatDisplayCard title=\"Main Stats\">\n          <StatDisplayContent nodes={mainReadNodes}\n            extra={specialNode && <ListItem sx={{ display: \"flex\", justifyContent: \"space-between\" }}>\n              <span><b>Special:</b> <ColorText color={specialNode.info.variant}>{specialNode.info.icon} {specialNode.info.name}</ColorText></span>\n              <span >{nodeVStr(specialNode)}</span>\n            </ListItem>}\n          />\n        </StatDisplayCard>\n      </Grid>\n      <Grid item xs={1}>\n        <StatDisplayCard title=\"Other Stats\">\n          <StatDisplayContent nodes={otherStatReadNodes} />\n        </StatDisplayCard>\n      </Grid>\n      {!!miscStatReadNodes.length && <Grid item xs={1}>\n        <StatDisplayCard title=\"Misc Stats\">\n          <StatDisplayContent nodes={miscStatReadNodes} />\n        </StatDisplayCard>\n      </Grid>}\n    </Grid>\n  </CardContent></CardLight>\n}\nfunction StatDisplayCard({ title, children }) {\n  return <CardDark>\n    <CardContent sx={{ py: 1 }}>\n      <Box display=\"flex\" justifyContent=\"space-between\">\n        <Typography variant=\"subtitle1\">{title}</Typography>\n      </Box>\n    </CardContent>\n    {children}\n  </CardDark>\n}\n","import { createContext } from \"react\";\n\nexport const OptimizationTargetContext = createContext(undefined as string[] | undefined)\n","import { ArtSetExclusion } from \"../../../../Database/DataManagers/BuildSettingData\";\nimport { forEachNodes, mapFormulas } from \"../../../../Formula/internal\";\nimport { allOperations, constantFold, OptNode } from \"../../../../Formula/optimization\";\nimport { ConstantNode } from \"../../../../Formula/type\";\nimport { constant, customRead, max, min, threshold } from \"../../../../Formula/utils\";\nimport { allSlotKeys, ArtifactSetKey, SlotKey } from \"../../../../Types/consts\";\nimport { assertUnreachable, objectKeyMap, objectMap, range } from \"../../../../Util/Util\";\n\ntype MicropassOperation = \"reaffine\" | \"pruneArtRange\" | \"pruneNodeRange\" | \"pruneOrder\"\nexport function pruneAll(nodes: OptNode[], minimum: number[], arts: ArtifactsBySlot, numTop: number, exclusion: ArtSetExclusion, forced: Dict<MicropassOperation, boolean>): { nodes: OptNode[], arts: ArtifactsBySlot } {\n  let should = forced\n  /** If `key` makes progress, all operations in `value` should be performed */\n  const deps: StrictDict<MicropassOperation, Dict<MicropassOperation, true>> = {\n    pruneOrder: { pruneNodeRange: true },\n    pruneArtRange: { pruneNodeRange: true },\n    pruneNodeRange: { reaffine: true },\n    reaffine: { pruneOrder: true, pruneArtRange: true, pruneNodeRange: true }\n  }\n  let count = 0\n  while (Object.values(should).some(x => x) && count++ < 20) {\n    if (should.pruneOrder) {\n      delete should.pruneOrder\n      const newArts = pruneOrder(arts, numTop, exclusion)\n      if (arts !== newArts) {\n        arts = newArts\n        should = { ...should, ...deps.pruneOrder }\n      }\n    }\n    if (should.pruneArtRange) {\n      delete should.pruneArtRange\n      const newArts = pruneArtRange(nodes, arts, minimum)\n      if (arts !== newArts) {\n        arts = newArts\n        should = { ...should, ...deps.pruneArtRange }\n      }\n    }\n    if (should.pruneNodeRange) {\n      delete should.pruneNodeRange\n      const newNodes = pruneNodeRange(nodes, arts)\n      if (nodes !== newNodes) {\n        nodes = newNodes\n        should = { ...should, ...deps.pruneNodeRange }\n      }\n    }\n    if (should.reaffine) {\n      delete should.reaffine\n      const { nodes: newNodes, arts: newArts } = reaffine(nodes, arts)\n      if (nodes !== newNodes || arts !== newArts) {\n        nodes = newNodes\n        arts = newArts\n        should = { ...should, ...deps.reaffine }\n      }\n    }\n  }\n  return { nodes, arts }\n}\n\nexport function pruneExclusion(nodes: OptNode[], exclusion: ArtSetExclusion): OptNode[] {\n  const maxValues: Dict<keyof typeof exclusion, number> = {}\n  for (const [key, e] of Object.entries(exclusion)) {\n    if (!e.includes(4)) continue\n    maxValues[key] = e.includes(2) ? 1 : 3\n  }\n  return mapFormulas(nodes, f => f, f => {\n    if (f.operation !== \"threshold\") return f\n\n    const [v, t, pass, fail] = f.operands\n    if (v.operation === \"read\" && t.operation === \"const\") {\n      const key = v.path[v.path.length - 1], thres = t.value\n      if (key in maxValues) {\n        const max: number = maxValues[key]\n        if (max < thres) return fail\n        if (thres === 2 && exclusion[key]!.includes(2))\n          return threshold(v, 4, pass, fail)\n      }\n    }\n    return f\n  })\n}\n\nfunction reaffine(nodes: OptNode[], arts: ArtifactsBySlot, forceRename: boolean = false): { nodes: OptNode[], arts: ArtifactsBySlot } {\n  const affineNodes = new Set<OptNode>(), topLevelAffine = new Set<OptNode>()\n\n  function visit(node: OptNode, isAffine: boolean) {\n    if (isAffine) affineNodes.add(node)\n    else node.operands.forEach(op => affineNodes.has(op) && topLevelAffine.add(op))\n  }\n\n  const dynKeys = new Set<string>()\n\n  forEachNodes(nodes, _ => { }, f => {\n    const { operation } = f\n    switch (operation) {\n      case \"read\":\n        dynKeys.add(f.path[1])\n        visit(f, true)\n        break\n      case \"add\": visit(f, f.operands.every(op => affineNodes.has(op))); break\n      case \"mul\": {\n        const nonConst = f.operands.filter(op => op.operation !== \"const\")\n        visit(f, nonConst.length === 0 || (nonConst.length === 1 && affineNodes.has(nonConst[0])))\n        break\n      }\n      case \"const\": visit(f, true); break\n      case \"res\": case \"threshold\": case \"sum_frac\":\n      case \"max\": case \"min\": visit(f, false); break\n      default: assertUnreachable(operation)\n    }\n  })\n\n  if ([...topLevelAffine].every(({ operation }) => operation === \"read\" || operation === \"const\") &&\n    Object.keys(arts.base).length === dynKeys.size)\n    return { nodes, arts }\n\n  let current = -1\n  function nextDynKey(): string {\n    while (dynKeys.has(`${++current}`));\n    return `${current}`\n  }\n\n  nodes.forEach(node => affineNodes.has(node) && topLevelAffine.add(node))\n  const affine = [...topLevelAffine].filter(f => f.operation !== \"const\")\n  const affineMap = new Map(affine.map(node => [node,\n    !forceRename && node.operation === \"read\" && node.path[0] === \"dyn\"\n      ? node\n      : { ...customRead([\"dyn\", `${nextDynKey()}`]), accu: \"add\" as const }]))\n  nodes = mapFormulas(nodes, f => affineMap.get(f) ?? f, f => f)\n\n  function reaffineArt(stat: DynStat): DynStat {\n    const values = constantFold([...affineMap.keys()], {\n      dyn: objectMap(stat, (value) => constant(value))\n    } as any, _ => true)\n    return Object.fromEntries([...affineMap.values()].map((v, i) => [v.path[1], (values[i] as ConstantNode<number>).value]))\n  }\n  const result = {\n    nodes, arts: {\n      base: reaffineArt(arts.base),\n      values: objectKeyMap(allSlotKeys, slot =>\n        arts.values[slot].map(({ id, set, values }) => ({ id, set, values: reaffineArt(values) })))\n    }\n  }\n  const offsets = Object.entries(reaffineArt({}))\n  for (const arts of Object.values(result.arts.values))\n    for (const { values } of arts)\n      for (const [key, baseValue] of offsets)\n        values[key] -= baseValue\n  return result\n}\n/** Remove artifacts that cannot be in top `numTop` builds */\nfunction pruneOrder(arts: ArtifactsBySlot, numTop: number, exclusion: ArtSetExclusion): ArtifactsBySlot {\n  let progress = false\n  /**\n   * Note:\n   * This function assumes that every base (reaffined) stats are monotonically increasing. That is, artifacts\n   * with higher stats are better. This remains true as long as the main and substats are in increasing. Set\n   * effects that decrease enemy resistance (which is monotonically decreasing) does not violate this assumption\n   * as set effects are not handled here.\n   */\n  const allowRainbow = !exclusion.rainbow?.length, keys = Object.keys(arts.base)\n  const noSwitchIn = new Set(Object.entries(exclusion).filter(([_, v]) => v.length).map(([k]) => k) as ArtifactSetKey[])\n  const noSwitchOut = new Set(Object.entries(exclusion).filter(([_, v]) => v.includes(2) && !v.includes(4)).map(([k]) => k) as ArtifactSetKey[])\n  const values = objectKeyMap(allSlotKeys, slot => {\n    const list = arts.values[slot]\n    const newList = list.filter(art => {\n      let count = 0\n      return list.every(other => {\n        const otherBetterEqual = keys.every(k => (other.values[k] ?? 0) >= (art.values[k] ?? 0))\n        const otherMaybeBetter = keys.some(k => (other.values[k] ?? 0) > (art.values[k] ?? 0))\n        const otherBetter = otherBetterEqual && (otherMaybeBetter || other.id > art.id)\n        const canSwitch = (allowRainbow && !noSwitchIn.has(other.set!) && !noSwitchOut.has(art.set!)) || art.set === other.set\n        if (otherBetter && canSwitch) count++\n        return count < numTop\n      })\n    })\n    if (newList.length !== list.length) progress = true\n    return newList\n  })\n  return progress ? { base: arts.base, values } : arts\n}\n/** Remove artifacts that cannot reach `minimum` in any build */\nfunction pruneArtRange(nodes: OptNode[], arts: ArtifactsBySlot, minimum: number[]): ArtifactsBySlot {\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\n  const wrap = { arts }\n  while (true) {\n    const artRanges = objectKeyMap(allSlotKeys, slot => computeArtRange(wrap.arts.values[slot]))\n    const otherArtRanges = objectKeyMap(allSlotKeys, key =>\n      addArtRange(Object.entries(artRanges).map(a => a[0] === key ? baseRange : a[1]).filter(x => x)))\n\n    let progress = false\n    const values = objectKeyMap(allSlotKeys, slot => {\n      const result = wrap.arts.values[slot].filter(art => {\n        const read = addArtRange([computeArtRange([art]), otherArtRanges[slot]])\n        const newRange = computeNodeRange(nodes, read)\n        return nodes.every((node, i) => newRange.get(node)!.max >= (minimum[i] ?? -Infinity))\n      })\n      if (result.length !== wrap.arts.values[slot].length)\n        progress = true\n      return result\n    })\n    if (!progress) break\n    wrap.arts = { base: wrap.arts.base, values }\n  }\n  return wrap.arts\n}\nfunction pruneNodeRange(nodes: OptNode[], arts: ArtifactsBySlot): OptNode[] {\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\n  const reads = addArtRange([baseRange, ...Object.values(arts.values).map(values => computeArtRange(values))])\n  const nodeRange = computeNodeRange(nodes, reads)\n\n  return mapFormulas(nodes, f => {\n    {\n      const { min, max } = nodeRange.get(f)!\n      if (min === max) return constant(min)\n    }\n    const { operation } = f\n    const operandRanges = f.operands.map(x => nodeRange.get(x)!)\n    switch (operation) {\n      case \"threshold\": {\n        const [value, threshold, pass, fail] = operandRanges\n        if (value.min >= threshold.max) return f.operands[2]\n        else if (value.max < threshold.min) return f.operands[3]\n        if (pass.max === pass.min &&\n          fail.max === fail.min &&\n          pass.min === fail.min && isFinite(pass.min))\n          return constant(pass.max)\n        break\n      }\n      case \"min\": {\n        const newOperands = f.operands.filter((_, i) => {\n          const op1 = operandRanges[i]\n          return operandRanges.every((op2, j) => op1.min <= op2.max)\n        })\n        if (newOperands.length < operandRanges.length) return min(...newOperands)\n        break\n      }\n      case \"max\": {\n        const newOperands = f.operands.filter((_, i) => {\n          const op1 = operandRanges[i]\n          return operandRanges.every(op2 => op1.max >= op2.min)\n        })\n        if (newOperands.length < operandRanges.length) return max(...newOperands)\n        break\n      }\n    }\n    return f\n  }, f => f)\n}\nfunction addArtRange(ranges: DynMinMax[]): DynMinMax {\n  const result: DynMinMax = {}\n  ranges.forEach(range => {\n    Object.entries(range).forEach(([key, value]) => {\n      if (result[key]) {\n        result[key].min += value.min\n        result[key].max += value.max\n      } else result[key] = { ...value }\n    })\n  })\n  return result\n}\nfunction computeArtRange(arts: ArtifactBuildData[]): DynMinMax {\n  const result: DynMinMax = {}\n  if (arts.length) {\n    Object.keys(arts[0].values)\n      .filter(key => arts.every(art => art.values[key]))\n      .forEach(key => result[key] = { min: arts[0].values[key], max: arts[0].values[key] })\n    arts.forEach(({ values }) => {\n      for (const [key, value] of Object.entries(values)) {\n        if (!result[key]) result[key] = { min: 0, max: value }\n        else {\n          if (result[key].max < value) result[key].max = value\n          if (result[key].min > value) result[key].min = value\n        }\n      }\n    })\n  }\n  return result\n}\nexport function computeFullArtRange(arts: ArtifactsBySlot): DynMinMax {\n  const baseRange = Object.fromEntries(Object.entries(arts.base).map(([key, x]) => [key, { min: x, max: x }]))\n  return addArtRange([baseRange, ...Object.values(arts.values).map(values => computeArtRange(values))])\n}\nexport function computeNodeRange(nodes: OptNode[], reads: DynMinMax): Map<OptNode, MinMax> {\n  const range = new Map<OptNode, MinMax>()\n\n  forEachNodes(nodes, _ => { }, f => {\n    const { operation } = f\n    const operands = f.operands.map(op => range.get(op)!)\n    let current: MinMax\n    switch (operation) {\n      case \"read\":\n        if (f.path[0] !== \"dyn\")\n          throw new Error(`Found non-dyn path ${f.path} while computing range`)\n        current = reads[f.path[1]] ?? { min: 0, max: 0 }\n        break\n      case \"const\": current = computeMinMax([f.value]); break\n      case \"add\": case \"min\": case \"max\":\n        current = {\n          min: allOperations[operation](operands.map(x => x.min)),\n          max: allOperations[operation](operands.map(x => x.max)),\n        }; break\n      case \"res\": current = {\n        min: allOperations[operation]([operands[0].max]),\n        max: allOperations[operation]([operands[0].min]),\n      }; break\n      case \"mul\": current = operands.reduce((accu, current) => computeMinMax([\n        accu.min * current.min, accu.min * current.max,\n        accu.max * current.min, accu.max * current.max,\n      ])); break\n      case \"threshold\":\n        if (operands[0].min >= operands[1].max) current = operands[2]\n        else if (operands[0].max < operands[1].min) current = operands[3]\n        else current = computeMinMax([], [operands[2], operands[3]])\n        break\n      case \"sum_frac\": {\n        const [x, c] = operands, sum = { min: x.min + c.min, max: x.max + c.max }\n        if (sum.min <= 0 && sum.max >= 0)\n          current = (x.min <= 0 && x.max >= 0) ? { min: NaN, max: NaN } : { min: -Infinity, max: Infinity }\n        else\n          // TODO: Check this\n          current = computeMinMax([\n            x.min / sum.min, x.min / sum.max,\n            x.max / sum.min, x.max / sum.max\n          ])\n        break\n      }\n      default: assertUnreachable(operation)\n    }\n    range.set(f, current)\n  })\n  return range\n}\nfunction computeMinMax(values: readonly number[], minMaxes: readonly MinMax[] = []): MinMax {\n  const max = Math.max(...values, ...minMaxes.map(x => x.max))\n  const min = Math.min(...values, ...minMaxes.map(x => x.min))\n  return { min, max }\n}\n\nexport function filterArts(arts: ArtifactsBySlot, filters: RequestFilter): ArtifactsBySlot {\n  return {\n    base: arts.base,\n    values: objectKeyMap(allSlotKeys, slot => {\n      const filter = filters[slot]\n      switch (filter.kind) {\n        case \"id\": return arts.values[slot].filter(art => filter.ids.has(art.id))\n        case \"exclude\": return arts.values[slot].filter(art => !filter.sets.has(art.set!))\n        case \"required\": return arts.values[slot].filter(art => filter.sets.has(art.set!))\n      }\n    })\n  }\n}\n\nexport function mergeBuilds(builds: Build[][], maxNum: number): Build[] {\n  return builds.flatMap(x => x).sort((a, b) => b.value - a.value).slice(0, maxNum)\n}\nexport function mergePlot(plots: PlotData[]): PlotData {\n  let scale = 0.01, reductionScaling = 2, maxCount = 1500\n  let keys = new Set(plots.flatMap(x => Object.values(x).map(v => Math.round(v.plot! / scale))))\n  while (keys.size > maxCount) {\n    scale *= reductionScaling\n    keys = new Set([...keys].map(key => Math.round(key / reductionScaling)))\n  }\n  const result: PlotData = {}\n  for (const plot of plots)\n    for (const build of Object.values(plot)) {\n      const x = Math.round(build.plot! / scale) * scale\n      if (!result[x] || result[x]!.value < build.value)\n        result[x] = build\n    }\n  return result\n}\n\nexport function countBuilds(arts: ArtifactsBySlot): number {\n  return allSlotKeys.reduce((_count, slot) => _count * arts.values[slot].length, 1)\n}\n\n\nexport function* filterFeasiblePerm(filters: Iterable<RequestFilter>, _artSets: ArtifactsBySlot): Iterable<RequestFilter> {\n  const artSets = objectMap(_artSets.values, values => new Set(values.map(v => v.set)))\n  filter_loop: for (const filter of filters) {\n    for (const [slot, f] of Object.entries(filter)) {\n      const available = artSets[slot]!\n      switch (f.kind) {\n        case \"required\": if ([...f.sets].every(s => !available.has(s))) continue filter_loop; break\n        case \"exclude\": if ([...available].every(s => f.sets.has(s!))) continue filter_loop; break\n        case \"id\": break\n      }\n    }\n    yield filter\n  }\n}\nexport function exclusionToAllowed(exclusion: number[] | undefined): Set<number> {\n  return new Set(exclusion?.includes(2)\n    ? exclusion.includes(4) ? [0, 1] : [0, 1, 4, 5]\n    : exclusion?.includes(4) ? [0, 1, 2, 3] : [0, 1, 2, 3, 4, 5])\n}\n/** A *disjoint* set of `RequestFilter` satisfying the exclusion rules */\nexport function* artSetPerm(exclusion: ArtSetExclusion, _artSets: ArtifactSetKey[]): Iterable<RequestFilter> {\n  /**\n   * This generation algorithm is separated into two parts:\n   * - \"Shape\" generation\n   *   - It first generates all build \"shapes\", e.g., AABBC, ABBCD\n   *   - It then filters the generated shapes according to the rainbow exclusion, e.g., removes ABBCD if excluding 3 rainbows\n   *   - It then merges the remaining shapes into wildcards, e.g. AABAA + AABAB + AABAC => AABA*\n   * - Shape filling\n   *   - From the given shapes, it tries to fill in all non-rainbow slots, e.g., slots A and B of AABBC, with actual artifacts\n   *   - It then fills the rainbow slots, e.g., slot C of AABBC while ensuring the exclusion rule of each sets\n   */\n  const artSets = [...new Set(_artSets)], allowedRainbows = exclusionToAllowed(exclusion.rainbow)\n  let shapes: number[][] = []\n  function populateShapes(current: number[], list: Set<number>, rainbows: number[]) {\n    if (current.length === 5) {\n      if (allowedRainbows.has(rainbows.length))\n        shapes.push(current)\n      return\n    }\n    for (const i of list) populateShapes([...current, i], list, rainbows.filter(j => j !== i))\n    populateShapes([...current, current.length], new Set([...list, current.length]), [...rainbows, current.length])\n  }\n  populateShapes([0], new Set([0]), [0])\n  function indexOfShape(shape: number[], replacing: number) {\n    if (range(replacing + 1, 4).some(i => shape[i] !== 5))\n      return undefined\n    shape = [...shape]\n    shape[replacing] = 5\n    return shape.reduce((a, b) => a * 6 + b, 0)\n  }\n  for (let replacing = 4; replacing >= 0; replacing--) {\n    const required: Map<number, number> = new Map()\n    for (const shape of shapes) {\n      const id = indexOfShape(shape, replacing)\n      if (id === undefined) continue\n      required.set(id, (required.get(id) ?? new Set(shape.slice(0, replacing)).size + 1) - 1)\n    }\n    for (const [id, remaining] of required.entries()) {\n      if (remaining === 0) {\n        const shape = [...shapes.find(shape => indexOfShape(shape, replacing) === id)!]\n        shape[replacing] = 5\n        shapes = shapes.filter(shape => indexOfShape(shape, replacing) !== id)\n        shapes.push(shape)\n      }\n    }\n  }\n\n  // Shapes are now calculated and merged, proceed to fill in the sets\n\n  const noFilter = { kind: \"exclude\" as const, sets: new Set<ArtifactSetKey>() }\n  const result: RequestFilter = objectKeyMap(allSlotKeys, _ => noFilter)\n\n  const counts = { ...objectMap(exclusion, _ => 0), ...objectKeyMap(artSets, _ => 0) }\n  const allowedCounts = objectMap(exclusion, exclusionToAllowed)\n\n  function* check(shape: number[]) {\n    const used: Set<ArtifactSetKey> = new Set()\n    let groupped: number[][] = [], rainbows: number[] = []\n    for (const i of shape) {\n      groupped.push([])\n      if (i === 5) rainbows.push(groupped.length - 1)\n      else groupped[i].push(groupped.length - 1)\n    }\n    groupped = groupped.filter(v => v.length).sort((a, b) => b.length - a.length)\n    let usableRainbows = rainbows.length\n\n    // Inception.. because js doesn't like functions inside a for-loop\n    function* check(i: number) {\n      if (i === groupped.length)\n        return yield* check_free(0)\n\n      for (const set of artSets) {\n        if (used.has(set)) continue\n        const length = groupped[i].length, allowedSet = allowedCounts[set]\n        let requiredRainbows = 0\n\n        if (allowedSet && !allowedSet.has(length)) {\n          // Look ahead and see if we have enough rainbows to fill to the next `allowedSet` if we use the current set\n          requiredRainbows = (range(length + 1, 5).find(l => allowedSet.has(l)) ?? 6) - length\n          if (requiredRainbows > usableRainbows) continue // Not enough rainbows. Next..\n        }\n\n        used.add(set)\n        counts[set] = groupped[i].length\n        groupped[i].forEach(j => result[allSlotKeys[j]] = { kind: \"required\", sets: new Set([set]) })\n        usableRainbows -= requiredRainbows\n\n        yield* check(i + 1)\n\n        usableRainbows += requiredRainbows\n        counts[set] = 0\n        used.delete(set)\n      }\n    }\n    // We separate filling rainbow slots from groupped slots because it has an entirely\n    // different set of rules regarding what can be filled and what states to be kept.\n    function* check_free(i: number) {\n      const remaining = rainbows.length - i, isolated: ArtifactSetKey[] = [], missing: ArtifactSetKey[] = [], rejected: ArtifactSetKey[] = []\n      let required = 0\n      for (const set of artSets) {\n        const allowedSet = allowedCounts[set], count = counts[set]\n        if (!allowedSet) continue\n        if (range(1, remaining).every(j => !allowedSet.has(count + j))) rejected.push(set)\n        else if (!allowedSet.has(count)) {\n          required += [...allowedSet].find(x => x > count)! - count\n          missing.push(set)\n        }\n        else if (range(0, remaining).some(j => !allowedSet.has(count + j))) isolated.push(set)\n      }\n      if (required > remaining) return\n      if (i === rainbows.length) {\n        yield { ...result }\n        return\n      }\n      if (required === remaining) {\n        for (const set of missing) {\n          counts[set]++\n          result[allSlotKeys[rainbows[i]]] = { kind: \"required\", sets: new Set([set]) }\n          yield* check_free(i + 1)\n          counts[set]--\n        }\n        return\n      }\n      for (const set of [...isolated, ...missing]) {\n        counts[set]++\n        result[allSlotKeys[rainbows[i]]] = { kind: \"required\", sets: new Set([set]) }\n        yield* check_free(i + 1)\n        counts[set]--\n      }\n      result[allSlotKeys[rainbows[i]]] = { kind: \"exclude\", sets: new Set([...missing, ...rejected, ...isolated]) }\n      yield* check_free(i + 1)\n    }\n    yield* check(0)\n  }\n  for (const shape of shapes) yield* check(shape)\n}\n\nexport type RequestFilter = StrictDict<SlotKey,\n  { kind: \"required\", sets: Set<ArtifactSetKey> } |\n  { kind: \"exclude\", sets: Set<ArtifactSetKey> } |\n  { kind: \"id\", ids: Set<string> }\n>\n\nexport type DynStat = { [key in string]: number }\nexport type ArtifactBuildData = {\n  id: string\n  set?: ArtifactSetKey\n  values: DynStat\n}\nexport type ArtifactsBySlot = { base: DynStat, values: StrictDict<SlotKey, ArtifactBuildData[]> }\n\nexport type PlotData = Dict<number, Build>\nexport interface Build {\n  value: number\n  plot?: number\n  artifactIds: string[]\n}\n\nexport type DynMinMax = { [key in string]: MinMax }\nexport type MinMax = { min: number, max: number }\n","import { Box } from \"@mui/material\"\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\"\nimport usePromise from \"../../ReactHooks/usePromise\"\nimport { ArtifactSetKey, SetNum } from \"../../Types/consts\"\nimport DocumentDisplay from \"../DocumentDisplay\"\n\ntype Data = {\n  setKey: ArtifactSetKey,\n  setNumKey: SetNum,\n  hideHeader?: boolean,\n  conditionalsOnly?: boolean\n}\n\nexport default function SetEffectDisplay({ setKey, setNumKey, hideHeader = false, conditionalsOnly = false }: Data) {\n  const sheet = usePromise(() => ArtifactSheet.get(setKey), [setKey])\n  if (!sheet) return null\n\n  const document = conditionalsOnly ? sheet.setEffectDocument(setNumKey)?.filter(section => \"states\" in section) : sheet.setEffectDocument(setNumKey)\n  return <Box display=\"flex\" flexDirection=\"column\">\n    {document ? <DocumentDisplay sections={document} hideHeader={hideHeader} /> : null}\n  </Box>\n}\n","import { useCallback, useContext, useEffect, useState } from \"react\";\nimport { DatabaseContext } from \"../../../../Database/Database\";\nimport { BuildSetting, BuildSettingReducerAction } from \"../../../../Database/DataManagers/BuildSettingData\";\nimport { CharacterKey } from \"../../../../Types/consts\";\n\nexport default function useBuildSetting(characterKey: CharacterKey) {\n  const { database } = useContext(DatabaseContext)\n  const [buildSetting, setBuildSetting] = useState(() => database.buildSettings.get(characterKey))\n  useEffect(() => setBuildSetting(database.buildSettings.get(characterKey)), [database, characterKey])\n  useEffect(() =>\n    database.buildSettings.follow(characterKey, (k, r, v) => r === \"update\" && setBuildSetting(v)),\n    [characterKey, setBuildSetting, database])\n  const buildSettingDispatch = useCallback((action: BuildSettingReducerAction) => characterKey && database.buildSettings.set(characterKey, action), [characterKey, database],)\n\n  return { buildSetting: buildSetting as BuildSetting, buildSettingDispatch }\n}\n","import { faBan, faChartLine } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { CheckBox, CheckBoxOutlineBlank, Replay, Settings } from '@mui/icons-material';\nimport { Box, Button, ButtonGroup, CardContent, Divider, Grid, Stack, Typography } from '@mui/material';\nimport { useCallback, useContext, useEffect, useMemo, useState } from 'react';\nimport { Trans, useTranslation } from 'react-i18next';\nimport SetEffectDisplay from '../../../../../Components/Artifact/SetEffectDisplay';\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\nimport CardDark from '../../../../../Components/Card/CardDark';\nimport CardLight from '../../../../../Components/Card/CardLight';\nimport CloseButton from '../../../../../Components/CloseButton';\nimport ColorText from '../../../../../Components/ColoredText';\nimport InfoTooltip from '../../../../../Components/InfoTooltip';\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\nimport SqBadge from '../../../../../Components/SqBadge';\nimport { StarsDisplay } from '../../../../../Components/StarDisplay';\nimport { Translate } from '../../../../../Components/Translate';\nimport { CharacterContext } from '../../../../../Context/CharacterContext';\nimport { DataContext, dataContextObj } from '../../../../../Context/DataContext';\nimport { ArtifactSheet } from '../../../../../Data/Artifacts/ArtifactSheet';\nimport { DatabaseContext } from '../../../../../Database/Database';\nimport { UIData } from '../../../../../Formula/uiData';\nimport { constant } from '../../../../../Formula/utils';\nimport useForceUpdate from '../../../../../ReactHooks/useForceUpdate';\nimport usePromise from '../../../../../ReactHooks/usePromise';\nimport { allArtifactSets, allSlotKeys, ArtifactSetKey, SetNum, SlotKey } from '../../../../../Types/consts';\nimport { deepClone, objectKeyMap } from '../../../../../Util/Util';\nimport useBuildSetting from '../useBuildSetting';\n\nexport default function ArtifactSetConfig({ disabled }: { disabled?: boolean, }) {\n  const { t } = useTranslation([\"page_character_optimize\", \"sheet\"])\n  const dataContext = useContext(DataContext)\n  const { database } = useContext(DatabaseContext)\n  const { character: { key: characterKey, conditional }, characterDispatch } = useContext(CharacterContext)\n  const { buildSetting: { artSetExclusion }, buildSettingDispatch } = useBuildSetting(characterKey)\n  const [open, setOpen] = useState(false)\n  const onOpen = useCallback(() => setOpen(true), [setOpen])\n  const onClose = useCallback(() => setOpen(false), [setOpen])\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\n\n  const [dbDirty, forceUpdate] = useForceUpdate()\n  useEffect(() => database.arts.followAny(forceUpdate), [database, forceUpdate])\n\n  const artKeysByRarity = useMemo(() => artifactSheets\n    ? Object.entries(ArtifactSheet.setKeysByRarities(artifactSheets))\n      .reverse().flatMap(([, sets]) => sets)\n      .filter(key => !key.includes(\"Prayers\"))\n    : [], [artifactSheets])\n  const { artKeys, artSlotCount } = useMemo(() => {\n    const artSlotCount = objectKeyMap(artKeysByRarity, _ => objectKeyMap(allSlotKeys, _ => 0))\n    database.arts.values.forEach(art => artSlotCount[art.setKey] && artSlotCount[art.setKey]![art.slotKey]++)\n    const artKeys = [...artKeysByRarity].sort((a, b) =>\n      +(getNumSlots(artSlotCount[a]) < 2) - +(getNumSlots(artSlotCount[b]) < 2))\n    return dbDirty && { artKeys, artSlotCount }\n  }, [dbDirty, database, artKeysByRarity])\n\n  const allowRainbow2 = !artSetExclusion.rainbow?.includes(2)\n  const allowRainbow4 = !artSetExclusion.rainbow?.includes(4)\n\n  const { allow2, allow4 } = useMemo(() => ({\n    allow2: artKeysByRarity.filter(k => !artSetExclusion[k]?.includes(2)).length,\n    allow4: artKeysByRarity.filter(k => !artSetExclusion[k]?.includes(4)).length,\n  }), [artKeysByRarity, artSetExclusion])\n  const exclude2 = artKeysByRarity.length - allow2, exclude4 = artKeysByRarity.length - allow4\n  const artifactCondCount = useMemo(() =>\n    (Object.keys(conditional)).filter(k =>\n      allArtifactSets.includes(k as ArtifactSetKey) && Object.keys(conditional[k]).length !== 0).length\n    , [conditional])\n  const fakeDataContextObj = useMemo(() => ({\n    ...dataContext,\n    data: new UIData({ ...dataContext.data.data[0], artSet: objectKeyMap(allArtifactSets, _ => constant(4)) }, undefined)\n  }), [dataContext])\n  const resetArtConds = useCallback(() => {\n    const tconditional = Object.fromEntries(Object.entries(conditional).filter(([k, v]) => !allArtifactSets.includes(k as any)))\n    characterDispatch({ conditional: tconditional })\n  }, [conditional, characterDispatch]);\n  const setAllExclusion = useCallback(\n    (setnum: number, exclude = true) => {\n      const artSetExclusion_ = deepClone(artSetExclusion)\n      artKeysByRarity.forEach(k => {\n        if (exclude) artSetExclusion_[k] = [...(artSetExclusion_[k] ?? []), setnum];\n        else if (artSetExclusion_[k]) artSetExclusion_[k] = artSetExclusion_[k].filter(n => n !== setnum);\n      })\n      buildSettingDispatch({ artSetExclusion: artSetExclusion_ })\n    },\n    [artKeysByRarity, artSetExclusion, buildSettingDispatch],\n  )\n\n  return <>\n    <CardLight sx={{ display: \"flex\" }}>\n      <CardContent sx={{ flexGrow: 1 }} >\n        <Typography>\n          <strong>{t`artSetConfig.title`}</strong>\n        </Typography>\n        <Stack spacing={1}>\n          <Typography>{t`artSetConfig.setEffCond`} <SqBadge color={artifactCondCount ? \"success\" : \"secondary\"}>{artifactCondCount} {t<string>(\"artSetConfig.enabled\")}</SqBadge></Typography>\n          <Typography>{t`sheet:2set`} <SqBadge color=\"success\">{allow2} <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /> {t<string>(\"artSetConfig.allowed\")}</SqBadge>{!!exclude2 && \" / \"}{!!exclude2 && <SqBadge color=\"secondary\">{exclude2} <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> {t<string>(\"artSetConfig.excluded\")}</SqBadge>}</Typography>\n          <Typography>{t`sheet:4set`} <SqBadge color=\"success\">{allow4} <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /> {t<string>(\"artSetConfig.allowed\")}</SqBadge>{!!exclude4 && \" / \"}{!!exclude4 && <SqBadge color=\"secondary\">{exclude4} <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> {t<string>(\"artSetConfig.excluded\")}</SqBadge>}</Typography>\n          <Typography>{t`artSetConfig.2rainbow`} <SqBadge color={allowRainbow2 ? \"success\" : \"secondary\"}><FontAwesomeIcon icon={allowRainbow2 ? faChartLine : faBan} className=\"fa-fw\" /> {allowRainbow2 ? t<string>(\"artSetConfig.allowed\") : \"Excluded\"}</SqBadge></Typography>\n          <Typography>{t`artSetConfig.4rainbow`} <SqBadge color={allowRainbow4 ? \"success\" : \"secondary\"}><FontAwesomeIcon icon={allowRainbow4 ? faChartLine : faBan} className=\"fa-fw\" /> {allowRainbow4 ? t<string>(\"artSetConfig.allowed\") : \"Excluded\"}</SqBadge></Typography>\n        </Stack>\n\n      </CardContent>\n      <Button onClick={onOpen} disabled={disabled} color=\"info\" sx={{ borderRadius: 0 }}>\n        <Settings />\n      </Button>\n    </CardLight>\n    {artifactSheets && <ModalWrapper open={open} onClose={onClose} ><CardDark>\n      <CardContent sx={{ display: \"flex\", gap: 1, justifyContent: \"space-between\" }}>\n        <Typography variant=\"h6\" >{t`artSetConfig.title`}</Typography>\n        <CloseButton onClick={onClose} />\n      </CardContent>\n      <Divider />\n      <CardContent >\n        <CardLight sx={{ mb: 1 }}><CardContent>\n          <Box display=\"flex\" gap={1}>\n            <Typography><strong>{t`artSetConfig.modal.setCond.title`}</strong></Typography>\n            <Typography sx={{ flexGrow: 1 }}><SqBadge color={artifactCondCount ? \"success\" : \"secondary\"}>{artifactCondCount} {t<string>(\"artSetConfig.selected\")}</SqBadge></Typography>\n            <Button size='small' onClick={resetArtConds} color=\"error\" startIcon={<Replay />}>{t`artSetConfig.modal.setCond.reset`}</Button>\n          </Box>\n          <Typography>{t`artSetConfig.modal.setCond.text`}</Typography>\n        </CardContent></CardLight>\n        <CardLight sx={{ mb: 1 }}><CardContent>\n          <Typography sx={{ flexGrow: 1 }}><strong>\n            <Trans t={t} i18nKey=\"artSetConfig.modal.ArtSetFilter.title\" >Artifact Sets <ColorText color='success'>Allowed<FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /></ColorText> / <ColorText color='secondary' variant='light'>Excluded<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /></ColorText></Trans>\n          </strong></Typography>\n          <Typography><Trans t={t} i18nKey=\"artSetConfig.modal.ArtSetFilter.intro\">You can allow/exclude which sets you want the builder to consider. In the following examples, <strong>A</strong> is on-set, and <strong>R</strong> is rainbow(off-set)</Trans></Typography>\n          <Typography><Trans t={t} i18nKey=\"artSetConfig.modal.ArtSetFilter.2set\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 2-Set</ColorText></strong> would exclude 2-Set builds: <strong><ColorText color='secondary' variant='light'>AA</ColorText>RRR</strong> and <strong><ColorText color='secondary' variant='light'>AAA</ColorText>RR</strong>.</Trans></Typography>\n          <Typography><Trans t={t} i18nKey=\"artSetConfig.modal.ArtSetFilter.4set\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 4-Set</ColorText></strong> would exclude 4-Set builds: <strong><ColorText color='secondary' variant='light'>AAAA</ColorText>R</strong> and <strong><ColorText color='secondary' variant='light'>AAAAA</ColorText></strong>.</Trans></Typography>\n          <Typography><Trans t={t} i18nKey=\"artSetConfig.modal.ArtSetFilter.2rain\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 3-Rainbow</ColorText></strong> would exclude 2-Set + 3-Rainbow builds: <strong>AA<ColorText color='secondary' variant='light'>RRR</ColorText></strong> and <strong>AAA<ColorText color='secondary' variant='light'>RR</ColorText></strong>.</Trans></Typography>\n          <Typography><Trans t={t} i18nKey=\"artSetConfig.modal.ArtSetFilter.4rain\"><strong><ColorText color='secondary' variant='light'>Excluding<FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> 5-Rainbow</ColorText></strong> would exclude full 5-Rainbow builds: <strong><ColorText color='secondary' variant='light'>RRRRR</ColorText></strong>.</Trans></Typography>\n        </CardContent></CardLight>\n        <Grid container columns={{ xs: 2, lg: 3 }} sx={{ mb: 1 }} spacing={1}>\n          <Grid item xs={1}>\n            <AllSetAllowExcludeCard setNum={2} numAllow={allow2} numExclude={exclude2} setAllExclusion={setAllExclusion} />\n          </Grid>\n          <Grid item xs={1}>\n            <AllSetAllowExcludeCard setNum={4} numAllow={allow4} numExclude={exclude4} setAllExclusion={setAllExclusion} />\n          </Grid>\n          <Grid item xs={1}>\n            <CardLight>\n              <CardContent>\n                <Typography gutterBottom><strong><Trans t={t} i18nKey=\"artSetConfig.alExRainbow\"><ColorText color='success'>Allow <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /></ColorText> / <ColorText color='secondary' variant='light'>Exclude <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /></ColorText> Rainbow Builds</Trans></strong></Typography>\n                <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\n                  <Button fullWidth onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey: \"rainbow\", num: 2 })} color={allowRainbow2 ? \"success\" : \"secondary\"} startIcon={!allowRainbow2 ? <CheckBoxOutlineBlank /> : <CheckBox />} endIcon={<FontAwesomeIcon icon={allowRainbow2 ? faChartLine : faBan} className=\"fa-fw\" />}>{t`artSetConfig.2rainbow`}</Button>\n                  <Button fullWidth onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey: \"rainbow\", num: 4 })} color={allowRainbow4 ? \"success\" : \"secondary\"} startIcon={!allowRainbow4 ? <CheckBoxOutlineBlank /> : <CheckBox />} endIcon={<FontAwesomeIcon icon={allowRainbow4 ? faChartLine : faBan} className=\"fa-fw\" />}>{t`artSetConfig.4rainbow`}</Button>\n                </Box>\n              </CardContent>\n            </CardLight>\n          </Grid>\n        </Grid>\n        <Grid container spacing={1} columns={{ xs: 2, lg: 3 }}>\n          {artKeys.map(setKey => {\n            return <ArtifactSetCard key={setKey} setKey={setKey} sheet={artifactSheets(setKey)} fakeDataContextObj={fakeDataContextObj} slotCount={artSlotCount[setKey]!} />\n          })}\n        </Grid>\n      </CardContent>\n      <Divider />\n      <CardContent sx={{ py: 1 }}>\n        <CloseButton large onClick={onClose} />\n      </CardContent>\n    </CardDark></ModalWrapper >}\n  </>\n}\nfunction AllSetAllowExcludeCard({ numAllow, numExclude, setNum, setAllExclusion }: { numAllow: number, numExclude: number, setNum: 2 | 4, setAllExclusion: (setNum: 2 | 4, exclude?: boolean) => void }) {\n  const { t } = useTranslation([\"page_character_optimize\", \"sheet\"])\n  return <CardLight>\n    <CardContent>\n      <Typography gutterBottom><strong>{t(`sheet:${setNum}set`)}</strong> <SqBadge color=\"success\">{numAllow} <FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" /> {t<string>(\"artSetConfig.allowed\")}</SqBadge>{!!numExclude && \" / \"}{!!numExclude && <SqBadge color=\"secondary\">{numExclude} <FontAwesomeIcon icon={faBan} className=\"fa-fw\" /> {t<string>(\"artSetConfig.excluded\")}</SqBadge>}</Typography>\n      <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\n        <Button fullWidth disabled={!numExclude} onClick={() => setAllExclusion(setNum, false)} color='success' startIcon={<FontAwesomeIcon icon={faChartLine} className=\"fa-fw\" />}>{t(`artSetConfig.allowAll${setNum}set`)}</Button>\n        <Button fullWidth disabled={!numAllow} onClick={() => setAllExclusion(setNum, true)} color='secondary' startIcon={<FontAwesomeIcon icon={faBan} className=\"fa-fw\" />}>{t(`artSetConfig.excludeAll${setNum}set`)}</Button>\n      </Box>\n    </CardContent>\n  </CardLight>\n}\nfunction ArtifactSetCard({ sheet, setKey, fakeDataContextObj, slotCount }: { setKey: ArtifactSetKey, sheet: ArtifactSheet, fakeDataContextObj: dataContextObj, slotCount: Record<SlotKey, number> }) {\n  const { t } = useTranslation(\"sheet\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { buildSetting, buildSettingDispatch } = useBuildSetting(characterKey)\n  const setExclusionSet = buildSetting?.artSetExclusion?.[setKey] ?? []\n  const allow4 = !setExclusionSet.includes(4)\n  const slots = useMemo(() => getNumSlots(slotCount), [slotCount])\n\n  /* Assumes that all conditionals are from 4-Set. needs to change if there are 2-Set conditionals */\n  const set4CondNums = useMemo(() => {\n    if (!allow4 || slots < 4) return []\n    return Object.keys(sheet.setEffects).filter(setNumKey => sheet.setEffects[setNumKey]?.document.some(doc => \"states\" in doc))\n  }, [sheet.setEffects, allow4, slots])\n  const exclude2 = setExclusionSet.includes(2)\n  const exclude4 = setExclusionSet.includes(4)\n  return <Grid item key={setKey} xs={1}>\n    <CardLight sx={{ height: \"100%\", opacity: slots < 2 ? \"50%\" : undefined }}>\n      <Box className={`grad-${sheet.rarity[0]}star`} width=\"100%\" sx={{ display: \"flex\" }} >\n        <Box component=\"img\" src={sheet.defIconSrc} sx={{ height: 100, width: \"auto\", mx: -1 }} />\n        <Box sx={{ flexGrow: 1, px: 1, display: \"flex\", flexDirection: \"column\", justifyContent: \"center\" }}>\n          <Typography variant=\"h6\">{sheet.name ?? \"\"}</Typography>\n          <Box display=\"flex\" gap={1}>\n            <Typography variant=\"subtitle1\">{sheet.rarity.map((ns, i) => <span key={ns}>{ns} <StarsDisplay stars={1} /> {i < (sheet.rarity.length - 1) ? \"/ \" : null}</span>)}</Typography>\n            {/* If there is ever a 2-Set conditional, we will need to change this */}\n            <InfoTooltip title={<Box>\n              <Typography><SqBadge color=\"success\">{t`2set`}</SqBadge></Typography>\n              <Typography><Translate ns={`artifact_${setKey}_gen`} key18={\"setEffects.2\"} /></Typography>\n              <Box paddingTop={2} sx={{ opacity: setExclusionSet.includes(4) ? 0.6 : 1 }} >\n                <Typography><SqBadge color=\"success\">{t`4set`}</SqBadge></Typography>\n                <Typography><Translate ns={`artifact_${setKey}_gen`} key18={\"setEffects.4\"} /></Typography>\n              </Box>\n            </Box>} />\n          </Box>\n          <Box sx={{ display: \"flex\", gap: 1 }}>{Object.entries(slotCount).map(([slotKey, count]) => <Typography key={slotKey} sx={{ flexGrow: 1 }} variant=\"subtitle2\" ><SqBadge sx={{ width: \"100%\" }} color={count ? \"primary\" : \"secondary\"}>{artifactSlotIcon(slotKey)}{count}</SqBadge></Typography>)}</Box>\n        </Box>\n      </Box>\n      <ButtonGroup sx={{ \".MuiButton-root\": { borderRadius: 0 } }} fullWidth>\n        {slots >= 2 && <Button startIcon={exclude2 ? <CheckBoxOutlineBlank /> : <CheckBox />} onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey, num: 2 })} color={exclude2 ? 'secondary' : 'success'} endIcon={<FontAwesomeIcon icon={exclude2 ? faBan : faChartLine} className=\"fa-fw\" />}>{t`2set`}</Button>}\n        {slots >= 4 && <Button startIcon={exclude4 ? <CheckBoxOutlineBlank /> : <CheckBox />} onClick={() => buildSettingDispatch({ type: \"artSetExclusion\", setKey, num: 4 })} color={exclude4 ? 'secondary' : 'success'} endIcon={<FontAwesomeIcon icon={exclude4 ? faBan : faChartLine} className=\"fa-fw\" />}>{t`4set`}</Button>}\n      </ButtonGroup>\n\n      {!!set4CondNums.length && <DataContext.Provider value={fakeDataContextObj}>\n        <CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\n          {set4CondNums.map(setNumKey =>\n            <SetEffectDisplay key={setNumKey} setKey={setKey} setNumKey={parseInt(setNumKey) as SetNum} hideHeader conditionalsOnly />\n          )}\n        </CardContent>\n      </DataContext.Provider>}\n    </CardLight>\n  </Grid >\n}\n\nfunction getNumSlots(slotCount: Record<string, number>): number {\n  return Object.values(slotCount).reduce((tot, v) => tot + (v ? 1 : 0), 0)\n}\n","import { MenuItem } from \"@mui/material\"\nimport { useTranslation } from \"react-i18next\"\nimport DropdownButton from \"../../../../../Components/DropdownMenu/DropdownButton\"\n\nconst levels = [0, 4, 8, 12, 16, 20] as const\nexport default function AssumeFullLevelToggle({ mainStatAssumptionLevel = 0, setmainStatAssumptionLevel, disabled }) {\n  const { t } = useTranslation(\"page_character_optimize\")\n  return <DropdownButton fullWidth color={mainStatAssumptionLevel ? \"success\" : \"primary\"} disabled={disabled}\n    title={mainStatAssumptionLevel ? t(\"mainStat.assumptionLvl.lvl\", { lvl: mainStatAssumptionLevel }) : t(\"mainStat.assumptionLvl.no\")}>\n    {levels.map((lvl) => <MenuItem key={lvl} onClick={() => setmainStatAssumptionLevel(lvl)}>{lvl ? t(\"mainStat.assumptionLvl.lvl\", { lvl }) : t(\"mainStat.assumptionLvl.no\")}</MenuItem>)}\n  </DropdownButton>\n}\n","import { CardContent, Divider, Typography } from '@mui/material';\nimport { useContext } from 'react';\nimport { CharacterContext } from '../../../../../Context/CharacterContext';\nimport CardLight from '../../../../../Components/Card/CardLight';\nimport { NodeFieldDisplay } from '../../../../../Components/FieldDisplay';\nimport { DataContext } from '../../../../../Context/DataContext';\nimport { uiInput as input } from '../../../../../Formula';\nimport { NumNode } from '../../../../../Formula/type';\nimport { FormulaDataContext } from '../../../../../Context/FormulaDataContext';\nexport default function BonusStatsCard() {\n  const { character: { bonusStats } } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const { setFormulaData } = useContext(FormulaDataContext)\n  const bonusStatsKeys = Object.keys(bonusStats)\n  if (!bonusStatsKeys.length) return null\n  const nodes = bonusStatsKeys.map(k => data.get(input.customBonus[k] as NumNode))\n  return <CardLight>\n    <CardContent>\n      <Typography>Bonus Stats</Typography>\n    </CardContent>\n    <Divider />\n    <CardContent>\n      {nodes.map(n => <NodeFieldDisplay key={JSON.stringify(n.info)} node={n} data={data} setFormulaData={setFormulaData} />)}\n    </CardContent>\n  </CardLight>\n}\n","import { Alert, Grid, LinearProgress, styled, Typography } from '@mui/material';\nimport { ReactNode } from 'react';\nimport { timeStringMs } from '../../../../../Util/TimeUtil';\n\nexport const warningBuildNumber = 10000000\nexport type BuildStatus = {\n  type: \"active\" | \"inactive\"\n  tested: number      // tested, including `failed`\n  failed: number      // tested but fail the filter criteria, e.g., not enough EM\n  skipped: number\n  total: number\n  startTime?: number\n  finishTime?: number\n}\n\nconst Monospace = styled(\"strong\")({\n  fontFamily: \"monospace\"\n})\n\nconst BorderLinearProgress = styled(LinearProgress)(({ theme }) => ({\n  height: 10,\n  borderRadius: 5,\n}));\nexport default function BuildAlert({ status: { type, tested, failed, skipped, total, startTime, finishTime }, characterName }: { status: BuildStatus, characterName: Displayable }) {\n  const hasTotal = isFinite(total)\n\n  const generatingBuilds = type !== \"inactive\"\n  const unskipped = total - skipped\n\n  const testedString = <Monospace>{tested.toLocaleString()}</Monospace>\n  const unskippedString = <Monospace>{unskipped.toLocaleString()}</Monospace>\n  const skippedText = !!skipped && <span>(<b>{<Monospace>{skipped.toLocaleString()}</Monospace>}</b> skipped)</span>\n\n  const durationString = <Monospace>{timeStringMs(Math.round((finishTime ?? performance.now()) - (startTime ?? NaN)))}</Monospace>\n\n  let color = \"success\" as \"success\" | \"warning\" | \"error\"\n  let title = \"\" as ReactNode\n  let subtitle = \"\" as ReactNode\n  let progress = undefined as undefined | number\n\n  if (generatingBuilds) {\n    progress = tested * 100 / (unskipped)\n    title = <Typography>Generating and testing {testedString}{hasTotal ? <>/{unskippedString}</> : undefined} build configurations against the criteria for <b>{characterName}</b>. {skippedText}</Typography>\n    subtitle = <Typography>Time elapsed: {durationString}</Typography>\n  } else if (tested + skipped) {\n    progress = 100\n    title = <Typography>Generated and tested {testedString} Build configurations against the criteria for <b>{characterName}</b>. {skippedText}</Typography>\n    subtitle = <Typography>Total duration: {durationString}</Typography>\n  } else {\n    return null\n  }\n\n  return <Alert severity={color} variant=\"filled\" sx={{\n    \"& .MuiAlert-message\": {\n      flexGrow: 1\n    }\n  }}>\n    {title}\n    {subtitle}\n    {progress !== undefined && <Grid container spacing={1} alignItems=\"center\">\n      {hasTotal && <Grid item>\n        <Typography>{`${progress.toFixed(1)}%`}</Typography>\n      </Grid>}\n      <Grid item flexGrow={1} >\n        <BorderLinearProgress variant={hasTotal ? \"determinate\" : \"indeterminate\"} value={progress} color=\"primary\" />\n      </Grid>\n    </Grid>}\n  </Alert>\n}\n","import { BusinessCenter } from \"@mui/icons-material\";\nimport { alpha, Box, CardActionArea, Chip, Typography, useTheme } from \"@mui/material\";\nimport { useCallback, useContext } from \"react\";\nimport Assets from \"../../Assets/Assets\";\nimport Artifact from \"../../Data/Artifacts/Artifact\";\nimport { ArtifactSheet } from \"../../Data/Artifacts/ArtifactSheet\";\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\nimport { DatabaseContext } from \"../../Database/Database\";\nimport KeyMap, { cacheValueString } from \"../../KeyMap\";\nimport useArtifact from \"../../ReactHooks/useArtifact\";\nimport useDBMeta from \"../../ReactHooks/useDBMeta\";\nimport usePromise from \"../../ReactHooks/usePromise\";\nimport { ICachedSubstat } from \"../../Types/artifact\";\nimport { allElementsWithPhy, CharacterKey, SlotKey } from \"../../Types/consts\";\nimport { clamp } from \"../../Util/Util\";\nimport BootstrapTooltip from \"../BootstrapTooltip\";\nimport CardDark from \"../Card/CardDark\";\nimport ColorText from \"../ColoredText\";\nimport ConditionalWrapper from \"../ConditionalWrapper\";\nimport ImgIcon from \"../Image/ImgIcon\";\nimport { StatColoredWithUnit } from \"../StatDisplay\";\nimport StatIcon from \"../StatIcon\";\nimport ArtifactTooltip from \"./ArtifactTooltip\";\n\ntype Data = {\n  artifactId?: string,\n  slotKey: SlotKey,\n  mainStatAssumptionLevel?: number,\n  onClick?: () => void,\n  showLocation?: boolean,\n  BGComponent?: React.ElementType\n}\n\nexport default function ArtifactCardNano({ artifactId, slotKey: pSlotKey, mainStatAssumptionLevel = 0, showLocation = false, onClick, BGComponent = CardDark }: Data) {\n  const art = useArtifact(artifactId)\n  const { database } = useContext(DatabaseContext)\n  const sheet = usePromise(() => ArtifactSheet.get(art?.setKey), [art?.setKey])\n  const actionWrapperFunc = useCallback(children => <CardActionArea onClick={onClick} sx={{ height: \"100%\" }}>{children}</CardActionArea>, [onClick],)\n  const theme = useTheme()\n  if (!art) return <BGComponent sx={{ display: \"flex\", height: \"100%\", alignItems: \"center\", justifyContent: \"center\" }}>\n    <Box component=\"img\" src={Assets.slot[pSlotKey]} sx={{ width: \"25%\", height: \"auto\", opacity: 0.7 }} />\n  </BGComponent>\n\n  const { slotKey, rarity, level, mainStatKey, substats, location } = art\n  const mainStatLevel = Math.max(Math.min(mainStatAssumptionLevel, rarity * 4), level)\n  const mainStatUnit = KeyMap.unit(mainStatKey)\n  const element = allElementsWithPhy.find(ele => art.mainStatKey.includes(ele))\n  const color = element ? alpha(theme.palette[element].main, 0.6) : alpha(theme.palette.secondary.main, 0.6)\n  return <BGComponent sx={{ height: \"100%\" }}><ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}  >\n    <Box display=\"flex\" height=\"100%\">\n      <Box className={`grad-${rarity}star`} sx={{ position: \"relative\", flexGrow: 1, display: \"flex\", flexDirection: \"column\", alignItems: \"center\", justifyContent: \"center\" }} >\n        <ArtifactTooltip art={art}>\n          <Box\n            component=\"img\"\n            src={sheet?.slotIcons[slotKey] ?? \"\"}\n            sx={{ m: -1, maxHeight: \"110%\", maxWidth: \"110%\" }}\n          />\n        </ArtifactTooltip>\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"space-between\", pointerEvents: \"none\" }} >\n          <Chip size=\"small\" label={<strong>{` +${level}`}</strong>} color={Artifact.levelVariant(level)} />\n          {showLocation && <Chip size=\"small\" label={<LocationIcon charKey={location && database.chars.LocationToCharacterKey(location)} />} color={\"secondary\"} sx={{\n            overflow: \"visible\", \".MuiChip-label\": {\n              overflow: \"visible\"\n            }\n          }} />}\n        </Box>\n        {/* mainstats */}\n        <Chip size=\"small\" sx={{ position: \"absolute\", bottom: 0, mb: 1, backgroundColor: color }}\n          label={<Typography sx={{ display: \"flex\", gap: 0.5, px: 1, zIndex: 1 }}>\n            <BootstrapTooltip placement=\"top\" title={<Typography><StatColoredWithUnit statKey={mainStatKey} /></Typography>} disableInteractive>\n              <span>{StatIcon[mainStatKey]}</span>\n            </BootstrapTooltip>\n            <ColorText color={mainStatLevel !== level ? \"warning\" : undefined}>{cacheValueString(Artifact.mainStatValue(mainStatKey, rarity, mainStatLevel) ?? 0, KeyMap.unit(mainStatKey))}{mainStatUnit}</ColorText>\n          </Typography>} />\n      </Box>\n      {/* substats */}\n      <Box display=\"flex\" flexDirection=\"column\" justifyContent=\"space-between\" sx={{ p: 1, }}>\n        {substats.map((stat: ICachedSubstat, i: number) => <SubstatDisplay key={i + stat.key} stat={stat} />)}\n      </Box>\n    </Box>\n  </ConditionalWrapper></BGComponent >\n}\nfunction SubstatDisplay({ stat }: { stat: ICachedSubstat }) {\n  if (!stat.value) return null\n  const numRolls = stat.rolls?.length ?? 0\n  const rollColor = `roll${clamp(numRolls, 1, 6)}`\n  const unit = KeyMap.unit(stat.key)\n  return (<Box display=\"flex\" gap={1} alignContent=\"center\">\n    <Typography sx={{ flexGrow: 1, display: \"flex\", gap: 0.5 }} color={(numRolls ? `${rollColor}.main` : \"error.main\") as any} component=\"span\">\n      <BootstrapTooltip placement=\"top\" title={<Typography>{stat.key && <StatColoredWithUnit statKey={stat.key} />}</Typography>} disableInteractive>\n        <span>{StatIcon[stat.key]}</span>\n      </BootstrapTooltip>\n      <span>{`${cacheValueString(stat.value, KeyMap.unit(stat.key))}${unit}`}</span>\n    </Typography>\n  </Box>)\n}\nfunction LocationIcon({ charKey }: { charKey: CharacterKey | \"\" }) {\n  const { gender } = useDBMeta()\n  const characterSheet = usePromise(() => CharacterSheet.get(charKey, gender), [charKey, gender])\n  return characterSheet ? <BootstrapTooltip placement=\"right-end\" title={<Typography>{characterSheet.name}</Typography>}><ImgIcon src={characterSheet.thumbImgSide} size={2.5} sx={{ marginTop: \"-1.5em\", marginLeft: \"-0.5em\" }} /></BootstrapTooltip> : <BusinessCenter />\n}\n","import { Masonry } from \"@mui/lab\"\nimport { Divider, ListItem, Box } from \"@mui/material\"\nimport { useContext, useMemo } from \"react\"\nimport { DataContext } from \"../../Context/DataContext\"\nimport { FormulaDataContext } from \"../../Context/FormulaDataContext\"\nimport { OptimizationTargetContext } from \"../../Context/OptimizationTargetContext\"\nimport { ArtCharDatabase, DatabaseContext } from \"../../Database/Database\"\nimport { getDisplayHeader, getDisplaySections } from \"../../Formula/DisplayUtil\"\nimport { DisplaySub } from \"../../Formula/type\"\nimport { NodeDisplay, UIData } from \"../../Formula/uiData\"\nimport { customRead } from \"../../Formula/utils\"\nimport usePromise from \"../../ReactHooks/usePromise\"\nimport { objectMap } from \"../../Util/Util\"\nimport CardDark from \"../Card/CardDark\"\nimport CardHeaderCustom from \"../Card/CardHeaderCustom\"\nimport { FieldDisplayList, NodeFieldDisplay } from \"../FieldDisplay\"\nimport ImgIcon from \"../Image/ImgIcon\"\nimport SqBadge from \"../SqBadge\"\n\nexport default function StatDisplayComponent() {\n  const optimizationTarget = useContext(OptimizationTargetContext)\n  const { data, oldData } = useContext(DataContext)\n  const { setFormulaData } = useContext(FormulaDataContext)\n  const { database } = useContext(DatabaseContext)\n\n  const sections = useMemo(() =>\n    getDisplaySections(data).filter(([, ns]) => Object.values(ns).some(n => !n.isEmpty)),\n    [data])\n  return useMemo(() => <Box sx={{ mr: -1, mb: -1 }}>\n    <Masonry columns={{ xs: 1, sm: 2, md: 3, xl: 4 }} spacing={1}>\n      {sections.map(([key, Nodes]) =>\n        <Section key={key} displayNs={Nodes} sectionKey={key}\n          optimizationTarget={optimizationTarget} data={data} oldData={oldData} setFormulaData={setFormulaData} database={database}\n        />)}\n    </Masonry >\n  </Box>, [data, database, oldData, optimizationTarget, sections, setFormulaData])\n}\nfunction Section({ displayNs, sectionKey, optimizationTarget, data, oldData, setFormulaData, database }: {\n  displayNs: DisplaySub<NodeDisplay>,\n  sectionKey: string,\n  optimizationTarget?: string[],\n  data: UIData, oldData?: UIData,\n  setFormulaData: (data?: UIData | undefined, node?: NodeDisplay<number> | undefined) => void\n  database: ArtCharDatabase\n}) {\n  const header = usePromise(() => getDisplayHeader(data, sectionKey, database), [data, sectionKey])\n  const displayNsReads = useMemo(() => objectMap(displayNs, (n, nodeKey) => customRead([\"display\", sectionKey, nodeKey])), [displayNs, sectionKey]);\n  return useMemo(() => {\n    if (!header) return <CardDark></CardDark>\n    const { title, icon, action } = header\n    return <CardDark >\n      <CardHeaderCustom avatar={icon && <ImgIcon size={2} sx={{ m: -1 }} src={icon} />} title={title} action={action && <SqBadge>{action}</SqBadge>} />\n      <Divider />\n      <FieldDisplayList sx={{ m: 0 }}>\n        {Object.entries(displayNs).map(([nodeKey, n]) =>\n          <NodeFieldDisplay data={data} setFormulaData={setFormulaData} key={nodeKey} node={n} oldValue={oldData ? oldData.get(displayNsReads[nodeKey]!).value : undefined} component={ListItem}\n            emphasize={JSON.stringify(optimizationTarget) === JSON.stringify([sectionKey, nodeKey])}\n          />)}\n      </FieldDisplayList>\n    </CardDark>\n  }, [data, displayNs, displayNsReads, header, oldData, optimizationTarget, sectionKey, setFormulaData])\n}\n","import { BusinessCenter } from \"@mui/icons-material\";\nimport { Box, CardActionArea, Chip, Skeleton, Typography } from \"@mui/material\";\nimport { useCallback, useContext, useMemo } from \"react\";\nimport CharacterSheet from \"../../Data/Characters/CharacterSheet\";\nimport WeaponSheet from \"../../Data/Weapons/WeaponSheet\";\nimport { DatabaseContext } from \"../../Database/Database\";\nimport { input } from \"../../Formula\";\nimport { computeUIData, dataObjForWeapon } from \"../../Formula/api\";\nimport { NodeDisplay, nodeVStr } from '../../Formula/uiData';\nimport useDBMeta from \"../../ReactHooks/useDBMeta\";\nimport usePromise from \"../../ReactHooks/usePromise\";\nimport useWeapon from \"../../ReactHooks/useWeapon\";\nimport { LocationKey } from \"../../Types/consts\";\nimport BootstrapTooltip from \"../BootstrapTooltip\";\nimport CardDark from \"../Card/CardDark\";\nimport ConditionalWrapper from \"../ConditionalWrapper\";\nimport ImgIcon from \"../Image/ImgIcon\";\nimport WeaponNameTooltip from \"./WeaponNameTooltip\";\n\ntype Data = {\n  weaponId?: string,\n  onClick?: () => void,\n  showLocation?: boolean,\n  BGComponent?: React.ElementType,\n}\n\nexport default function WeaponCardNano({ weaponId, showLocation = false, onClick, BGComponent = CardDark, }: Data) {\n  const weapon = useWeapon(weaponId)\n  const weaponSheet = usePromise(() => weapon?.key && WeaponSheet.get(weapon.key), [weapon?.key])\n  const actionWrapperFunc = useCallback(children => <CardActionArea sx={{ height: \"100%\" }} onClick={onClick}>{children}</CardActionArea>, [onClick],)\n  const UIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\n  if (!weapon || !weaponSheet || !UIData) return <BGComponent sx={{ height: \"100%\" }}><Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\" }} /></BGComponent>;\n  const { refinement, location } = weapon\n  return <BGComponent sx={{ height: \"100%\" }}><ConditionalWrapper condition={!!onClick} wrapper={actionWrapperFunc}  >\n    <Box display=\"flex\" height=\"100%\" alignItems=\"stretch\" >\n      <Box className={`grad-${weaponSheet.rarity}star`} sx={{ height: \"100%\", position: \"relative\", flexGrow: 1, display: \"flex\", flexDirection: \"column\", alignItems: \"center\", justifyContent: \"flex-end\" }} >\n        <WeaponNameTooltip sheet={weaponSheet}>\n          <Box\n            component=\"img\"\n            src={weaponSheet.getImg(weapon.ascension)}\n            sx={{ mx: -1, maxHeight: \"100%\", maxWidth: \"100%\" }}\n          />\n        </WeaponNameTooltip>\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"space-between\", pointerEvents: \"none\" }} >\n          <Chip size=\"small\" label={<strong>{WeaponSheet.getLevelString(weapon)}</strong>} color=\"primary\" />\n          {showLocation && <Chip size=\"small\" label={<LocationIcon location={location} />} color={\"secondary\"} sx={{\n            overflow: \"visible\", \".MuiChip-label\": {\n              overflow: \"visible\"\n            }\n          }} />}\n        </Box>\n        <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\", p: 0.5, opacity: 0.85, display: \"flex\", justifyContent: \"flex-end\", alignItems: \"flex-end\" }} >\n          {weaponSheet.hasRefinement && <Chip size=\"small\" color=\"info\" label={<strong>R{refinement}</strong>} />}\n        </Box>\n      </Box>\n      <Box display=\"flex\" flexDirection=\"column\" sx={{ p: 1, }}>\n        <WeaponStat node={UIData.get(input.weapon.main)} />\n        <WeaponStat node={UIData.get(input.weapon.sub)} />\n      </Box>\n    </Box>\n  </ConditionalWrapper></BGComponent >\n}\nfunction WeaponStat({ node }: { node: NodeDisplay }) {\n  if (!node.info.name) return null\n  return (<Box display=\"flex\" gap={1} alignContent=\"center\">\n    <Typography sx={{ flexGrow: 1, display: \"flex\", gap: 1 }} component=\"span\">\n      <BootstrapTooltip placement=\"top\" title={<Typography>{node.info.name}</Typography>} disableInteractive>\n        <span>{node.info.icon}</span>\n      </BootstrapTooltip>\n      <span>{nodeVStr(node)}</span>\n    </Typography>\n  </Box>)\n}\nfunction LocationIcon({ location }: { location: LocationKey }) {\n  const { database } = useContext(DatabaseContext)\n  const { gender } = useDBMeta()\n  const characterSheet = usePromise(() => CharacterSheet.get(location ? database.chars.LocationToCharacterKey(location) : \"\", gender), [location, gender])\n  return characterSheet ? <BootstrapTooltip placement=\"right-end\" title={<Typography>{characterSheet.name}</Typography>}><ImgIcon src={characterSheet.thumbImgSide} sx={{ height: \"3em\", marginTop: \"-1.5em\", marginLeft: \"-0.5em\" }} /></BootstrapTooltip> : <BusinessCenter />\n}\n","import { Box, Typography } from \"@mui/material\"\nimport { useMemo } from \"react\"\nimport ArtifactSetTooltip from \"../../../../../Components/Artifact/ArtifactSetTooltip\"\nimport { artifactSlotIcon } from \"../../../../../Components/Artifact/SlotNameWIthIcon\"\nimport SqBadge from \"../../../../../Components/SqBadge\"\nimport { ArtifactSheet } from \"../../../../../Data/Artifacts/ArtifactSheet\"\nimport usePromise from \"../../../../../ReactHooks/usePromise\"\nimport { ICachedArtifact } from \"../../../../../Types/artifact\"\nimport { ArtifactSetKey, SlotKey } from \"../../../../../Types/consts\"\n\ntype ArtifactSetBadgesProps = {\n  artifacts: ICachedArtifact[],\n  currentlyEquipped?: boolean\n}\nexport function ArtifactSetBadges({ artifacts, currentlyEquipped = false }: ArtifactSetBadgesProps) {\n  const setToSlots: Partial<Record<ArtifactSetKey, SlotKey[]>> = useMemo(() => artifacts\n    .filter(arti => arti)\n    .reduce((acc, curr) => {\n      acc[curr.setKey] ? acc[curr.setKey].push(curr.slotKey) : acc[curr.setKey] = [curr.slotKey]\n      return acc\n    }, {}),\n    [artifacts]\n  )\n  return <>{Object.entries(setToSlots)\n    .sort(([_k1, slotarr1], [_k2, slotarr2]) => slotarr2.length - slotarr1.length)\n    .map(([key, slotarr]) =>\n      <ArtifactSetBadge key={key} setKey={key} currentlyEquipped={currentlyEquipped} slotarr={slotarr} />\n    )\n  }</>\n\n}\nfunction ArtifactSetBadge({ setKey, currentlyEquipped = false, slotarr }: { setKey: ArtifactSetKey, currentlyEquipped: boolean, slotarr: SlotKey[] }) {\n  const artifactSheet = usePromise(() => ArtifactSheet.get(setKey), [])\n  if (!artifactSheet) return null\n  const numInSet = slotarr.length\n  const setActive = Object.keys(artifactSheet.setEffects).map((setKey) => parseInt(setKey)).filter(setNum => setNum <= numInSet)\n  return <Box>\n    <ArtifactSetTooltip artifactSheet={artifactSheet} numInSet={numInSet} >\n      <SqBadge sx={{ height: \"100%\" }} color={currentlyEquipped ? \"success\" : \"primary\"} ><Typography >\n        {slotarr.map(slotKey => artifactSlotIcon(slotKey))} {artifactSheet.name ?? \"\"}\n        {setActive.map(n => <SqBadge sx={{ ml: 0.5 }} key={n} color=\"success\">{n}</SqBadge>)}\n      </Typography></SqBadge>\n    </ArtifactSetTooltip>\n  </Box>\n}\n","import { Checkroom, ChevronRight } from '@mui/icons-material';\nimport { Button, CardContent, Grid, Skeleton, Typography, Box } from '@mui/material';\nimport { Suspense, useCallback, useContext, useMemo, useState } from 'react';\nimport ArtifactCardNano from '../../../../../Components/Artifact/ArtifactCardNano';\nimport CardDark from '../../../../../Components/Card/CardDark';\nimport CardLight from '../../../../../Components/Card/CardLight';\nimport StatDisplayComponent from '../../../../../Components/Character/StatDisplayComponent';\nimport ModalWrapper from '../../../../../Components/ModalWrapper';\nimport SqBadge from '../../../../../Components/SqBadge';\nimport WeaponCardNano from '../../../../../Components/Weapon/WeaponCardNano';\nimport { CharacterContext } from '../../../../../Context/CharacterContext';\nimport { DataContext } from '../../../../../Context/DataContext';\nimport { DatabaseContext } from '../../../../../Database/Database';\nimport { uiInput as input } from '../../../../../Formula';\nimport ArtifactCard from '../../../../../PageArtifact/ArtifactCard';\nimport { ICachedArtifact } from '../../../../../Types/artifact';\nimport { allSlotKeys, charKeyToLocCharKey } from '../../../../../Types/consts';\nimport useBuildSetting from '../useBuildSetting';\nimport { ArtifactSetBadges } from './ArtifactSetBadges';\n\ntype NewOld = {\n  newId: string,\n  oldId?: string\n}\n\ntype BuildDisplayItemProps = {\n  label?: Displayable,\n  compareBuild: boolean,\n  disabled?: boolean,\n  extraButtonsRight?: JSX.Element,\n  extraButtonsLeft?: JSX.Element,\n}\n//for displaying each artifact build\nexport default function BuildDisplayItem({ label, compareBuild, extraButtonsRight, extraButtonsLeft, disabled }: BuildDisplayItemProps) {\n  const { character: { key: characterKey, equippedArtifacts } } = useContext(CharacterContext)\n  const { buildSetting: { mainStatAssumptionLevel } } = useBuildSetting(characterKey)\n  const { database } = useContext(DatabaseContext)\n  const dataContext = useContext(DataContext)\n\n  const { data, oldData } = dataContext\n  const [newOld, setNewOld] = useState(undefined as NewOld | undefined)\n  const close = useCallback(() => setNewOld(undefined), [setNewOld],)\n\n  const equipBuild = useCallback(() => {\n    if (!window.confirm(\"Do you want to equip this build to this character?\")) return\n    allSlotKeys.forEach(s => {\n      const aid = data.get(input.art[s].id).value\n      if (aid) database.arts.set(aid, { location: charKeyToLocCharKey(characterKey) })\n    })\n    database.weapons.set(data.get(input.weapon.id).value!, { location: charKeyToLocCharKey(characterKey) })\n  }, [characterKey, data, database])\n\n  const statProviderContext = useMemo(() => {\n    const dataContext_ = { ...dataContext }\n    if (!compareBuild) dataContext_.oldData = undefined\n    return dataContext_\n  }, [dataContext, compareBuild])\n\n  const artifactIdsBySlot = useMemo(() => Object.fromEntries(allSlotKeys.map(slotKey => [\n    slotKey,\n    data.get(input.art[slotKey].id).value\n  ])), [data])\n  const artifacts = useMemo(() => artifactIdsBySlot && Object.values(artifactIdsBySlot)\n    .map((artiId: string) => database.arts.get(artiId))\n    .filter(arti => arti) as ICachedArtifact[],\n    [artifactIdsBySlot, database.arts]\n  )\n\n  const weaponNano = useMemo(() => <WeaponCardNano showLocation weaponId={data.get(input.weapon.id).value} />, [data])\n  // Memoize Arts because of its dynamic onClick\n  const artNanos = useMemo(() => allSlotKeys.map(slotKey =>\n    <Grid item xs={1} key={slotKey} >\n      <ArtifactCardNano showLocation slotKey={slotKey} artifactId={artifactIdsBySlot[slotKey]} mainStatAssumptionLevel={mainStatAssumptionLevel} onClick={() => {\n        const oldId = equippedArtifacts[slotKey]\n        const newId = artifactIdsBySlot[slotKey]!\n        setNewOld({ oldId: oldId !== newId ? oldId : undefined, newId })\n      }} />\n    </Grid>), [setNewOld, equippedArtifacts, mainStatAssumptionLevel, artifactIdsBySlot])\n\n  if (!oldData) return null\n  const currentlyEquipped = allSlotKeys.every(slotKey => artifactIdsBySlot[slotKey] === oldData.get(input.art[slotKey].id).value) && data.get(input.weapon.id).value === oldData.get(input.weapon.id).value\n\n  return <CardLight>\n    <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\n      {newOld && <CompareArtifactModal newOld={newOld} mainStatAssumptionLevel={mainStatAssumptionLevel} onClose={close} />}\n      <CardContent>\n        <BuildHeader label={label} currentlyEquipped={currentlyEquipped} artifacts={artifacts} extraButtonsLeft={extraButtonsLeft} equipBuild={equipBuild} disabled={disabled} extraButtonsRight={extraButtonsRight} />\n        <Grid container spacing={1} sx={{ pb: 1 }} columns={{ xs: 2, sm: 3, md: 4, lg: 6 }}>\n          <Grid item xs={1}>\n            {weaponNano}\n          </Grid>\n          {artNanos}\n        </Grid>\n        <DataContext.Provider value={statProviderContext}>\n          <StatDisplayComponent />\n        </DataContext.Provider>\n      </CardContent>\n    </Suspense>\n  </CardLight>\n}\n\nfunction BuildHeader({ label, currentlyEquipped, artifacts, extraButtonsLeft, equipBuild, disabled, extraButtonsRight }: {\n  label?: Displayable,\n  currentlyEquipped: boolean\n  artifacts: ICachedArtifact[]\n  extraButtonsLeft?: JSX.Element,\n  equipBuild: () => void\n  disabled?: boolean,\n  extraButtonsRight?: JSX.Element,\n}) {\n  return useMemo(() => <Box display=\"flex\" gap={1} sx={{ pb: 1 }} flexWrap=\"wrap\">\n    {label !== undefined && <SqBadge color=\"info\"><Typography><strong>{label}{currentlyEquipped ? \" (Equipped)\" : \"\"}</strong></Typography></SqBadge>}\n    <ArtifactSetBadges artifacts={artifacts} currentlyEquipped={currentlyEquipped} />\n    <Box sx={{ flexGrow: 1, display: \"flex\", justifyContent: \"flex-end\" }}>\n    </Box>\n    {extraButtonsLeft}\n    <Button size='small' color=\"success\" onClick={equipBuild} disabled={disabled || currentlyEquipped} startIcon={<Checkroom />}>Equip Build</Button>\n    {extraButtonsRight}\n  </Box>, [artifacts, currentlyEquipped, disabled, equipBuild, extraButtonsLeft, extraButtonsRight, label])\n}\n\nfunction CompareArtifactModal({ newOld: { newId, oldId }, mainStatAssumptionLevel, onClose }: { newOld: NewOld, mainStatAssumptionLevel: number, onClose: () => void }) {\n  const { database } = useContext(DatabaseContext)\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const onEquip = useCallback(() => {\n    if (!window.confirm(\"Do you want to equip this artifact to this character?\")) return\n    database.arts.set(newId, { location: charKeyToLocCharKey(characterKey) })\n    onClose()\n  }, [newId, database, characterKey, onClose])\n\n  return <ModalWrapper open={!!newId} onClose={onClose} containerProps={{ maxWidth: oldId ? \"md\" : \"xs\" }}>\n    <CardDark>\n      <CardContent sx={{ display: \"flex\", justifyContent: \"center\", alignItems: \"stretch\", gap: 2, height: \"100%\" }}>\n        {oldId && <Box minWidth={320}><ArtifactCard artifactId={oldId} mainStatAssumptionLevel={mainStatAssumptionLevel} canExclude canEquip editorProps={{ disableSet: true, disableSlot: true }} /></Box>}\n        {oldId && <Box display=\"flex\" flexGrow={1} />}\n        {oldId && <Box display=\"flex\" alignItems=\"center\" justifyContent=\"center\"><Button onClick={onEquip} sx={{ display: \"flex\" }}><ChevronRight sx={{ fontSize: 40 }} /></Button></Box>}\n        {oldId && <Box display=\"flex\" flexGrow={1} />}\n        <Box minWidth={320}><ArtifactCard artifactId={newId} mainStatAssumptionLevel={mainStatAssumptionLevel} canExclude canEquip editorProps={{ disableSet: true, disableSlot: true }} /></Box>\n      </CardContent>\n    </CardDark>\n  </ModalWrapper>\n}\n","import { useCallback, useContext, useEffect, useState } from \"react\";\nimport { DatabaseContext } from \"../../../../Database/Database\";\nimport { IBuildResult } from \"../../../../Database/DataManagers/BuildResult\";\nimport { CharacterKey } from \"../../../../Types/consts\";\n\nexport default function useBuildResult(characterKey: CharacterKey) {\n  const { database } = useContext(DatabaseContext)\n  const [buildResult, setBuildResult] = useState(() => database.buildResult.get(characterKey))\n  useEffect(() => setBuildResult(database.buildResult.get(characterKey)), [database, characterKey])\n  useEffect(() =>\n    database.buildResult.follow(characterKey, (k, r, v) => r === \"update\" && setBuildResult(v)),\n    [characterKey, setBuildResult, database])\n  const buildResultDispatch = useCallback((action: Partial<IBuildResult>) => characterKey && database.buildResult.set(characterKey, action), [characterKey, database],)\n\n  return { buildResult, buildResultDispatch }\n}\n","import { DotProps } from \"recharts\"\nimport EnhancedPoint from \"./EnhancedPoint\"\n\ntype CustomShapeType = \"circle\" | \"diamond\" | \"square\"\ntype CustomDotProps = DotProps & {\n  selectedPoint: EnhancedPoint | undefined\n  payload?: EnhancedPoint\n  radiusSelected?: number\n  radiusUnselected?: number\n  colorSelected?: string\n  colorUnselected: string\n  shape?: CustomShapeType\n}\nexport default function CustomDot({ cx, cy, payload, selectedPoint, radiusSelected = 6, radiusUnselected = 3, colorSelected = \"red\", colorUnselected, shape = \"circle\" }: CustomDotProps) {\n  if (!cx || !cy || !payload) {\n    return null\n  }\n\n  const isSelected = selectedPoint && selectedPoint.x === payload.x && selectedPoint.y === payload.y\n\n  return (\n    <g\n      className=\"custom-dot\"\n      data-chart-x={cx}\n      data-chart-y={cy}\n      data-x-value={payload.x}\n      data-y-value={payload.y}\n      data-radius={isSelected ? radiusUnselected : radiusSelected}\n    >\n      {!isSelected\n        ? <CustomShape id=\"customShapeUnselected\" shape={shape} cx={cx} cy={cy} r={radiusUnselected} fill={colorUnselected} />\n        : <>\n          <CustomShape id=\"customShapeSelected\" shape={shape} cx={cx} cy={cy} r={radiusSelected / 2} fill={colorSelected} />\n          <CustomShape id=\"customShapeBorder\" shape={shape} cx={cx} cy={cy} r={radiusSelected} fill=\"none\" stroke={colorSelected} />\n        </>\n      }\n    </g>\n  )\n}\nfunction CustomShape({ shape, id, cx, cy, r, fill, stroke}: { shape: CustomShapeType, id?: string, cx: number, cy: number, r: number, fill?: string, stroke?: string }) {\n  switch(shape) {\n    case \"circle\":\n      return <circle id={id} cx={cx} cy={cy} r={r} fill={fill} stroke={stroke} />\n    case \"square\":\n      return <rect id={id} x={cx-r} y={cy-r} width={r*2} height={r*2} fill={fill} stroke={stroke} />\n    case \"diamond\":\n      return <polygon id={id} points={`${cx},${cy+r*2.5} ${cx+r*1.5},${cy} ${cx},${cy-r*2.5} ${cx-r*1.5},${cy}`} fill={fill} stroke={stroke} />\n  }\n}\n","import { Button, CardContent, ClickAwayListener, Grid, Skeleton, Stack, Typography } from \"@mui/material\"\nimport { Suspense, useCallback, useContext, useMemo } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport { TooltipProps } from \"recharts\"\nimport ArtifactCardPico from \"../../../../../../Components/Artifact/ArtifactCardPico\"\nimport BootstrapTooltip from \"../../../../../../Components/BootstrapTooltip\"\nimport CardDark from \"../../../../../../Components/Card/CardDark\"\nimport CloseButton from \"../../../../../../Components/CloseButton\"\nimport SqBadge from \"../../../../../../Components/SqBadge\"\nimport { CharacterContext } from \"../../../../../../Context/CharacterContext\"\nimport { DataContext } from \"../../../../../../Context/DataContext\"\nimport { DatabaseContext } from \"../../../../../../Database/Database\"\nimport { input } from \"../../../../../../Formula\"\nimport { Unit, valueString } from \"../../../../../../KeyMap\"\nimport { ICachedArtifact } from \"../../../../../../Types/artifact\"\nimport { allSlotKeys } from \"../../../../../../Types/consts\"\nimport useBuildResult from \"../../useBuildResult\"\nimport { ArtifactSetBadges } from \"../ArtifactSetBadges\"\nimport EnhancedPoint from \"./EnhancedPoint\"\n\ntype CustomTooltipProps = TooltipProps<number, string> & {\n  xLabel: Displayable\n  xUnit: Unit | undefined\n  yLabel: Displayable\n  yUnit: Unit | undefined\n  selectedPoint: EnhancedPoint | undefined\n  setSelectedPoint: (pt: EnhancedPoint | undefined) => void\n  addBuildToList: (build: string[]) => void\n  graphBuilds: string[][] | undefined\n}\nexport default function CustomTooltip({ xLabel, xUnit, yLabel, yUnit, selectedPoint, setSelectedPoint, addBuildToList, graphBuilds, ...tooltipProps }: CustomTooltipProps) {\n  const { database } = useContext(DatabaseContext)\n  const { data } = useContext(DataContext)\n  const { t } = useTranslation(\"page_character_optimize\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { buildResult: { builds } } = useBuildResult(characterKey)\n\n  const canAddBuild = useMemo(() => ![...builds, ...(graphBuilds ?? [])].some(artiIds =>\n    artiIds.every(id => selectedPoint?.artifactIds.includes(id))\n  ), [builds, graphBuilds, selectedPoint])\n\n  const artifactsBySlot: { [slot: string]: ICachedArtifact } = useMemo(() =>\n    selectedPoint && selectedPoint.artifactIds && Object.fromEntries(selectedPoint.artifactIds\n      .map(id => {\n        const artiObj = database.arts.get(id)\n        return [artiObj?.slotKey, artiObj]\n      })\n      .filter(arti => arti)\n    ),\n    [database.arts, selectedPoint]\n  )\n  const clickAwayHandler = useCallback((e) => {\n    if (!(e.target.id.includes(\"customShape\") || e.target.id.includes(\"chartContainer\"))) {\n      setSelectedPoint(undefined)\n    }\n  }, [setSelectedPoint])\n\n  const currentlyEquipped = artifactsBySlot && allSlotKeys.every(slotKey => artifactsBySlot[slotKey]?.id === data.get(input.art[slotKey].id).value)\n\n  if (tooltipProps.active && selectedPoint) {\n    return <ClickAwayListener onClickAway={clickAwayHandler}>\n      <CardDark sx={{ minWidth: \"400px\", maxWidth: \"400px\" }} onClick={(e) => e.stopPropagation()}>\n        <CardContent>\n          <Stack gap={1}>\n            <Stack direction=\"row\" alignItems=\"start\" gap={1}>\n              <Stack spacing={0.5} flexGrow={99}>\n                {currentlyEquipped && <SqBadge color=\"info\"><strong>{t(\"currentlyEquippedBuild\")}</strong></SqBadge>}\n                <Suspense fallback={<Skeleton width={300} height={50} />}>\n                  <ArtifactSetBadges artifacts={Object.values(artifactsBySlot)} currentlyEquipped={currentlyEquipped} />\n                </Suspense>\n              </Stack>\n              <Grid item flexGrow={1} />\n              <CloseButton onClick={() => setSelectedPoint(undefined)} />\n            </Stack>\n            <Grid container direction=\"row\" spacing={0.75} columns={5}>\n              {allSlotKeys.map(key =>\n                <Grid item key={key} xs={1}>\n                  <Suspense fallback={<Skeleton width={75} height={75} />}>\n                    <ArtifactCardPico artifactObj={artifactsBySlot[key]} slotKey={key} />\n                  </Suspense>\n                </Grid>\n              )}\n            </Grid>\n            <Typography><strong>{xLabel}</strong>: {valueString(xUnit === \"%\" ? selectedPoint.x / 100 : selectedPoint.x, xUnit)}</Typography>\n            <Typography><strong>{yLabel}</strong>: {valueString(yUnit === \"%\" ? selectedPoint.y / 100 : selectedPoint.y, yUnit)}</Typography>\n            <BootstrapTooltip title={canAddBuild ? \"\" : t(\"tcGraph.buildAlreadyInList\")} placement=\"top\">\n              <span>\n                <Button sx={{ width: \"100%\" }} disabled={!canAddBuild} color=\"info\" onClick={() => addBuildToList(selectedPoint.artifactIds)}>{t(\"addBuildToList\")}</Button>\n              </span>\n            </BootstrapTooltip>\n          </Stack>\n        </CardContent>\n      </CardDark>\n    </ClickAwayListener>\n  }\n\n  return null\n}\n","export default class EnhancedPoint {\n  public x: number\n  public trueY?: number\n  public artifactIds: string[]\n  public min?: number\n  public current?: number\n  public highlighted?: number\n\n  public constructor(x: number, y: number, artifactIds: string[]) {\n    this.x = x\n    this.trueY = y\n    this.artifactIds = artifactIds\n  }\n\n  public get y(): number {\n    return (this.trueY || this.current || this.highlighted) as number\n  }\n  public set y(y: number | undefined) {\n    this.trueY = y\n  }\n}\n","import { CheckBox, CheckBoxOutlineBlank, Download, Replay } from '@mui/icons-material';\nimport { Button, CardContent, Collapse, Divider, Grid, Slider, styled, Typography } from '@mui/material';\nimport { useCallback, useContext, useEffect, useMemo, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { CartesianGrid, ComposedChart, Label, Legend, LegendType, Line, ResponsiveContainer, Scatter, Tooltip, XAxis, YAxis } from 'recharts';\nimport BootstrapTooltip from '../../../../../../Components/BootstrapTooltip';\nimport CardDark from '../../../../../../Components/Card/CardDark';\nimport CardLight from '../../../../../../Components/Card/CardLight';\nimport InfoTooltip from '../../../../../../Components/InfoTooltip';\nimport { CharacterContext } from '../../../../../../Context/CharacterContext';\nimport { DataContext } from '../../../../../../Context/DataContext';\nimport { ChartData } from '../../../../../../Context/GraphContext';\nimport { ArtCharDatabase, DatabaseContext } from '../../../../../../Database/Database';\nimport { input } from '../../../../../../Formula';\nimport { NumNode } from '../../../../../../Formula/type';\nimport { valueString } from '../../../../../../KeyMap';\nimport { allSlotKeys, SlotKey } from '../../../../../../Types/consts';\nimport { objectKeyValueMap, objPathValue } from '../../../../../../Util/Util';\nimport useBuildResult from '../../useBuildResult';\nimport OptimizationTargetSelector from '../OptimizationTargetSelector';\nimport CustomDot from './CustomDot';\nimport CustomTooltip from './CustomTooltip';\nimport EnhancedPoint from './EnhancedPoint';\n\nexport type Point = {\n  x: number\n  y: number\n  artifactIds: string[]\n  min?: number\n}\ntype ChartCardProps = {\n  plotBase?: string[]\n  setPlotBase: (path: string[] | undefined) => void\n  disabled?: boolean\n  showTooltip?: boolean\n  chartData?: ChartData\n  graphBuilds: string[][] | undefined\n  setGraphBuilds: (builds: string[][] | undefined) => void\n}\nexport default function ChartCard({ plotBase, setPlotBase, disabled = false, showTooltip = false, chartData, graphBuilds, setGraphBuilds }: ChartCardProps) {\n  const { t } = useTranslation([\"page_character_optimize\", \"ui\"])\n  const { data } = useContext(DataContext)\n  const [showDownload, setshowDownload] = useState(false)\n  const [showMin, setshowMin] = useState(true)\n  const { database } = useContext(DatabaseContext)\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { buildResult: { builds } } = useBuildResult(characterKey)\n\n  const [sliderLow, setSliderLow] = useState(-Infinity)\n  const [sliderHigh, setSliderHigh] = useState(Infinity)\n  const setSlider = useCallback(\n    (_e: unknown, value: number | number[]) => {\n      if (typeof value === \"number\") throw new TypeError()\n      const [l, h] = value\n      setSliderLow(l)\n      setSliderHigh(h)\n    },\n    [setSliderLow, setSliderHigh]\n  )\n  useEffect(() => { setSliderLow(-Infinity); setSliderHigh(Infinity) }, [chartData])\n\n  const { displayData, downloadData, sliderMin, sliderMax } = useMemo(() => {\n    if (!chartData) return { displayData: null, downloadData: null }\n    let sliderMin = Infinity\n    let sliderMax = -Infinity\n    const currentBuild = objectKeyValueMap(allSlotKeys, slotKey => [slotKey, data?.get(input.art[slotKey].id).value ?? \"\"])\n    const highlightedBuildsSlotMap = [...builds, ...(graphBuilds ?? [])].map(artiIds => convertArtiIdsToArtiSlotMap(artiIds, database))\n    // Shape the data so we know the current and highlighted builds\n    const points = chartData.data.map(({ value: y, plot: x, artifactIds }) => {\n      if (x === undefined) return null\n      if (x < sliderMin) sliderMin = x\n      if (x > sliderMax) sliderMax = x\n      const enhancedDatum: EnhancedPoint = new EnhancedPoint(x, y, artifactIds)\n      const datumSlotMap = convertArtiIdsToArtiSlotMap(artifactIds, database)\n\n      const isCurrentBuild = allSlotKeys.every(slotKey => currentBuild[slotKey] === datumSlotMap[slotKey])\n      if (isCurrentBuild) {\n        enhancedDatum.current = y\n        // Remove the Y-value so there are not 2 dots displayed for these builds\n        enhancedDatum.y = undefined\n        return enhancedDatum\n      }\n\n      const isHighlightedBuild = highlightedBuildsSlotMap.some(highlightedSlotMap =>\n        allSlotKeys.every(slotKey => highlightedSlotMap[slotKey] === datumSlotMap[slotKey])\n      )\n      if (isHighlightedBuild) {\n        enhancedDatum.highlighted = y\n        // Remove the Y-value so there are not 2 dots displayed for these builds\n        enhancedDatum.y = undefined\n      }\n      return enhancedDatum\n    })\n      .sort((a, b) => a!.x - b!.x) as EnhancedPoint[]\n\n    const minimumData: EnhancedPoint[] = []\n    for (const point of points) {\n      let last: EnhancedPoint | undefined\n      while ((last = minimumData.pop())) {\n        if (last.y > point.y) {\n          minimumData.push(last)\n          break\n        }\n      }\n      minimumData.push(point)\n    }\n\n    // Note:\n    // We can also just use `minimumData` if the plotter supports multiple data sources.\n    // It could be faster too since there're no empty entries in `minimumData`.\n    // From my limited testing, using multiple data sources makes the graph behave strangely though.\n    if (minimumData[0]?.x !== points[0]?.x)\n      points[0].min = minimumData[0].y\n    minimumData.forEach(pt => { pt.min = pt.y })\n\n    const downloadData = {\n      minimum: minimumData.map(point => [point.x, point.y]),\n      allData: points.map(point => [point.x, point.y]),\n    }\n    return { displayData: points.filter(pt => pt && pt.x >= sliderLow && pt.x <= sliderHigh), downloadData, sliderMin, sliderMax }\n  }, [chartData, builds, data, database, graphBuilds, sliderLow, sliderHigh])\n\n  const plotBaseNode = plotBase && objPathValue(data?.getDisplay(), plotBase)\n  const invalidTarget = plotBase && (!plotBaseNode || plotBaseNode.isEmpty)\n\n  const buttonText = invalidTarget\n    ? t(\"page_character_optimize:targetSelector.invalidTarget\")\n    : t(\"page_character_optimize:targetSelector.selectGraphTarget\")\n\n  return <CardLight>\n    <CardContent>\n      <Grid container spacing={1} alignItems=\"center\">\n        <Grid item>\n          <Typography >{t`tcGraph.vs`}</Typography>\n        </Grid>\n        <Grid item>\n          <BootstrapTooltip placement=\"top\" title={showTooltip ? t(\"page_character_optimize:selectTargetFirst\") : \"\"}>\n            <span>\n              <OptimizationTargetSelector\n                optimizationTarget={plotBase}\n                setTarget={target => setPlotBase(target)}\n                defaultText={buttonText}\n                disabled={disabled}\n              />\n            </span>\n          </BootstrapTooltip>\n        </Grid>\n        <Grid item>\n          <BootstrapTooltip title={!plotBase ? \"\" : t(\"ui:reset\")} placement=\"top\">\n            <span><Button color=\"error\" onClick={() => setPlotBase(undefined)} disabled={!plotBase}>\n              <Replay />\n            </Button></span>\n          </BootstrapTooltip>\n        </Grid>\n        <Grid item flexGrow={1}>\n          <InfoTooltip placement=\"top\" title={t(\"page_character_optimize:tcGraph.desc\")} />\n        </Grid>\n        {!!downloadData && <Grid item>\n          <Button size='small' startIcon={showMin ? <CheckBox /> : <CheckBoxOutlineBlank />}\n            color={showMin ? \"success\" : \"secondary\"}\n            onClick={() => setshowMin(!showMin)}>{t`tcGraph.showStatThr`}</Button>\n        </Grid>}\n        {!!downloadData && <Grid item>\n          <Button size='small' color=\"info\" startIcon={<Download />} onClick={() => setshowDownload(!showDownload)}>{t`tcGraph.downloadData`}</Button>\n        </Grid>}\n      </Grid>\n    </CardContent>\n    {displayData && displayData.length && <Divider />}\n    {chartData && displayData && displayData.length && <CardContent>\n      <Collapse in={!!downloadData && showDownload}>\n        <CardDark sx={{ mb: 2 }}>\n          <CardContent>\n            <Typography>Min Data</Typography>\n            <DataDisplay data={downloadData?.minimum} />\n            <Typography>All Data</Typography>\n            <DataDisplay data={downloadData?.allData} />\n          </CardContent>\n        </CardDark>\n      </Collapse>\n      <Chart displayData={displayData} plotNode={chartData.plotNode} valueNode={chartData.valueNode} showMin={showMin} graphBuilds={graphBuilds} setGraphBuilds={setGraphBuilds} />\n      {displayData.length > 1 && <Slider\n        marks\n        value={[sliderLow, sliderHigh]}\n        onChange={setSlider}\n        onChangeCommitted={setSlider}\n        min={sliderMin}\n        max={sliderMax}\n        step={(sliderMax - sliderMin) / 20}\n        valueLabelDisplay=\"auto\"\n        valueLabelFormat={n => valueString(chartData.plotNode.info?.unit === \"%\" ? n / 100 : n, chartData.plotNode.info?.unit)}\n        sx={{ ml: \"6%\", width: \"93%\" }}\n      />}\n    </CardContent>}\n  </CardLight >\n}\nconst TextArea = styled(\"textarea\")({\n  width: \"100%\",\n  fontFamily: \"monospace\",\n  resize: \"vertical\",\n  minHeight: \"5em\"\n})\nfunction DataDisplay({ data, }: { data?: object }) {\n  return <TextArea readOnly value={JSON.stringify(data)} onClick={e => {\n    const target = e.target as HTMLTextAreaElement;\n    target.selectionStart = 0;\n    target.selectionEnd = target.value.length;\n  }} />\n}\n\nconst optTargetColor = \"#8884d8\"\nconst highlightedColor = \"cyan\"\nconst currentColor = \"#46a046\"\nconst lineColor = \"#ff7300\"\nfunction Chart({ displayData, plotNode, valueNode, showMin, graphBuilds, setGraphBuilds }: {\n  displayData: EnhancedPoint[]\n  plotNode: NumNode\n  valueNode: NumNode\n  showMin: boolean\n  graphBuilds: string[][] | undefined\n  setGraphBuilds: (builds: string[][] | undefined) => void\n}) {\n  const { t } = useTranslation(\"page_character_optimize\")\n  const [selectedPoint, setSelectedPoint] = useState<EnhancedPoint>()\n  const addBuildToList = useCallback((build: string[]) => setGraphBuilds([...(graphBuilds ?? []), build]), [setGraphBuilds, graphBuilds])\n  const chartOnClick = useCallback(props => {\n    if (props && props.chartX && props.chartY) setSelectedPoint(getNearestPoint(props.chartX, props.chartY, 20, displayData))\n  }, [setSelectedPoint, displayData])\n\n  // Below works because character translation should already be loaded\n  const xLabelValue = getLabelFromNode(plotNode, t)\n  const yLabelValue = getLabelFromNode(valueNode, t)\n\n  return <ResponsiveContainer width=\"100%\" height={600}>\n    <ComposedChart id=\"chartContainer\" data={displayData} onClick={chartOnClick} style={{ cursor: \"pointer\" }}>\n      <CartesianGrid strokeDasharray=\"3 3\" />\n      <XAxis\n        dataKey=\"x\"\n        scale=\"linear\"\n        unit={plotNode.info?.unit}\n        domain={[\"auto\", \"auto\"]}\n        tick={{ fill: 'white' }}\n        type=\"number\"\n        tickFormatter={n => n > 10000 ? n.toFixed() : n.toFixed(1)}\n        label={<Label fill=\"white\" dy={10}>{xLabelValue}</Label>}\n        height={50}\n      />\n      <YAxis\n        name=\"DMG\"\n        domain={[\"auto\", \"auto\"]}\n        unit={valueNode.info?.unit}\n        allowDecimals={false}\n        tick={{ fill: 'white' }}\n        type=\"number\"\n        label={<Label fill=\"white\" angle={-90} dx={-40}>{yLabelValue}</Label>}\n        width={100}\n      />\n      <Tooltip\n        content={<CustomTooltip\n          xLabel={xLabelValue}\n          xUnit={plotNode.info?.unit}\n          yLabel={yLabelValue}\n          yUnit={valueNode.info?.unit}\n          selectedPoint={selectedPoint}\n          setSelectedPoint={setSelectedPoint}\n          addBuildToList={addBuildToList}\n          graphBuilds={graphBuilds}\n        />}\n        trigger=\"click\"\n        wrapperStyle={{ pointerEvents: \"auto\", cursor: \"auto\" }}\n        cursor={false}\n      />\n      <Legend payload={[\n        ...(showMin ? [{ id: \"min\", value: t`tcGraph.statReqThr`, type: \"line\" as LegendType, color: lineColor }] : []),\n        { id: \"trueY\", value: t`tcGraph.generatedBuilds`, type: \"circle\", color: optTargetColor },\n        { id: \"highlighted\", value: t`tcGraph.highlightedBuilds`, type: \"square\", color: highlightedColor },\n        { id: \"current\", value: t`tcGraph.currentBuild`, type: \"diamond\", color: currentColor },\n      ]} />\n      {showMin && <Line\n        dataKey=\"min\"\n        stroke={lineColor}\n        type=\"stepBefore\"\n        connectNulls\n        strokeWidth={2}\n        isAnimationActive={false}\n        dot={false}\n        activeDot={false}\n      />}\n      <Scatter\n        dataKey=\"trueY\"\n        isAnimationActive={false}\n        shape={<CustomDot selectedPoint={selectedPoint} colorUnselected={optTargetColor} />}\n      />\n      <Scatter\n        dataKey=\"highlighted\"\n        isAnimationActive={false}\n        shape={<CustomDot shape=\"square\" selectedPoint={selectedPoint} colorUnselected={highlightedColor} />}\n      />\n      <Scatter\n        dataKey=\"current\"\n        isAnimationActive={false}\n        shape={<CustomDot shape=\"diamond\" selectedPoint={selectedPoint} colorUnselected={currentColor} />}\n      />\n    </ComposedChart>\n  </ResponsiveContainer>\n}\n\nfunction convertArtiIdsToArtiSlotMap(artifactIds: string[], database: ArtCharDatabase) {\n  // Create partial mapping of slotkey -> build artifact\n  const partialArtiSlotMap: Dict<SlotKey, string> = Object.fromEntries(artifactIds.map(artiId => {\n    const arti = database.arts.get(artiId)\n    return arti ? [arti.slotKey, arti.id] : []\n  }))\n  // Fill in the blanks so we have a StrictDict<SlotKey, string>\n  return objectKeyValueMap(allSlotKeys, slotKey => [slotKey, partialArtiSlotMap[slotKey] ?? \"\"])\n}\n\nfunction getNearestPoint(clickedX: number, clickedY: number, threshold: number, data: EnhancedPoint[]) {\n  const nearestDomPtData = Array.from(document.querySelectorAll(\".custom-dot\"))\n    .reduce((domPtA, domPtB) => {\n      const { chartX: aChartX, chartY: aChartY } = (domPtA as any).dataset\n      const aDistance = Math.sqrt((clickedX - aChartX) ** 2 + (clickedY - aChartY) ** 2)\n      const { chartX: bChartX, chartY: bChartY } = (domPtB as any).dataset\n      const bDistance = Math.sqrt((clickedX - bChartX) ** 2 + (clickedY - bChartY) ** 2)\n      return aDistance <= bDistance\n        ? domPtA\n        : domPtB\n    })[\"dataset\"]\n\n  // Don't select a point too far away\n  const distance = Math.sqrt((clickedX - nearestDomPtData.chartX) ** 2 + (clickedY - nearestDomPtData.chartY) ** 2)\n  return distance < threshold\n    ? data.find(d => d.x === +nearestDomPtData.xValue && d.y === +nearestDomPtData.yValue)\n    : undefined\n}\n\nfunction getLabelFromNode(node: NumNode, t: any) {\n  return typeof node.info?.name === \"string\"\n    ? node.info.name\n    : `${t(`${node.info?.name?.props.ns}:${node.info?.name?.props.key18}`)}${node.info?.textSuffix ? ` ${node.info?.textSuffix}` : \"\"}`\n}\n","import { Replay } from '@mui/icons-material';\nimport { Button, CardContent, Divider, Grid, Typography, Box } from '@mui/material';\nimport { useContext, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { arrayEq, useMemoEq } from '..';\nimport { artifactSlotIcon } from '../../../../../Components/Artifact/SlotNameWIthIcon';\nimport BootstrapTooltip from '../../../../../Components/BootstrapTooltip';\nimport SqBadge from '../../../../../Components/SqBadge';\nimport { StatColoredWithUnit } from '../../../../../Components/StatDisplay';\nimport StatIcon from '../../../../../Components/StatIcon';\nimport { CharacterContext } from '../../../../../Context/CharacterContext';\nimport Artifact from '../../../../../Data/Artifacts/Artifact';\nimport { BuildSettingReducerAction } from '../../../../../Database/DataManagers/BuildSettingData';\nimport { MainStatKey } from '../../../../../Types/artifact';\nimport { allElementsWithPhy } from '../../../../../Types/consts';\nimport useBuildSetting from '../useBuildSetting';\n\nexport const artifactsSlotsToSelectMainStats = [\"sands\", \"goblet\", \"circlet\"] as const\n\nexport default function MainStatSelectionCard({ disabled = false, }: {\n  disabled?: boolean\n}) {\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { buildSetting: { mainStatKeys }, buildSettingDispatch } = useBuildSetting(characterKey)\n\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\n    {artifactsSlotsToSelectMainStats.map(slotKey =>\n      <MainStatSelectionCardFactory\n        key={slotKey}\n        mainStatKeySlotKey={mainStatKeys[slotKey]}\n        slotKey={slotKey}\n        disabled={disabled}\n        buildSettingDispatch={buildSettingDispatch} />\n    )}\n  </Box >\n}\n\nfunction MainStatSelectionCardFactory({ mainStatKeySlotKey, slotKey, disabled, buildSettingDispatch }: {\n  mainStatKeySlotKey: MainStatKey[]\n  slotKey: typeof artifactsSlotsToSelectMainStats[number]\n  disabled: boolean\n  buildSettingDispatch: (action: BuildSettingReducerAction) => boolean\n}) {\n  const { t } = useTranslation(\"artifact\")\n  const mainStatKeySlotKey_ = useMemoEq(() => mainStatKeySlotKey, arrayEq)\n  const numSel = mainStatKeySlotKey_.length\n  return useMemo(() =>\n    <Box>\n      <Divider />\n      <CardContent sx={{ pt: 1 }}>\n        <Box sx={{ display: \"flex\", gap: 1, alignItems: \"center\", pb: 1 }}>\n          <BootstrapTooltip placement=\"top\" title={<Typography>{t(`slotName.${slotKey}`)}</Typography>}>\n            <span>{artifactSlotIcon(slotKey)}</span>\n          </BootstrapTooltip>\n          <Box flexGrow={1}>\n            <SqBadge color=\"info\">{numSel ? `${numSel} Selected` : `Any`}</SqBadge>\n          </Box>\n          <Button color=\"error\" size=\"small\" disabled={!numSel || disabled} sx={{ mt: -1, mb: -1 }}\n            onClick={() => buildSettingDispatch({ type: \"mainStatKey\", slotKey })}>\n            <Replay />\n          </Button>\n        </Box>\n        <Grid container spacing={1}>\n          {Artifact.slotMainStats(slotKey).map((mainStatKey, i) => {\n            const element = allElementsWithPhy.find(ele => mainStatKey.includes(ele))\n            const color = mainStatKeySlotKey_.includes(mainStatKey)\n              ? element ?? \"success\"\n              : \"secondary\"\n            return <MainStatSelectionCardInnerFactoryAbstractBuilderMethod key={mainStatKey} i={i} slotKey={slotKey} mainStatKey={mainStatKey} color={color} disabled={disabled} buildSettingDispatch={buildSettingDispatch} />\n          })}\n        </Grid>\n      </CardContent>\n    </Box>\n    , [slotKey, t, numSel, disabled, buildSettingDispatch, mainStatKeySlotKey_])\n}\n\nfunction MainStatSelectionCardInnerFactoryAbstractBuilderMethod({ i, slotKey, mainStatKey, color, disabled, buildSettingDispatch }: {\n  i: number,\n  slotKey: typeof artifactsSlotsToSelectMainStats[number]\n  mainStatKey: MainStatKey\n  color: typeof allElementsWithPhy[number] | \"success\" | \"secondary\"\n  disabled: boolean\n  buildSettingDispatch: (action: BuildSettingReducerAction) => boolean\n}) {\n  return useMemo(() => <Grid item flexGrow={1} xs={(i < 3 && slotKey !== \"goblet\") ? 4 : undefined} >\n    <BootstrapTooltip placement=\"top\" title={<Typography><strong><StatColoredWithUnit statKey={mainStatKey} /></strong></Typography>} disableInteractive>\n      <Button fullWidth size=\"small\" color={color} sx={{ fontSize: \"1.2em\", height: \"100%\", pointerEvents: disabled ? \"none\" : undefined, cursor: disabled ? \"none\" : undefined }}\n        onClick={() => buildSettingDispatch({ type: \"mainStatKey\", slotKey, mainStatKey })}>\n        {StatIcon[mainStatKey]}\n      </Button>\n    </BootstrapTooltip>\n  </Grid>, [buildSettingDispatch, color, disabled, i, mainStatKey, slotKey])\n}\n","import { CheckBox, CheckBoxOutlineBlank, DeleteForever } from \"@mui/icons-material\"\nimport { Button, ButtonGroup } from \"@mui/material\"\nimport { useCallback, useContext } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"../../../../../Components/CustomNumberInput\"\nimport { DataContext } from \"../../../../../Context/DataContext\"\nimport { StatFilters, StatFilterSetting } from \"../../../../../Database/DataManagers/BuildSettingData\"\nimport { NodeDisplay } from \"../../../../../Formula/uiData\"\nimport { objPathValue } from \"../../../../../Util/Util\"\nimport OptimizationTargetSelector from \"./OptimizationTargetSelector\"\n\ntype OptimizationTargetEditorListProps = {\n  statFilters: StatFilters\n  setStatFilters: (statFilters: StatFilters) => void\n  disabled: boolean\n}\n\nexport default function OptimizationTargetEditorList({ statFilters, setStatFilters, disabled = false }: OptimizationTargetEditorListProps) {\n  const setTarget = useCallback((path: string[], oldPath?: string[], oldIndex?: number) => {\n    const statFilters_ = { ...statFilters }\n    const oldPathStr = JSON.stringify(oldPath)\n    const oldFilterArr = oldPath ? [...statFilters[oldPathStr]!] : undefined\n    const pathStr = JSON.stringify(path)\n    const filterArr = [...(statFilters[pathStr] ?? [])]\n    // Copy/create new setting\n    if (oldIndex !== undefined && oldFilterArr) filterArr.push(oldFilterArr[oldIndex])\n    else filterArr.push({ value: 0, disabled: false })\n    statFilters_[pathStr] = filterArr\n    // Remove old setting\n    if (oldIndex !== undefined && oldFilterArr) {\n      oldFilterArr.splice(oldIndex, 1)\n      if (!!oldFilterArr.length) statFilters_[oldPathStr] = oldFilterArr\n      else delete statFilters_[oldPathStr]\n    }\n    setStatFilters({ ...statFilters_ })\n  }, [setStatFilters, statFilters])\n\n  const delTarget = useCallback((path: string[], index: number) => {\n    const statFilters_ = { ...statFilters }\n    const pathStr = JSON.stringify(path)\n    const filterArr = [...statFilters[pathStr]!]\n    filterArr.splice(index, 1)\n    if (!!filterArr.length) statFilters_[pathStr] = filterArr\n    else delete statFilters_[pathStr]\n    setStatFilters({ ...statFilters_ })\n  }, [setStatFilters, statFilters])\n\n  const setTargetValue = useCallback((path: string[], index: number, value: number) => {\n    const statFilters_ = { ...statFilters }\n    const pathStr = JSON.stringify(path)\n    const filterArr = [...statFilters[pathStr]!]\n    filterArr[index] = { ...filterArr[index], value } as StatFilterSetting\n    statFilters_[pathStr] = filterArr\n    setStatFilters({ ...statFilters_ })\n  }, [setStatFilters, statFilters])\n\n  const setTargetDisabled = useCallback((path: string[], index: number, disabled: boolean) => {\n    const statFilters_ = { ...statFilters }\n    const pathStr = JSON.stringify(path)\n    const filterArr = [...statFilters[pathStr]!]\n    filterArr[index] = { ...filterArr[index], disabled } as StatFilterSetting\n    statFilters_[pathStr] = filterArr\n    setStatFilters({ ...statFilters_ })\n  }, [setStatFilters, statFilters])\n\n  return <>\n    {Object.entries(statFilters).flatMap(([pathStr, settings]) =>\n      settings?.map((setting, index) =>\n        <OptimizationTargetEditorItem path={JSON.parse(pathStr)} setting={setting} index={index} setTarget={setTarget} delTarget={delTarget} setValue={setTargetValue} setDisabled={setTargetDisabled} disabled={disabled} key={pathStr + index} />\n      )\n    )}\n    <OptimizationTargetEditorItem setTarget={setTarget} delTarget={delTarget} setValue={setTargetValue} setDisabled={setTargetDisabled} disabled={disabled} />\n  </>\n}\n\ntype OptimizationTargetEditorItemProps = {\n  path?: string[]\n  setting?: StatFilterSetting\n  index?: number\n  setTarget: (path: string[], oldPath?: string[], oldIndex?: number) => void\n  delTarget: (path: string[], index: number) => void\n  setValue: (path: string[], index: number, value: number) => void\n  setDisabled: (path: string[], index: number, disabled: boolean) => void\n  disabled: boolean\n}\nfunction OptimizationTargetEditorItem({ path, setting, index, setTarget, delTarget, setValue, setDisabled, disabled }: OptimizationTargetEditorItemProps) {\n  const { t } = useTranslation(\"page_character_optimize\")\n  const { data } = useContext(DataContext)\n  const onChange = useCallback((val: number | undefined) => path && (index !== undefined) && setValue(path, index, val ?? 0), [setValue, path, index])\n  const buttonStyle = { p: 1, flexBasis: 30, flexGrow: 0, flexShrink: 0 }\n\n  const buildConstraintNode: NodeDisplay = objPathValue(data.getDisplay(), path ?? [])\n  const isPercent = buildConstraintNode?.info?.unit === \"%\"\n\n  return <ButtonGroup sx={{ \"& .MuiButtonGroup-grouped\": { minWidth: 24 }, width: \"100%\" }}>\n    {!!setting && !!path && (index !== undefined) && <Button sx={buttonStyle} color={setting.disabled ? \"secondary\" : \"success\"} onClick={() => setDisabled(path, index, !setting.disabled)} disabled={disabled}>\n      {setting.disabled ? <CheckBoxOutlineBlank /> : <CheckBox />}\n    </Button>}\n    <OptimizationTargetSelector showEmptyTargets optimizationTarget={path} setTarget={(target) => setTarget(target, path, index)} defaultText={t(\"targetSelector.selectBuildTarget\")} />\n    <CustomNumberInputButtonGroupWrapper sx={{ flexBasis: 150, flexGrow: 1 }}>\n      <CustomNumberInput\n        float\n        disabled={!path || disabled}\n        value={setting?.value}\n        placeholder=\"Stat Value\"\n        onChange={onChange}\n        sx={{ px: 1, }}\n        inputProps={{ sx: { textAlign: \"right\" } }}\n        endAdornment={isPercent ? \"%\" : undefined}\n      />\n    </CustomNumberInputButtonGroupWrapper>\n    {!!path && (index !== undefined) && <Button sx={buttonStyle} color=\"error\" onClick={() => delTarget(path, index)} disabled={disabled}>\n      <DeleteForever fontSize=\"small\" />\n    </Button>}\n  </ButtonGroup>\n}\n","import { Box, CardContent, Typography } from \"@mui/material\"\nimport { useCallback, useContext } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport CardLight from \"../../../../../Components/Card/CardLight\"\nimport InfoTooltip from \"../../../../../Components/InfoTooltip\"\nimport { CharacterContext } from \"../../../../../Context/CharacterContext\"\nimport { StatFilters } from \"../../../../../Database/DataManagers/BuildSettingData\"\nimport useBuildSetting from \"../useBuildSetting\"\nimport OptimizationTargetEditorList from \"./OptimizationTargetEditorList\"\n\nexport default function StatFilterCard({ disabled = false }: { disabled?: boolean }) {\n  const { t } = useTranslation(\"page_character_optimize\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { buildSetting: { statFilters }, buildSettingDispatch } = useBuildSetting(characterKey)\n  const setStatFilters = useCallback((statFilters: StatFilters) => buildSettingDispatch({ statFilters }), [buildSettingDispatch])\n\n  return <Box>\n    <CardLight>\n      <CardContent sx={{ display: \"flex\", gap: 1, justifyContent: \"space-between\" }}>\n        <Typography>{t`constraintFilter.title`}</Typography>\n        <InfoTooltip title={<Typography>{t`constraintFilter.tooltip`}</Typography>} />\n      </CardContent>\n    </CardLight>\n    <Box display=\"flex\" flexDirection=\"column\" gap={0.5}>\n      <OptimizationTargetEditorList statFilters={statFilters} setStatFilters={setStatFilters} disabled={disabled} />\n    </Box>\n  </Box>\n}\n","import { Add, CheckBox, CheckBoxOutlineBlank, Close, KeyboardArrowDown, KeyboardArrowUp, KeyboardDoubleArrowDown, KeyboardDoubleArrowUp, Replay, Settings } from \"@mui/icons-material\";\nimport { Box, Button, ButtonGroup, CardContent, Divider, Grid, Typography } from \"@mui/material\";\nimport React, { Suspense, useCallback, useContext, useEffect, useMemo, useState } from \"react\";\nimport { Trans, useTranslation } from \"react-i18next\";\nimport ArtifactCardPico from \"../../../../../Components/Artifact/ArtifactCardPico\";\nimport CardDark from \"../../../../../Components/Card/CardDark\";\nimport CardLight from \"../../../../../Components/Card/CardLight\";\nimport CharacterCardPico from \"../../../../../Components/Character/CharacterCardPico\";\nimport CloseButton from \"../../../../../Components/CloseButton\";\nimport CustomNumberInput, { CustomNumberInputButtonGroupWrapper } from \"../../../../../Components/CustomNumberInput\";\nimport ModalWrapper from \"../../../../../Components/ModalWrapper\";\nimport SqBadge from \"../../../../../Components/SqBadge\";\nimport WeaponCardPico from \"../../../../../Components/Weapon/WeaponCardPico\";\nimport { CharacterContext } from \"../../../../../Context/CharacterContext\";\nimport { DatabaseContext } from \"../../../../../Database/Database\";\nimport useBoolState from \"../../../../../ReactHooks/useBoolState\";\nimport useCharacter from \"../../../../../ReactHooks/useCharacter\";\nimport useCharSelectionCallback from \"../../../../../ReactHooks/useCharSelectionCallback\";\nimport { ICachedCharacter } from \"../../../../../Types/character\";\nimport { CharacterKey } from \"../../../../../Types/consts\";\nimport useBuildSetting from \"../useBuildSetting\";\nconst CharacterSelectionModal = React.lazy(() => import('../../../../CharacterSelectionModal'))\n\nexport default function UseEquipped({ disabled = false }: { disabled?: boolean }) {\n  const { t } = useTranslation(\"page_character_optimize\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { buildSetting: { useEquippedArts }, buildSettingDispatch } = useBuildSetting(characterKey)\n  const { database } = useContext(DatabaseContext)\n  const [show, onOpen, onClose] = useBoolState(false)\n  const [{ equipmentPriority: tempEquipmentPriority }, setTO] = useState(database.displayOptimize.get())\n  useEffect(() => database.displayOptimize.follow((r, to) => setTO(to)), [database, setTO])\n  //Basic validate for the equipmentPrio list to remove dups and characters that doesnt exist.\n  const equipmentPriority = useMemo(() => [...new Set(tempEquipmentPriority)].filter(ck => database.chars.get(ck)), [database, tempEquipmentPriority])\n  const setPrio = useCallback((equipmentPriority: CharacterKey[]) => database.displayOptimize.set({ equipmentPriority }), [database])\n\n  const setPrioRank = useCallback((fromIndex, toIndex) => {\n    const arr = [...equipmentPriority]\n    var element = arr[fromIndex];\n    arr.splice(fromIndex, 1);\n    arr.splice(toIndex, 0, element);\n    setPrio(arr)\n  }, [equipmentPriority, setPrio])\n  const removePrio = useCallback((fromIndex) => {\n    const arr = [...equipmentPriority]\n    arr.splice(fromIndex, 1)\n    setPrio(arr)\n  }, [equipmentPriority, setPrio])\n  const addPrio = useCallback((ck: CharacterKey) => setPrio([...equipmentPriority, ck]), [equipmentPriority, setPrio])\n  const resetPrio = useCallback(() => setPrio([]), [setPrio])\n\n  const numAbove = useMemo(() => {\n    let numAbove = equipmentPriority.length\n    const index = equipmentPriority.indexOf(characterKey)\n    if (index >= 0) numAbove = index\n    return numAbove\n  }, [characterKey, equipmentPriority])\n  const numUseEquippedChar = useMemo(() => {\n    return database.chars.keys.length - 1 - numAbove\n  }, [numAbove, database])\n  const numUnlisted = useMemo(() => {\n    return database.chars.keys.length - equipmentPriority.length\n  }, [equipmentPriority, database])\n\n  return <Box display=\"flex\" gap={1}>\n    <ModalWrapper open={show} onClose={onClose} containerProps={{ maxWidth: \"sm\" }}><CardDark>\n      <CardContent>\n        <Grid container spacing={1}>\n          <Grid item flexGrow={1}>\n            <Typography variant=\"h6\">{t`useEquipped.modal.title`}</Typography>\n          </Grid>\n          <Grid item sx={{ mb: -1 }}>\n            <CloseButton onClick={onClose} />\n          </Grid>\n        </Grid>\n      </CardContent>\n      <Divider />\n      <CardContent>\n        <CardLight sx={{ mb: 1 }}>\n          <CardContent>\n            <Typography gutterBottom><Trans t={t} i18nKey=\"useEquipped.modal.desc1\">When generating a build, the Optimizer will only consider equipped artifacts from characters below the current character or those not on the list.</Trans></Typography>\n            <Typography gutterBottom><Trans t={t} i18nKey=\"useEquipped.modal.desc2\">If the current character is not on the list, the Optimizer will only consider equipped artifacts from others characters that are not on the list.</Trans></Typography>\n          </CardContent>\n        </CardLight>\n        <Box display=\"flex\" flexDirection=\"column\" gap={2}>\n          {equipmentPriority.map((ck, i) =>\n            <SelectItem key={ck} characterKey={ck} rank={i + 1} maxRank={equipmentPriority.length} setRank={(num) => num && setPrioRank(i, num - 1)} onRemove={() => removePrio(i)} numAbove={numAbove} />)}\n          <Box sx={{ display: \"flex\", gap: 1 }}>\n            <NewItem onAdd={addPrio} list={equipmentPriority} />\n            <Button color=\"error\" onClick={resetPrio} startIcon={<Replay />}><Trans t={t} i18nKey=\"useEquipped.modal.clearList\">Clear List</Trans></Button>\n          </Box>\n          {!!numUseEquippedChar && <SqBadge color=\"success\"><Typography><Trans t={t} i18nKey=\"useEquipped.modal.usingNum\" count={numUnlisted}>Using artifacts from <strong>{{ count: numUnlisted }}</strong> unlisted characters</Trans></Typography></SqBadge>}\n        </Box>\n      </CardContent>\n    </CardDark ></ModalWrapper>\n    <ButtonGroup sx={{ display: \"flex\", width: \"100%\" }}>\n      <Button sx={{ flexGrow: 1 }} onClick={() => buildSettingDispatch({ useEquippedArts: !useEquippedArts })} disabled={disabled} startIcon={useEquippedArts ? <CheckBox /> : <CheckBoxOutlineBlank />} color={useEquippedArts ? \"success\" : \"secondary\"}>\n        <Box>\n          <span><Trans t={t} i18nKey=\"useEquipped.title\">Use Equipped Artifacts</Trans></span>\n          {useEquippedArts && <SqBadge><Trans t={t} i18nKey=\"useEquipped.usingNum\" count={numUseEquippedChar}>Using from <strong>{{ count: numUseEquippedChar }}</strong> characters</Trans></SqBadge>}\n        </Box>\n      </Button>\n      {useEquippedArts && <Button sx={{ flexShrink: 1 }} color=\"info\" onClick={onOpen} disabled={disabled}><Settings /></Button>}\n    </ButtonGroup>\n  </Box>\n}\n\nconst itemSize = 60\nfunction SelectItem({ characterKey, rank, maxRank, setRank, onRemove, numAbove }: {\n  characterKey: CharacterKey,\n  rank: number,\n  maxRank: number,\n  setRank: (r: number | undefined) => void,\n  onRemove: () => void,\n  numAbove: number,\n}) {\n  const { t } = useTranslation(\"page_character_optimize\")\n  const { database } = useContext(DatabaseContext)\n  const character = useCharacter(characterKey)\n  const onClick = useCharSelectionCallback()\n  if (!character) return null\n  const { equippedWeapon, equippedArtifacts } = character\n  return <CardLight sx={{ p: 1 }}  >\n    <Box sx={{ pb: 1, display: \"flex\", justifyContent: \"space-between\", gap: 1 }}>\n      <SqBadge color=\"info\">\n        <Typography>#{rank}</Typography>\n      </SqBadge>\n      <SqBadge sx={{ flexGrow: 1 }} color={numAbove === (rank - 1) ? \"warning\" : (rank - 1) < numAbove ? \"error\" : \"success\"}>\n        <Typography>{numAbove === (rank - 1) ? <Trans t={t} i18nKey=\"useEquipped.modal.status.curr\">Current character</Trans>\n          : (rank - 1) < numAbove ? <Trans t={t} i18nKey=\"useEquipped.modal.status.dont\">Don't Use artifacts</Trans> :\n            <Trans t={t} i18nKey=\"useEquipped.modal.status.use\">Use artifacts</Trans>}</Typography>\n      </SqBadge>\n      <Box>\n        <ButtonGroup sx={{ flexGrow: 1 }} size=\"small\">\n          <CustomNumberInputButtonGroupWrapper >\n            <CustomNumberInput onChange={setRank} value={rank}\n              // startAdornment=\"Rank:\"\n              inputProps={{ min: 1, max: maxRank, sx: { textAlign: \"center\" } }}\n              sx={{ width: \"100%\", height: \"100%\", pl: 2 }} />\n          </CustomNumberInputButtonGroupWrapper>\n          <Button disabled={rank === 1} onClick={() => setRank(1)} >\n            <KeyboardDoubleArrowUp />\n          </Button>\n          <Button disabled={rank === 1} onClick={() => setRank(rank - 1)}  >\n            <KeyboardArrowUp />\n          </Button>\n          <Button disabled={rank === maxRank} onClick={() => setRank(rank + 1)}  >\n            <KeyboardArrowDown />\n          </Button>\n          <Button disabled={rank === maxRank} onClick={() => setRank(maxRank)}  >\n            <KeyboardDoubleArrowDown />\n          </Button>\n          <Button color=\"error\" onClick={onRemove}>\n            <Close />\n          </Button>\n        </ButtonGroup>\n      </Box>\n    </Box>\n    <Grid container columns={7} spacing={1}>\n      <Grid item xs={1} >\n        <CharacterCardPico characterKey={characterKey} onClick={onClick} />\n      </Grid>\n      <Grid item xs={1}><WeaponCardPico weaponId={equippedWeapon} /></Grid>\n      {Object.entries(equippedArtifacts).map(([slotKey, aId]) => <Grid item xs={1} key={slotKey} ><ArtifactCardPico slotKey={slotKey} artifactObj={database.arts.get(aId)} /></Grid>)}\n    </Grid>\n\n  </CardLight>\n}\nfunction NewItem({ onAdd, list }: { onAdd: (ck: CharacterKey) => void, list: CharacterKey[] }) {\n  const { t } = useTranslation(\"page_character_optimize\")\n  const [show, onOpen, onClose] = useBoolState(false)\n  const filter = useCallback((char?: ICachedCharacter) => {\n    if (!char) return false\n    return !list.includes(char.key)\n  }, [list])\n  return <>\n    <Suspense fallback={false}>\n      <CharacterSelectionModal show={show} onHide={onClose} onSelect={onAdd} filter={filter} />\n    </Suspense>\n    <Button fullWidth sx={{ height: itemSize }} color=\"info\" onClick={onOpen} startIcon={<Add />} >\n      <Trans t={t} i18nKey=\"useEquipped.modal.add\">Add character to list</Trans>\n    </Button>\n  </>\n}\n","import { CheckBox, CheckBoxOutlineBlank } from \"@mui/icons-material\";\nimport { Box, Button } from \"@mui/material\";\nimport { useContext, useMemo } from \"react\";\nimport { Trans, useTranslation } from \"react-i18next\";\nimport { CharacterContext } from \"../../../../../Context/CharacterContext\";\nimport SqBadge from \"../../../../../Components/SqBadge\";\nimport { DatabaseContext } from \"../../../../../Database/Database\";\nimport useBuildSetting from \"../useBuildSetting\";\n\nexport default function UseExcluded({ disabled = false, artsDirty }: { disabled?: boolean, artsDirty: object }) {\n  const { t } = useTranslation(\"page_character_optimize\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { buildSetting: { useExcludedArts }, buildSettingDispatch } = useBuildSetting(characterKey)\n  const { database } = useContext(DatabaseContext)\n  const numExcludedArt = useMemo(() => artsDirty && database.arts.values.reduce((a, art) => a + ((art.exclude && art.location !== characterKey) ? 1 : 0), 0), [database, artsDirty, characterKey])\n  return <Button fullWidth onClick={() => buildSettingDispatch({ useExcludedArts: !useExcludedArts })} disabled={!numExcludedArt || disabled} startIcon={useExcludedArts ? <CheckBox /> : <CheckBoxOutlineBlank />} color={useExcludedArts ? \"success\" : \"secondary\"}>\n    <Box>\n      <span><Trans t={t} i18nKey=\"useExcluded.title\" count={numExcludedArt}>Use Excluded Artifacts</Trans></span>\n      {useExcludedArts && <SqBadge><Trans t={t} i18nKey=\"useExcluded.usingNum\" count={numExcludedArt}>Using <strong>{{ count: numExcludedArt }}</strong> excluded artifacts</Trans></SqBadge>}\n    </Box>\n  </Button>\n}\n","import Artifact from \"../../../../Data/Artifacts/Artifact\";\nimport { input } from \"../../../../Formula\";\nimport { computeUIData } from \"../../../../Formula/api\";\nimport { formulaString } from \"../../../../Formula/debug\";\nimport { Data, NumNode } from \"../../../../Formula/type\";\nimport { constant, setReadNodeKeys } from \"../../../../Formula/utils\";\nimport { allMainStatKeys, allSubstatKeys, ICachedArtifact } from \"../../../../Types/artifact\";\nimport { deepClone, objectKeyMap, objectMap } from \"../../../../Util/Util\";\nimport type { ArtifactBuildData, ArtifactsBySlot, DynStat } from \"./common\";\n\nconst dynamic = setReadNodeKeys(deepClone({ dyn: { ...input.art, ...input.artSet } }))\nexport const dynamicData = {\n  art: objectKeyMap([...allMainStatKeys, ...allSubstatKeys], key => dynamic.dyn[key]),\n  artSet: objectMap(input.artSet, (_, key) => dynamic.dyn[key]),\n}\n\nexport function compactArtifacts(arts: ICachedArtifact[], mainStatAssumptionLevel: number, allowPartial: boolean): ArtifactsBySlot {\n  const result: ArtifactsBySlot = {\n    base: {},\n    values: { flower: [], plume: [], goblet: [], circlet: [], sands: [] }\n  }\n  const keys = new Set<string>()\n\n  for (const art of arts) {\n    const mainStatVal = Artifact.mainStatValue(art.mainStatKey, art.rarity, Math.max(Math.min(mainStatAssumptionLevel, art.rarity * 4), art.level))\n\n    const data: ArtifactBuildData = {\n      id: art.id, set: art.setKey,\n      values: {\n        [art.setKey]: 1,\n        [art.mainStatKey]: art.mainStatKey.endsWith('_') ? mainStatVal / 100 : mainStatVal,\n        ...Object.fromEntries(art.substats.map(substat =>\n          [substat.key, substat.key.endsWith('_') ? substat.accurateValue / 100 : substat.accurateValue]))\n      },\n    }\n    delete data.values[\"\"]\n    result.values[art.slotKey].push(data)\n    Object.keys(data.values).forEach(x => keys.add(x))\n  }\n  result.base = objectKeyMap([...keys], _ => 0)\n  if (allowPartial)\n    for (const value of Object.values(result.values))\n      value.push({ id: \"\", values: {} })\n  return result\n}\n\nexport function debugCompute(nodes: NumNode[], base: DynStat, arts: ArtifactBuildData[]) {\n  const stats = { ...base }\n  for (const art of arts) {\n    for (const [key, value] of Object.entries(art.values)) {\n      stats[key] = (stats[key] ?? 0) + value\n    }\n  }\n  const data = { dyn: Object.fromEntries(Object.entries(stats).map(([key, value]) => [key, constant(value)])) } as Data\n  const uiData = computeUIData([data])\n  return {\n    base, arts, stats,\n    data, uiData,\n    nodes: nodes.map(formulaString),\n    results: nodes.map(node => uiData.get(node)),\n  }\n}\n","import { CheckBox, CheckBoxOutlineBlank, Close, DeleteForever, Science, TrendingUp } from '@mui/icons-material';\nimport { Alert, Box, Button, ButtonGroup, CardContent, Divider, Grid, Link, MenuItem, Skeleton, ToggleButton, Typography } from '@mui/material';\nimport React, { Suspense, useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { Trans, useTranslation } from 'react-i18next';\nimport { Link as RouterLink, useLocation, useNavigate } from 'react-router-dom';\nimport ArtifactLevelSlider from '../../../../Components/Artifact/ArtifactLevelSlider';\nimport BootstrapTooltip from '../../../../Components/BootstrapTooltip';\nimport CardLight from '../../../../Components/Card/CardLight';\nimport CharacterCard from '../../../../Components/Character/CharacterCard';\nimport DropdownButton from '../../../../Components/DropdownMenu/DropdownButton';\nimport { HitModeToggle, ReactionToggle } from '../../../../Components/HitModeEditor';\nimport SolidToggleButtonGroup from '../../../../Components/SolidToggleButtonGroup';\nimport { CharacterContext } from '../../../../Context/CharacterContext';\nimport { DataContext, dataContextObj } from '../../../../Context/DataContext';\nimport { GraphContext } from '../../../../Context/GraphContext';\nimport { OptimizationTargetContext } from '../../../../Context/OptimizationTargetContext';\nimport { DatabaseContext } from '../../../../Database/Database';\nimport { defThreads } from '../../../../Database/DataEntries/DisplayOptimizeEntry';\nimport { mergeData, uiDataForTeam } from '../../../../Formula/api';\nimport { optimize } from '../../../../Formula/optimization';\nimport { NumNode } from '../../../../Formula/type';\nimport { UIData } from '../../../../Formula/uiData';\nimport useCharacterReducer from '../../../../ReactHooks/useCharacterReducer';\nimport useCharSelectionCallback from '../../../../ReactHooks/useCharSelectionCallback';\nimport useForceUpdate from '../../../../ReactHooks/useForceUpdate';\nimport useMediaQueryUp from '../../../../ReactHooks/useMediaQueryUp';\nimport useTeamData, { getTeamData } from '../../../../ReactHooks/useTeamData';\nimport { CharacterKey, charKeyToLocCharKey, LocationCharacterKey } from '../../../../Types/consts';\nimport { objPathValue, range } from '../../../../Util/Util';\nimport { FinalizeResult, Setup, WorkerCommand, WorkerResult } from './BackgroundWorker';\nimport { maxBuildsToShowList } from './Build';\nimport { artSetPerm, Build, filterFeasiblePerm, mergeBuilds, mergePlot, pruneAll, pruneExclusion, RequestFilter } from './common';\nimport ArtifactSetConfig from './Components/ArtifactSetConfig';\nimport AssumeFullLevelToggle from './Components/AssumeFullLevelToggle';\nimport BonusStatsCard from './Components/BonusStatsCard';\nimport BuildAlert, { BuildStatus } from './Components/BuildAlert';\nimport BuildDisplayItem from './Components/BuildDisplayItem';\nimport ChartCard from './Components/ChartCard';\nimport MainStatSelectionCard from './Components/MainStatSelectionCard';\nimport OptimizationTargetSelector from './Components/OptimizationTargetSelector';\nimport StatFilterCard from './Components/StatFilterCard';\nimport UseEquipped from './Components/UseEquipped';\nimport UseExcluded from './Components/UseExcluded';\nimport { compactArtifacts, dynamicData } from './foreground';\nimport useBuildResult from './useBuildResult';\nimport useBuildSetting from './useBuildSetting';\n\nexport function useMemoEq<T>(factory: () => T, eq: (prev: T, next: T) => boolean): T {\n  const next = factory()\n  const ref = useRef(next)\n  if (!eq(ref.current, next)) {\n    ref.current = next\n  }\n  return ref.current\n}\nexport const arrayEq = <T extends unknown>(a: T[], b: T[]): boolean => a.length === b.length && a.every((x, i) => b[i] === x)\n\nexport default function TabBuild() {\n  const { t } = useTranslation(\"page_character_optimize\")\n  const { character: { key: characterKey, compareData } } = useContext(CharacterContext)\n  const { database } = useContext(DatabaseContext)\n  const { setChartData, graphBuilds, setGraphBuilds } = useContext(GraphContext)\n\n  const [buildStatus, setBuildStatus] = useState({ type: \"inactive\", tested: 0, failed: 0, skipped: 0, total: 0 } as BuildStatus)\n  const generatingBuilds = buildStatus.type !== \"inactive\"\n\n  const [artsDirty, setArtsDirty] = useForceUpdate()\n\n  const [{ equipmentPriority, threads = defThreads }, setDisplayOptimize] = useState(database.displayOptimize.get())\n  useEffect(() => database.displayOptimize.follow((r, to) => setDisplayOptimize(to)), [database, setDisplayOptimize])\n\n  const maxWorkers = threads > defThreads ? defThreads : threads\n  const setMaxWorkers = useCallback(threads => database.displayOptimize.set({ threads }), [database],)\n\n  const characterDispatch = useCharacterReducer(characterKey)\n  const onClickTeammate = useCharSelectionCallback()\n\n  // Clear state when changing characters\n  useEffect(() => {\n    setBuildStatus({ type: \"inactive\", tested: 0, failed: 0, skipped: 0, total: 0 })\n  }, [characterKey])\n\n  const noArtifact = useMemo(() => !database.arts.values.length, [database])\n\n  const { buildSetting, buildSettingDispatch } = useBuildSetting(characterKey)\n  const { mainStatAssumptionLevel, allowPartial, maxBuildsToShow, levelLow, levelHigh } = buildSetting\n  const plotBase = useMemoEq(() => buildSetting.plotBase, (a, b) => !!(a && b && arrayEq(a, b)))\n  const optimizationTarget = useMemoEq(() => buildSetting.optimizationTarget, (a, b) => !!(a && b && arrayEq(a, b)))\n  const { buildResult: { builds, buildDate }, buildResultDispatch } = useBuildResult(characterKey)\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel)\n  const { characterSheet, target: data } = teamData?.[characterKey as CharacterKey] ?? {}\n  const optimizationTargetNode = optimizationTarget && objPathValue(data?.getDisplay(), optimizationTarget)\n  const isSM = [\"xs\", \"sm\"].includes(useMediaQueryUp())\n\n  //register changes in artifact database\n  useEffect(() =>\n    database.arts.followAny(setArtsDirty),\n    [setArtsDirty, database])\n\n  // Provides a function to cancel the work\n  const cancelToken = useRef(() => { })\n  //terminate worker when component unmounts\n  useEffect(() => () => cancelToken.current(), [])\n  const generateBuilds = useCallback(async () => {\n    const { artSetExclusion, plotBase, statFilters, mainStatKeys, optimizationTarget, mainStatAssumptionLevel, useExcludedArts, useEquippedArts, allowPartial, maxBuildsToShow, levelLow, levelHigh } = buildSetting\n    if (!characterKey || !optimizationTarget) return\n\n    let cantTakeList: Set<LocationCharacterKey> = new Set()\n    if (useEquippedArts) {\n      const index = equipmentPriority.indexOf(characterKey)\n      if (index < 0) equipmentPriority.forEach(ek => cantTakeList.add(charKeyToLocCharKey(ek)))\n      else equipmentPriority.slice(0, index).forEach(ek => cantTakeList.add(charKeyToLocCharKey(ek)))\n    }\n    const filteredArts = database.arts.values.filter(art => {\n      if (art.level < levelLow) return false\n      if (art.level > levelHigh) return false\n      const mainStats = mainStatKeys[art.slotKey]\n      if (mainStats?.length && !mainStats.includes(art.mainStatKey)) return false\n\n      // If its equipped on the selected character, bypass the check\n      if (art.location === charKeyToLocCharKey(characterKey)) return true\n\n      if (art.exclude && !useExcludedArts) return false\n      if (art.location && !useEquippedArts) return false\n      if (art.location && useEquippedArts && cantTakeList.has(art.location)) return false\n      return true\n    })\n    const split = compactArtifacts(filteredArts, mainStatAssumptionLevel, allowPartial)\n\n    const teamData = await getTeamData(database, characterKey, mainStatAssumptionLevel, [])\n    if (!teamData) return\n    const workerData = uiDataForTeam(teamData.teamData, characterKey)[characterKey as CharacterKey]?.target.data![0]\n    if (!workerData) return\n    Object.assign(workerData, mergeData([workerData, dynamicData])) // Mark art fields as dynamic\n    let unoptimizedOptimizationTargetNode = objPathValue(workerData.display ?? {}, optimizationTarget) as NumNode | undefined\n    if (!unoptimizedOptimizationTargetNode) return\n    const targetNode = unoptimizedOptimizationTargetNode\n    const valueFilter: { value: NumNode, minimum: number }[] = Object.entries(statFilters)\n      .flatMap(([pathStr, settings]) =>\n        settings\n          .filter(setting => !setting.disabled)\n          .map(setting => {\n            const filterNode: NumNode = objPathValue(workerData.display ?? {}, JSON.parse(pathStr))\n            const minimum = filterNode.info?.unit === \"%\" ? setting.value / 100 : setting.value // TODO: Conversion\n            return { value: filterNode, minimum: minimum }\n          })\n      )\n      .filter(x => x.value && x.minimum > -Infinity)\n\n    setChartData(undefined)\n\n    const cancelled = new Promise<void>(r => cancelToken.current = r)\n\n    let unoptimizedNodes = [...valueFilter.map(x => x.value), unoptimizedOptimizationTargetNode], arts = split!\n    const setPerms = filterFeasiblePerm(artSetPerm(artSetExclusion, Object.values(split.values).flatMap(x => x.map(x => x.set!))), split)\n\n    const minimum = [...valueFilter.map(x => x.minimum), -Infinity]\n    const status: Omit<BuildStatus, \"type\"> = { tested: 0, failed: 0, skipped: 0, total: NaN, startTime: performance.now() }\n    const plotBaseNumNode: NumNode = plotBase && objPathValue(workerData.display ?? {}, plotBase)\n    if (plotBaseNumNode) {\n      unoptimizedNodes.push(plotBaseNumNode)\n      minimum.push(-Infinity)\n    }\n\n    const prepruneArts = arts\n    let nodes = optimize(unoptimizedNodes, workerData, ({ path: [p] }) => p !== \"dyn\")\n    nodes = pruneExclusion(nodes, artSetExclusion);\n    ({ nodes, arts } = pruneAll(nodes, minimum, arts, maxBuildsToShow, artSetExclusion, {\n      reaffine: true, pruneArtRange: true, pruneNodeRange: true, pruneOrder: true\n    }))\n    nodes = optimize(nodes, {}, _ => false)\n\n    const plotBaseNode = plotBaseNumNode ? nodes.pop() : undefined\n    let optimizationTargetNode = nodes.pop()!\n\n    const wrap = { buildValues: Array(maxBuildsToShow).fill(0).map(_ => ({ src: \"\", val: -Infinity })) }\n\n    const minFilterCount = 16_000_000, maxRequestFilterInFlight = maxWorkers * 16\n    const unprunedFilters = setPerms[Symbol.iterator](), requestFilters: RequestFilter[] = []\n    const idleWorkers: number[] = [], splittingWorkers = new Set<number>()\n    const workers: Worker[] = []\n\n    function getThreshold(): number {\n      return wrap.buildValues[maxBuildsToShow - 1].val\n    }\n    function fetchContinueWork(): WorkerCommand {\n      return { command: \"split\", filter: undefined, minCount: minFilterCount, threshold: getThreshold() }\n    }\n    function fetchPruningWork(): WorkerCommand | undefined {\n      const { done, value } = unprunedFilters.next()\n      return done ? undefined : {\n        command: \"split\", minCount: minFilterCount,\n        threshold: getThreshold(), filter: value,\n      }\n    }\n    function fetchRequestWork(): WorkerCommand | undefined {\n      const filter = requestFilters.pop()\n      return !filter ? undefined : {\n        command: \"iterate\",\n        threshold: getThreshold(), filter\n      }\n    }\n\n    const filters = nodes\n      .map((value, i) => ({ value, min: minimum[i] }))\n      .filter(x => x.min > -Infinity)\n\n    const finalizedList: Promise<FinalizeResult>[] = []\n    for (let i = 0; i < maxWorkers; i++) {\n      const worker = new Worker(new URL('./BackgroundWorker.ts', import.meta.url))\n\n      const setup: Setup = {\n        command: \"setup\",\n        id: i, arts,\n        optimizationTarget: optimizationTargetNode,\n        plotBase: plotBaseNode,\n        maxBuilds: maxBuildsToShow,\n        filters\n      }\n      worker.postMessage(setup, undefined)\n      if (i === 0) {\n        const countCommand: WorkerCommand = { command: \"count\", exclusion: artSetExclusion, arts: [arts, prepruneArts] }\n        worker.postMessage(countCommand, undefined)\n      }\n      let finalize: (_: FinalizeResult) => void\n      const finalized = new Promise<FinalizeResult>(r => finalize = r)\n      worker.onmessage = async ({ data }: { data: { id: number } & WorkerResult }) => {\n        switch (data.command) {\n          case \"interim\":\n            status.tested += data.tested\n            status.failed += data.failed\n            status.skipped += data.skipped\n            if (data.buildValues) {\n              wrap.buildValues = wrap.buildValues.filter(({ src }) => src !== data.source)\n              wrap.buildValues.push(...data.buildValues.map(val => ({ src: data.source, val })))\n              wrap.buildValues.sort((a, b) => b.val - a.val).splice(maxBuildsToShow)\n            }\n            break\n          case \"split\":\n            if (data.filter) {\n              requestFilters.push(data.filter)\n              splittingWorkers.add(data.id)\n            } else splittingWorkers.delete(data.id)\n            idleWorkers.push(data.id)\n            break\n          case \"iterate\":\n            idleWorkers.push(data.id)\n            break\n          case \"finalize\":\n            worker.terminate()\n            finalize(data);\n            return\n          case \"count\":\n            const [pruned, prepruned] = data.counts\n            status.total = prepruned\n            status.skipped += prepruned - pruned\n            return\n          default: console.log(\"DEBUG\", data)\n        }\n        while (idleWorkers.length) {\n          const id = idleWorkers.pop()!, worker = workers[id]\n          let work: WorkerCommand | undefined\n          if (requestFilters.length < maxRequestFilterInFlight) {\n            work = fetchPruningWork()\n            if (!work && splittingWorkers.has(id)) work = fetchContinueWork()\n          }\n          if (!work) work = fetchRequestWork()\n          if (work) worker.postMessage(work)\n          else {\n            idleWorkers.push(id)\n            if (idleWorkers.length === 4 * maxWorkers) {\n              const command: WorkerCommand = { command: \"finalize\" }\n              workers.forEach(worker => worker.postMessage(command))\n            }\n            break\n          }\n        }\n      }\n\n      workers.push(worker)\n      cancelled.then(() => worker.terminate())\n      finalizedList.push(finalized)\n    }\n    for (let i = 0; i < 3; i++)\n      idleWorkers.push(...range(0, maxWorkers - 1))\n\n    const buildTimer = setInterval(() => setBuildStatus({ type: \"active\", ...status }), 100)\n    const results = await Promise.any([Promise.all(finalizedList), cancelled])\n    clearInterval(buildTimer)\n    cancelToken.current = () => { }\n\n    if (!results) {\n      status.tested = 0\n      status.failed = 0\n      status.skipped = 0\n      status.total = 0\n    } else {\n      if (plotBaseNumNode) {\n        const plotData = mergePlot(results.map(x => x.plotData!))\n        let data = Object.values(plotData)\n        if (targetNode.info?.unit === \"%\")\n          data = data.map(({ value, plot, artifactIds }) => ({ value: value * 100, plot, artifactIds })) as Build[]\n        if (plotBaseNumNode.info?.unit === \"%\")\n          data = data.map(({ value, plot, artifactIds }) => ({ value, plot: (plot ?? 0) * 100, artifactIds })) as Build[]\n        setChartData({\n          valueNode: targetNode,\n          plotNode: plotBaseNumNode,\n          data\n        })\n      }\n      const builds = mergeBuilds(results.map(x => x.builds), maxBuildsToShow)\n      if (process.env.NODE_ENV === \"development\") console.log(\"Build Result\", builds)\n      buildResultDispatch({ builds: builds.map(build => build.artifactIds), buildDate: Date.now() })\n    }\n    setBuildStatus({ ...status, type: \"inactive\", finishTime: performance.now() })\n  }, [characterKey, database, buildResultDispatch, maxWorkers, buildSetting, equipmentPriority, setChartData])\n\n  const characterName = characterSheet?.name ?? \"Character Name\"\n\n  const setPlotBase = useCallback(plotBase => {\n    buildSettingDispatch({ plotBase })\n    setChartData(undefined)\n  }, [buildSettingDispatch, setChartData])\n  const dataContext: dataContextObj | undefined = useMemo(() => {\n    return data && teamData && { data, teamData }\n  }, [data, teamData])\n\n  const targetSelector = useMemo(() => <OptimizationTargetSelector\n    optimizationTarget={optimizationTarget}\n    setTarget={target => buildSettingDispatch({ optimizationTarget: target })}\n    disabled={generatingBuilds}\n  />, [buildSettingDispatch, generatingBuilds, optimizationTarget])\n\n  const clownEmoji = useMemo(() => <Grid container spacing={1} >\n    {/* 1*/}\n    <Grid item xs={12} sm={6} lg={3} display=\"flex\" flexDirection=\"column\" gap={1}>\n      {/* character card */}\n      <Box><CharacterCard characterKey={characterKey} onClickTeammate={onClickTeammate} /></Box>\n    </Grid>\n\n    {/* 2 */}\n    <Grid item xs={12} sm={6} lg={3} display=\"flex\" flexDirection=\"column\" gap={1}>\n      <CardLight>\n        <CardContent  >\n          <Typography gutterBottom>{t`mainStat.title`}</Typography>\n          <BootstrapTooltip placement=\"top\" title={<Box>\n            <Typography variant=\"h6\">{t`mainStat.levelAssTooltip.title`}</Typography>\n            <Typography>{t`mainStat.levelAssTooltip.desc`}</Typography>\n          </Box>}>\n            <Box>\n              <AssumeFullLevelToggle mainStatAssumptionLevel={mainStatAssumptionLevel} setmainStatAssumptionLevel={mainStatAssumptionLevel => buildSettingDispatch({ mainStatAssumptionLevel })} disabled={generatingBuilds} />\n            </Box>\n          </BootstrapTooltip>\n        </CardContent>\n        {/* main stat selector */}\n        <MainStatSelectionCard disabled={generatingBuilds} />\n      </CardLight>\n      <BonusStatsCard />\n    </Grid>\n\n    {/* 3 */}\n    <Grid item xs={12} sm={6} lg={6} display=\"flex\" flexDirection=\"column\" gap={1}>\n      <ArtifactSetConfig disabled={generatingBuilds} />\n\n      {/* use excluded */}\n      <UseExcluded disabled={generatingBuilds} artsDirty={artsDirty} />\n\n      {/* use equipped */}\n      <UseEquipped disabled={generatingBuilds} />\n\n      <Button\n        fullWidth\n        startIcon={allowPartial ? <CheckBox /> : <CheckBoxOutlineBlank />}\n        color={allowPartial ? \"success\" : \"secondary\"}\n        onClick={() => buildSettingDispatch({ allowPartial: !allowPartial })}\n        disabled={generatingBuilds}\n      >\n        {t`allowPartial`}\n      </Button>\n      { /* Level Filter */}\n      <CardLight>\n        <CardContent>{t`levelFilter`}</CardContent>\n        <ArtifactLevelSlider levelLow={levelLow} levelHigh={levelHigh}\n          setLow={levelLow => buildSettingDispatch({ levelLow })}\n          setHigh={levelHigh => buildSettingDispatch({ levelHigh })}\n          setBoth={(levelLow, levelHigh) => buildSettingDispatch({ levelLow, levelHigh })}\n          disabled={generatingBuilds}\n        />\n      </CardLight>\n\n      {/*Minimum Final Stat Filter */}\n      <StatFilterCard disabled={generatingBuilds} />\n\n    </Grid>\n  </Grid>, [allowPartial, artsDirty, buildSettingDispatch, characterKey, generatingBuilds, levelHigh, levelLow, mainStatAssumptionLevel, onClickTeammate, t])\n  const selector0 = useMemo(() => <DropdownButton disabled={generatingBuilds || !characterKey}\n    title={<Trans t={t} i18nKey=\"build\" count={maxBuildsToShow}>\n      {{ count: maxBuildsToShow }} Builds\n    </Trans>}>\n    <MenuItem>\n      <Typography variant=\"caption\" color=\"info.main\">\n        {t(\"buildDropdownDesc\")}\n      </Typography>\n    </MenuItem>\n    <Divider />\n    {maxBuildsToShowList.map(v => <MenuItem key={v}\n      onClick={() => buildSettingDispatch({ maxBuildsToShow: v })}>\n      <Trans t={t} i18nKey=\"build\" count={v}>\n        {{ count: v }} Builds\n      </Trans>\n    </MenuItem>)}\n  </DropdownButton>, [buildSettingDispatch, characterKey, generatingBuilds, maxBuildsToShow, t])\n  const selector1 = useMemo(() => <DropdownButton disabled={generatingBuilds || !characterKey}\n    sx={{ borderRadius: \"4px 0px 0px 4px\" }}\n    title={<Trans t={t} i18nKey=\"thread\" count={maxWorkers}>\n      {{ count: maxWorkers }} Threads\n    </Trans>}>\n    <MenuItem>\n      <Typography variant=\"caption\" color=\"info.main\">\n        {t(\"threadDropdownDesc\")}\n      </Typography>\n    </MenuItem>\n    <Divider />\n    {range(1, defThreads).reverse().map(v => <MenuItem key={v}\n      onClick={() => setMaxWorkers(v)}>\n      <Trans t={t} i18nKey=\"thread\" count={v}>\n        {{ count: v }} Threads\n      </Trans>\n    </MenuItem>)}\n  </DropdownButton>, [characterKey, generatingBuilds, maxWorkers, setMaxWorkers, t])\n\n  const selector = useMemo(() => <ButtonGroup>\n    {!isSM && targetSelector}\n    {selector0}\n    {selector1}\n    <BootstrapTooltip placement=\"top\" title={!optimizationTarget ? t(\"selectTargetFirst\") : \"\"}>\n      <span>\n        <Button\n          disabled={!characterKey || !optimizationTarget || !optimizationTargetNode || optimizationTargetNode.isEmpty}\n          color={generatingBuilds ? \"error\" : \"success\"}\n          onClick={generatingBuilds ? () => cancelToken.current() : generateBuilds}\n          startIcon={generatingBuilds ? <Close /> : <TrendingUp />}\n          sx={{ borderRadius: \"0px 4px 4px 0px\" }}\n        >{generatingBuilds ? t(\"generateButton.cancel\") : t(\"generateButton.generateBuilds\")}</Button>\n      </span>\n    </BootstrapTooltip>\n  </ButtonGroup>, [characterKey, generateBuilds, generatingBuilds, isSM, optimizationTarget, optimizationTargetNode, selector0, selector1, t, targetSelector])\n  const target = useMemo(() => <Box >\n    <ChartCard disabled={generatingBuilds || !optimizationTarget} plotBase={plotBase} setPlotBase={setPlotBase} showTooltip={!optimizationTarget} graphBuilds={graphBuilds} setGraphBuilds={setGraphBuilds} />\n  </Box>, [generatingBuilds, graphBuilds, optimizationTarget, plotBase, setGraphBuilds, setPlotBase])\n  const card = useMemo(() => <CardLight>\n    <CardContent>\n      <Box display=\"flex\" alignItems=\"center\" gap={1} mb={1} >\n        <Typography sx={{ flexGrow: 1 }}>\n          {builds ? <span>Showing <strong>{builds.length + (graphBuilds ? graphBuilds.length : 0)}</strong> build generated for {characterName}. {!!buildDate && <span>Build generated on: <strong>{(new Date(buildDate)).toLocaleString()}</strong></span>}</span>\n            : <span>Select a character to generate builds.</span>}\n        </Typography>\n        <Button disabled={!builds.length} color=\"error\" onClick={() => { setGraphBuilds(undefined); buildResultDispatch({ builds: [], buildDate: 0 }) }} >Clear Builds</Button>\n      </Box>\n      <Grid container display=\"flex\" spacing={1}>\n        <Grid item><HitModeToggle size=\"small\" /></Grid>\n        <Grid item><ReactionToggle size=\"small\" /></Grid>\n        <Grid item flexGrow={1} />\n        <Grid item><SolidToggleButtonGroup exclusive value={compareData} onChange={(_e, v) => characterDispatch({ compareData: v })} size=\"small\">\n          <ToggleButton value={false} disabled={!compareData}>Show new builds</ToggleButton>\n          <ToggleButton value={true} disabled={compareData}>Compare vs. equipped</ToggleButton>\n        </SolidToggleButtonGroup></Grid>\n      </Grid>\n    </CardContent>\n  </CardLight>, [buildDate, buildResultDispatch, builds, characterDispatch, characterName, compareData, graphBuilds, setGraphBuilds])\n  const getLabel0 = useCallback((index) => <Trans t={t} i18nKey=\"graphBuildLabel\" count={index + 1}>Graph #{{ count: index + 1 }}</Trans>, [t])\n  const getLabel1 = useCallback((index) => `#${index + 1}`, [])\n  const bl = useMemo(() =>\n    <>\n      {graphBuilds && <BuildList builds={graphBuilds} characterKey={characterKey} data={data} compareData={compareData} disabled={!!generatingBuilds} getLabel={getLabel0} setBuilds={setGraphBuilds} />}\n      <BuildList builds={builds} characterKey={characterKey} data={data} compareData={compareData} disabled={!!generatingBuilds} getLabel={getLabel1} />\n    </>\n    , [builds, characterKey, compareData, data, generatingBuilds, getLabel0, getLabel1, graphBuilds, setGraphBuilds])\n  const ccc = useMemo(() => <OptimizationTargetContext.Provider value={optimizationTarget}>\n    {bl}\n  </OptimizationTargetContext.Provider>, [bl, optimizationTarget])\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1}>\n    {noArtifact && <Alert severity=\"warning\" variant=\"filled\"><Trans t={t} i18nKey=\"noArtis\">Oops! It looks like you haven't added any artifacts to GO yet! You should go to the <Link component={RouterLink} to=\"/artifacts\">Artifacts</Link> page and add some!</Trans></Alert>}\n    {/* Build Generator Editor */}\n    {dataContext && <DataContext.Provider value={dataContext}>\n      {clownEmoji}\n      {/* Footer */}\n      {isSM && targetSelector}\n      {selector}\n\n      {!!characterKey && <BuildAlert {...{ status: buildStatus, characterName, maxBuildsToShow }} />}\n      {target}\n      {card}\n      {ccc}\n    </DataContext.Provider>}\n  </Box>\n}\nfunction BuildList({ builds, setBuilds, characterKey, data, compareData, disabled, getLabel }: {\n  builds: string[][]\n  setBuilds?: (builds: string[][] | undefined) => void\n  characterKey?: \"\" | CharacterKey\n  data?: UIData\n  compareData: boolean\n  disabled: boolean\n  getLabel: (index: number) => Displayable\n}) {\n  const deleteBuild = useCallback((index: number) => {\n    if (setBuilds) {\n      const builds_ = [...builds]\n      builds_.splice(index, 1)\n      setBuilds(builds_)\n    }\n  },\n    [builds, setBuilds])\n\n  // TODO useMemo each build when the useContext spaghetti is cleaned up\n  // we should not rerender when changing main stat filters\n  const list = useMemo(() => <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\n    {builds?.map((build, index) => characterKey && data &&\n      <DataContextWrapper\n        key={index + build.join()}\n        characterKey={characterKey}\n        build={build}\n        oldData={data}\n      >\n        <BuildItemWrapper\n          index={index}\n          label={getLabel(index)}\n          build={build}\n          compareData={compareData}\n          disabled={disabled}\n          deleteBuild={setBuilds ? deleteBuild : undefined}\n        />\n      </DataContextWrapper>\n    )}\n  </Suspense>, [builds, characterKey, data, getLabel, compareData, disabled, setBuilds, deleteBuild])\n  return list\n}\nfunction BuildItemWrapper({ index, label, build, compareData, disabled, deleteBuild }: {\n  index: number\n  label: Displayable\n  build: string[]\n  compareData: boolean\n  disabled: boolean\n  deleteBuild?: (index: number) => void\n}) {\n  const { t } = useTranslation(\"page_character_optimize\")\n  const location = useLocation()\n  const navigate = useNavigate()\n  const toTC = useCallback(() => {\n    const paths = location.pathname.split(\"/\")\n    paths.pop()\n    navigate(`${paths.join(\"/\")}/theorycraft`, { state: { build } })\n  }, [navigate, build, location.pathname])\n\n  return <BuildDisplayItem label={label} compareBuild={compareData} disabled={disabled}\n    extraButtonsLeft={<>\n      <Button color=\"info\" size=\"small\" startIcon={<Science />} onClick={toTC}>{t(\"theorycraftButton\")}</Button>\n      {deleteBuild && <Button color=\"error\" size=\"small\" startIcon={<DeleteForever />} onClick={() => deleteBuild(index)}>{t(\"removeBuildButton\")}</Button>}\n    </>}\n  />\n}\n\ntype Prop = {\n  children: React.ReactNode\n  characterKey: CharacterKey,\n  build: string[],\n  oldData: UIData,\n}\nfunction DataContextWrapper({ children, characterKey, build, oldData }: Prop) {\n  const { database } = useContext(DatabaseContext)\n  const { buildSetting: { mainStatAssumptionLevel } } = useBuildSetting(characterKey)\n  // Update the build when the build artifacts are changed.\n  const [dirty, setDirty] = useForceUpdate()\n  useEffect(() => database.arts.followAny((id) => build.includes(id) && setDirty()), [database, build, setDirty])\n  const buildsArts = useMemo(() => dirty && build.map(i => database.arts.get(i)!), [dirty, build, database])\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel, buildsArts)\n  const providerValue = useMemo(() => teamData && ({ data: teamData[characterKey]!.target, teamData, oldData }), [teamData, oldData, characterKey])\n  if (!providerValue) return null\n  return <DataContext.Provider value={providerValue}>\n    {children}\n  </DataContext.Provider>\n}\n","import { Close, Difference } from \"@mui/icons-material\"\nimport { Button, Skeleton, Tooltip, Typography } from \"@mui/material\"\nimport { Suspense, useContext, useMemo } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport { CharacterContext } from \"../../../../Context/CharacterContext\"\nimport { HitModeToggle, ReactionToggle } from \"../../../../Components/HitModeEditor\"\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\nimport { DatabaseContext } from \"../../../../Database/Database\"\nimport { DataContext } from \"../../../../Context/DataContext\"\nimport useBoolState from \"../../../../ReactHooks/useBoolState\"\nimport useTeamData from \"../../../../ReactHooks/useTeamData\"\nimport { objectMap } from \"../../../../Util/Util\"\nimport useBuildSetting from \"../TabOptimize/useBuildSetting\"\nimport BuildDisplayItem from \"../TabOptimize/Components/BuildDisplayItem\"\n\nexport default function CompareBuildButton({ artId, weaponId }: { artId?: string, weaponId?: string }) {\n  const { t } = useTranslation(\"page_character\")\n  const [show, onShow, onHide] = useBoolState(false)\n\n  return <>\n    <ModalWrapper open={show} onClose={onHide} containerProps={{ maxWidth: \"xl\" }}>\n      <CompareContent artId={artId} weaponId={weaponId} onHide={onHide} />\n    </ModalWrapper>\n    <Tooltip title={<Typography>{t`tabEquip.compare`}</Typography>} placement=\"top\" arrow>\n      <Button color=\"info\" size=\"small\" onClick={onShow} ><Difference /></Button>\n    </Tooltip>\n  </>\n}\nfunction CompareContent({ artId, weaponId, onHide }: { artId?: string, weaponId?: string, onHide: () => void }) {\n  const { database } = useContext(DatabaseContext)\n  const { character: { key: characterKey, equippedArtifacts } } = useContext(CharacterContext)\n  const { buildSetting: { mainStatAssumptionLevel } } = useBuildSetting(characterKey)\n  const { data: oldData } = useContext(DataContext)\n  const build = useMemo(() => {\n    const newArt = database.arts.get(artId ?? \"\")\n    const artmap = objectMap(equippedArtifacts, (id, slot) => slot === newArt?.slotKey ? newArt : database.arts.get(id))\n    return Object.values(artmap).filter(a => a)\n  }, [database, equippedArtifacts, artId])\n  const teamData = useTeamData(characterKey, mainStatAssumptionLevel, build, weaponId ? database.weapons.get(weaponId) : undefined)\n  const dataProviderValue = useMemo(() => teamData && ({ data: teamData[characterKey]!.target, teamData, oldData }), [characterKey, teamData, oldData])\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={600} />}>\n    {dataProviderValue && <DataContext.Provider value={dataProviderValue}>\n      <BuildDisplayItem compareBuild={true} extraButtonsLeft={<><HitModeToggle size=\"small\" /><ReactionToggle size=\"small\" /></>} extraButtonsRight={<><Button size='small' color=\"error\" onClick={onHide} ><Close /></Button></>} />\n    </DataContext.Provider>}\n  </Suspense>\n}\n","import { Box, CardContent, Divider, Grid, Skeleton, Typography } from \"@mui/material\"\nimport { lazy, Suspense, useCallback, useContext, useEffect, useMemo, useReducer } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport Assets from \"../../../../Assets/Assets\"\nimport CardDark from \"../../../../Components/Card/CardDark\"\nimport CloseButton from \"../../../../Components/CloseButton\"\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\"\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\nimport { DatabaseContext } from \"../../../../Database/Database\"\nimport ArtifactCard from \"../../../../PageArtifact/ArtifactCard\"\nimport { artifactFilterConfigs, FilterOption, initialFilterOption } from \"../../../../PageArtifact/ArtifactSort\"\nimport useForceUpdate from \"../../../../ReactHooks/useForceUpdate\"\nimport useMediaQueryUp from \"../../../../ReactHooks/useMediaQueryUp\"\nimport { SlotKey } from \"../../../../Types/consts\"\nimport { filterFunction } from \"../../../../Util/SortByFilters\"\nimport CompareBuildButton from \"./CompareBuildButton\"\nconst numToShowMap = { xs: 6, sm: 6, md: 9, lg: 12, xl: 12 }\n\nconst ArtifactFilterDisplay = lazy(() => import('../../../../Components/Artifact/ArtifactFilterDisplay'))\n\nexport default function ArtifactSwapModal({ onChangeId, slotKey, show, onClose }:\n  { onChangeId: (id: string) => void, slotKey: SlotKey, show: boolean, onClose: () => void }) {\n  const { t } = useTranslation(\"page_character\")\n  const { database } = useContext(DatabaseContext)\n  const clickHandler = useCallback((id) => {\n    onChangeId(id)\n    onClose()\n  }, [onChangeId, onClose])\n  const filterOptionReducer = useCallback((state, action) => ({ ...state, ...action, slotKeys: [slotKey] }), [slotKey],)\n\n  const [filterOption, filterOptionDispatch]: [FilterOption, (action: any) => void] = useReducer(filterOptionReducer, { ...initialFilterOption(), slotKeys: [slotKey] })\n\n  const [dbDirty, forceUpdate] = useForceUpdate()\n  useEffect(() => { return database.arts.followAny(forceUpdate) }, [database, forceUpdate])\n\n  const brPt = useMediaQueryUp()\n\n  const filterConfigs = useMemo(() => artifactFilterConfigs(), [])\n  const artIdList = useMemo(() => {\n    const filterFunc = filterFunction(filterOption, filterConfigs)\n    return dbDirty && database.arts.values.filter(filterFunc).map(art => art.id).slice(0, numToShowMap[brPt])\n  }, [dbDirty, database, filterConfigs, filterOption, brPt])\n\n  return <ModalWrapper open={show} onClose={onClose} containerProps={{ maxWidth: \"xl\" }} >\n    <CardDark>\n      <CardContent sx={{ py: 1, display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n        <Typography variant=\"h6\">{slotKey ? <ImgIcon src={Assets.slot[slotKey]} /> : null} {t`tabEquip.swapArt`}</Typography>\n        <CloseButton onClick={onClose} />\n      </CardContent>\n      <Divider />\n      <CardContent>\n        <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={200} />}>\n          <ArtifactFilterDisplay filterOption={filterOption} filterOptionDispatch={filterOptionDispatch} disableSlotFilter />\n        </Suspense>\n        <Box mt={1}>\n          <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={300} />}>\n            <Grid container spacing={1} columns={{ xs: 2, md: 3, lg: 4 }}>\n              {artIdList.map(id =>\n                <Grid item key={id} xs={1} >\n                  <ArtifactCard\n                    artifactId={id}\n                    extraButtons={<CompareBuildButton artId={id} />}\n                    onClick={clickHandler}\n                  />\n                </Grid>)}\n            </Grid>\n          </Suspense>\n        </Box>\n      </CardContent>\n    </CardDark>\n  </ModalWrapper>\n}\n","import { Box, CardContent, Divider, Grid, TextField, ToggleButton, Typography } from \"@mui/material\"\nimport { ChangeEvent, useCallback, useContext, useDeferredValue, useEffect, useMemo, useState } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport Assets from \"../../../../Assets/Assets\"\nimport CardDark from \"../../../../Components/Card/CardDark\"\nimport CloseButton from \"../../../../Components/CloseButton\"\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\"\nimport ModalWrapper from \"../../../../Components/ModalWrapper\"\nimport SolidToggleButtonGroup from \"../../../../Components/SolidToggleButtonGroup\"\nimport { StarsDisplay } from \"../../../../Components/StarDisplay\"\nimport WeaponSheet from \"../../../../Data/Weapons/WeaponSheet\"\nimport { DatabaseContext } from \"../../../../Database/Database\"\nimport WeaponCard from \"../../../../PageWeapon/WeaponCard\"\nimport useForceUpdate from '../../../../ReactHooks/useForceUpdate'\nimport usePromise from \"../../../../ReactHooks/usePromise\"\nimport { allRarities, Rarity, WeaponTypeKey } from \"../../../../Types/consts\"\nimport { handleMultiSelect } from \"../../../../Util/MultiSelect\"\nimport { filterFunction, sortFunction } from '../../../../Util/SortByFilters'\nimport { weaponFilterConfigs, weaponSortConfigs, weaponSortMap } from '../../../../Util/WeaponSort'\nimport CompareBuildButton from \"./CompareBuildButton\"\n\nconst rarityHandler = handleMultiSelect([...allRarities])\n\nexport default function WeaponSwapModal({ onChangeId, weaponTypeKey, show, onClose }: { onChangeId: (id: string) => void, weaponTypeKey: WeaponTypeKey, show: boolean, onClose: () => void }) {\n  const { t } = useTranslation([\"page_character\", \"page_weapon\", \"weaponNames_gen\"])\n  const { database } = useContext(DatabaseContext)\n  const clickHandler = useCallback((id: string) => {\n    onChangeId(id)\n    onClose()\n  }, [onChangeId, onClose])\n\n  const [dbDirty, forceUpdate] = useForceUpdate()\n  useEffect(() => database.weapons.followAny(forceUpdate), [forceUpdate, database])\n\n  const weaponSheets = usePromise(() => WeaponSheet.getAll, [])\n\n  const [rarity, setRarity] = useState<Rarity[]>([5, 4, 3])\n  const [searchTerm, setSearchTerm] = useState(\"\")\n  const deferredSearchTerm = useDeferredValue(searchTerm)\n\n  const weaponIdList = useMemo(() => (weaponSheets && dbDirty && database.weapons.values\n    .filter(filterFunction({ weaponType: weaponTypeKey, rarity, name: deferredSearchTerm }, weaponFilterConfigs(weaponSheets)))\n    .sort(sortFunction(weaponSortMap[\"level\"] ?? [], false, weaponSortConfigs(weaponSheets)))\n    .map(weapon => weapon.id)) ?? []\n    , [dbDirty, database, weaponSheets, rarity, weaponTypeKey, deferredSearchTerm])\n\n  return <ModalWrapper open={show} onClose={onClose} >\n    <CardDark>\n      <CardContent sx={{ py: 1 }}>\n        <Grid container>\n          <Grid item flexGrow={1}>\n            <Typography variant=\"h6\">{weaponTypeKey ? <ImgIcon src={Assets.weaponTypes[weaponTypeKey]} /> : null} {t`page_character:tabEquip.swapWeapon`}</Typography>\n          </Grid>\n          <Grid item>\n            <CloseButton onClick={onClose} />\n          </Grid>\n        </Grid>\n      </CardContent>\n      <Divider />\n      <CardContent>\n        <Grid container spacing={1} mb={1}>\n          <Grid item>\n            <SolidToggleButtonGroup sx={{ height: \"100%\" }} value={rarity} size=\"small\">\n              {allRarities.map(star => <ToggleButton key={star} value={star} onClick={() => setRarity(rarityHandler(rarity, star))}>\n                <Box display=\"flex\" gap={1}><strong>{star}</strong><StarsDisplay stars={1} /></Box>\n              </ToggleButton>)}\n            </SolidToggleButtonGroup>\n          </Grid>\n          <Grid item flexGrow={1}>\n            <TextField\n              autoFocus\n              size=\"small\"\n              value={searchTerm}\n              onChange={(e: ChangeEvent<HTMLTextAreaElement>) => setSearchTerm(e.target.value)}\n              label={t(\"page_weapon:weaponName\")}\n              sx={{ height: \"100%\" }}\n              InputProps={{\n                sx: { height: \"100%\" }\n              }}\n            />\n          </Grid>\n        </Grid>\n        <Grid container spacing={1}>\n          {weaponIdList.map(weaponId =>\n            <Grid item key={weaponId} xs={6} sm={6} md={4} lg={3} >\n              <WeaponCard\n                weaponId={weaponId}\n                onClick={clickHandler}\n                extraButtons={<CompareBuildButton weaponId={weaponId} />}\n              />\n            </Grid>)}\n        </Grid>\n      </CardContent>\n    </CardDark>\n  </ModalWrapper>\n}\n","import { Settings, SwapHoriz } from '@mui/icons-material';\nimport { Box, Button, CardContent, Divider, Grid, ListItem, Stack, Tooltip, Typography, useMediaQuery, useTheme } from '@mui/material';\nimport { lazy, Suspense, useCallback, useContext, useDeferredValue, useEffect, useMemo, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport SetEffectDisplay from '../../../../Components/Artifact/SetEffectDisplay';\nimport SlotNameWithIcon from '../../../../Components/Artifact/SlotNameWIthIcon';\nimport SubstatToggle from '../../../../Components/Artifact/SubstatToggle';\nimport CardDark from '../../../../Components/Card/CardDark';\nimport CardLight from '../../../../Components/Card/CardLight';\nimport DocumentDisplay from \"../../../../Components/DocumentDisplay\";\nimport { BasicFieldDisplay, FieldDisplayList } from '../../../../Components/FieldDisplay';\nimport ModalWrapper from '../../../../Components/ModalWrapper';\nimport PercentBadge from '../../../../Components/PercentBadge';\nimport { CharacterContext } from '../../../../Context/CharacterContext';\nimport { DataContext } from '../../../../Context/DataContext';\nimport Artifact from '../../../../Data/Artifacts/Artifact';\nimport { ArtifactSheet } from '../../../../Data/Artifacts/ArtifactSheet';\nimport { DatabaseContext } from '../../../../Database/Database';\nimport { uiInput as input } from '../../../../Formula';\nimport ArtifactCard from '../../../../PageArtifact/ArtifactCard';\nimport WeaponCard from '../../../../PageWeapon/WeaponCard';\nimport useBoolState from '../../../../ReactHooks/useBoolState';\nimport useCharMeta from '../../../../ReactHooks/useCharMeta';\nimport usePromise from '../../../../ReactHooks/usePromise';\nimport { allSubstatKeys } from '../../../../Types/artifact';\nimport { allSlotKeys, charKeyToLocCharKey, SlotKey, WeaponTypeKey } from '../../../../Types/consts';\nimport { IFieldDisplay } from '../../../../Types/fieldDisplay';\nimport useBuildSetting from '../TabOptimize/useBuildSetting';\nimport ArtifactSwapModal from './ArtifactSwapModal';\nimport WeaponSwapModal from './WeaponSwapModal';\n\nconst WeaponEditor = lazy(() => import('../../../../PageWeapon/WeaponEditor'))\n\nexport default function EquipmentSection() {\n  const { character: { equippedWeapon, key: characterKey }, characterSheet } = useContext(CharacterContext)\n  const { buildSetting: { mainStatAssumptionLevel } } = useBuildSetting(characterKey)\n  const { teamData, data } = useContext(DataContext)\n  const weaponSheet = teamData[characterKey]?.weaponSheet\n  const [weaponId, setweaponId] = useState(\"\")\n  const showWeapon = useCallback(() => setweaponId(equippedWeapon), [equippedWeapon],)\n  const hideWeapon = useCallback(() => setweaponId(\"\"), [])\n\n  //triggers when character swap weapons\n  useEffect(() => {\n    if (weaponId && weaponId !== equippedWeapon)\n      setweaponId(equippedWeapon)\n  }, [weaponId, equippedWeapon])\n\n  const theme = useTheme();\n  const breakpoint = useMediaQuery(theme.breakpoints.up('lg'));\n\n  const weaponDoc = useMemo(() => weaponSheet && weaponSheet.document.length > 0 && <CardLight><CardContent><DocumentDisplay sections={weaponSheet.document} /></CardContent></CardLight>, [weaponSheet])\n  const { rvFilter } = useCharMeta(characterKey)\n  const deferredRvFilter = useDeferredValue(rvFilter)\n  const deferredRvSet = useMemo(() => new Set(deferredRvFilter), [deferredRvFilter])\n  return <Box >\n    <Suspense fallback={false}>\n      <WeaponEditor\n        weaponId={weaponId}\n        footer\n        onClose={hideWeapon}\n        extraButtons={<LargeWeaponSwapButton weaponTypeKey={characterSheet.weaponTypeKey} />}\n      />\n    </Suspense>\n    <Grid container spacing={1}>\n      {breakpoint && <Grid item xs={12} md={12} lg={3} xl={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }} >\n        {weaponDoc && weaponDoc}\n        <ArtifactSectionCard />\n      </Grid>}\n      <Grid item xs={12} md={12} lg={9} xl={9} container spacing={1}>\n        <Grid item xs={12} sm={6} md={4} display=\"flex\" flexDirection=\"column\" gap={1}>\n          <WeaponCard weaponId={equippedWeapon} onEdit={showWeapon} canEquip extraButtons={<WeaponSwapButton weaponTypeKey={characterSheet.weaponTypeKey} />} />\n        </Grid>\n        {allSlotKeys.map(slotKey => <Grid item xs={12} sm={6} md={4} key={slotKey} >\n          {!!data.get(input.art[slotKey].id).value ?\n            <ArtifactCard artifactId={data.get(input.art[slotKey].id).value} mainStatAssumptionLevel={mainStatAssumptionLevel} effFilter={deferredRvSet}\n              extraButtons={<ArtifactSwapButton slotKey={slotKey} />} editorProps={{}} canExclude canEquip /> :\n            <ArtSwapCard slotKey={slotKey} />}\n        </Grid>)}\n      </Grid>\n      {!breakpoint && <Grid item xs={12} md={12} xl={3} container spacing={1} >\n        {weaponDoc && <Grid item xs={12} md={6} lg={4}>{weaponDoc}</Grid>}\n        <Grid item xs={12} md={6} lg={4} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\n          <ArtifactSectionCard />\n        </Grid>\n      </Grid>}\n    </Grid>\n  </Box>\n}\nfunction ArtSwapCard({ slotKey }: { slotKey: SlotKey }) {\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { database } = useContext(DatabaseContext)\n  const [show, onOpen, onClose] = useBoolState()\n  return <CardLight sx={{ height: \"100%\", width: \"100%\", minHeight: 300, display: \"flex\", flexDirection: \"column\" }}>\n    <CardContent>\n      <Typography><SlotNameWithIcon slotKey={slotKey} /></Typography>\n    </CardContent>\n    <Divider />\n    <Box sx={{\n      flexGrow: 1,\n      display: \"flex\",\n      justifyContent: \"center\",\n      alignItems: \"center\"\n    }}\n    >\n      <ArtifactSwapModal slotKey={slotKey} show={show} onClose={onClose} onChangeId={id => database.arts.set(id, { location: charKeyToLocCharKey(characterKey) })} />\n      <Button onClick={onOpen} color=\"info\" sx={{ borderRadius: \"1em\", }}>\n        <SwapHoriz sx={{ height: 100, width: 100 }} />\n      </Button>\n    </Box>\n  </CardLight>\n}\nfunction WeaponSwapButton({ weaponTypeKey }: { weaponTypeKey: WeaponTypeKey }) {\n  const { t } = useTranslation(\"page_character\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { database } = useContext(DatabaseContext)\n  const [show, onOpen, onClose] = useBoolState()\n  return <>\n    <Tooltip title={<Typography>{t`tabEquip.swapWeapon`}</Typography>} placement=\"top\" arrow>\n      <Button color=\"info\" size=\"small\" onClick={onOpen} ><SwapHoriz /></Button>\n    </Tooltip>\n    <WeaponSwapModal weaponTypeKey={weaponTypeKey} onChangeId={id => database.weapons.set(id, { location: charKeyToLocCharKey(characterKey) })} show={show} onClose={onClose} />\n  </>\n}\nfunction LargeWeaponSwapButton({ weaponTypeKey }: { weaponTypeKey: WeaponTypeKey }) {\n  const { t } = useTranslation(\"page_character\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { database } = useContext(DatabaseContext)\n  const [show, onOpen, onClose] = useBoolState()\n  return <>\n    <Button color=\"info\" onClick={onOpen} startIcon={<SwapHoriz />} >{t`tabEquip.swapWeapon`}</Button>\n    <WeaponSwapModal weaponTypeKey={weaponTypeKey} onChangeId={id => database.weapons.set(id, { location: charKeyToLocCharKey(characterKey) })} show={show} onClose={onClose} />\n  </>\n}\nfunction ArtifactSwapButton({ slotKey }: { slotKey: SlotKey }) {\n  const { t } = useTranslation(\"page_character\")\n  const { character: { key: characterKey } } = useContext(CharacterContext)\n  const { database } = useContext(DatabaseContext)\n  const [show, onOpen, onClose] = useBoolState()\n  return <>\n    <Tooltip title={<Typography>{t`tabEquip.swapArt`}</Typography>} placement=\"top\" arrow>\n      <Button color=\"info\" size=\"small\" onClick={onOpen} ><SwapHoriz /></Button>\n    </Tooltip>\n    <ArtifactSwapModal slotKey={slotKey} show={show} onClose={onClose} onChangeId={id => database.arts.set(id, { location: charKeyToLocCharKey(characterKey) })} />\n  </>\n}\nfunction ArtifactSectionCard() {\n  const { t } = useTranslation([\"page_character\", \"artifact\"])\n  const { database } = useContext(DatabaseContext)\n  const { character, character: { key: characterKey, equippedArtifacts } } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\n  const hasEquipped = useMemo(() => !!Object.values(equippedArtifacts).filter(i => i).length, [equippedArtifacts])\n  const unequipArts = useCallback(() => {\n    if (!character) return\n    if (!window.confirm(\"Do you want to move all currently equipped artifacts to inventory?\")) return\n    Object.values(equippedArtifacts).forEach(aid => database.arts.set(aid, { location: \"\" }))\n  }, [character, database, equippedArtifacts])\n\n  const setEffects = useMemo(() => artifactSheets && ArtifactSheet.setEffects(artifactSheets, data), [artifactSheets, data])\n  const { rvFilter } = useCharMeta(characterKey)\n  const setRVFilter = useCallback(rvFilter => database.charMeta.set(characterKey, { rvFilter }), [database, characterKey],)\n\n  const [show, onShow, onHide] = useBoolState()\n  const deferredrvFilter = useDeferredValue(rvFilter)\n  const { rvField, rvmField } = useMemo(() => {\n    const { currentEfficiency, currentEfficiency_, maxEfficiency, maxEfficiency_ } = Object.values(equippedArtifacts).reduce((a, artid) => {\n      const art = database.arts.get(artid)\n      if (art) {\n        const { currentEfficiency, maxEfficiency } = Artifact.getArtifactEfficiency(art, new Set(deferredrvFilter))\n        const { currentEfficiency: currentEfficiency_, maxEfficiency: maxEfficiency_ } = Artifact.getArtifactEfficiency(art, new Set(allSubstatKeys))\n        a.currentEfficiency = a.currentEfficiency + currentEfficiency\n        a.maxEfficiency = a.maxEfficiency + maxEfficiency\n\n        a.currentEfficiency_ = a.currentEfficiency_ + currentEfficiency_\n        a.maxEfficiency_ = a.maxEfficiency_ + maxEfficiency_\n      }\n      return a\n    }, { currentEfficiency: 0, currentEfficiency_: 0, maxEfficiency: 0, maxEfficiency_: 0 })\n    const rvField: IFieldDisplay = {\n      text: t`artifact:editor.curSubEff`,\n      value: !(currentEfficiency - currentEfficiency_) ? <PercentBadge value={currentEfficiency} max={4500} valid /> :\n        <span><PercentBadge value={currentEfficiency} max={4500} valid /> / <PercentBadge value={currentEfficiency_} max={4500} valid /></span>\n    }\n    const rvmField: IFieldDisplay = {\n      text: t`artifact:editor.maxSubEff`,\n      canShow: () => !!(currentEfficiency_ - maxEfficiency_),\n      value: !(maxEfficiency - maxEfficiency_) ? <PercentBadge value={maxEfficiency} max={4500} valid /> :\n        <span><PercentBadge value={maxEfficiency} max={4500} valid /> / <PercentBadge value={maxEfficiency_} max={4500} valid /></span>\n    }\n    return { rvField, rvmField }\n  }, [t, deferredrvFilter, equippedArtifacts, database])\n\n  return <CardLight>\n    {hasEquipped && <Button color=\"error\" onClick={unequipArts} fullWidth sx={{ borderBottomRightRadius: 0, borderBottomLeftRadius: 0 }}>{t`tabEquip.unequipArts`}</Button>}\n    <CardContent >\n      <Stack spacing={1}>\n        <CardDark >\n          <Button fullWidth color=\"info\" startIcon={<Settings />} sx={{ borderBottomLeftRadius: 0, borderBottomRightRadius: 0 }} onClick={onShow}>RV Filter</Button>\n          <ModalWrapper open={show} onClose={onHide}>\n            <CardDark>\n              <CardContent>\n                <SubstatToggle selectedKeys={rvFilter} onChange={setRVFilter} />\n              </CardContent>\n            </CardDark>\n          </ModalWrapper>\n          <FieldDisplayList >\n            <BasicFieldDisplay field={rvField} component={ListItem} data={data} />\n            {rvmField?.canShow?.(data) && <BasicFieldDisplay field={rvmField} component={ListItem} data={data} />}\n          </FieldDisplayList>\n        </CardDark>\n        {artifactSheets && setEffects && Object.entries(setEffects).flatMap(([setKey, setNumKeyArr]) =>\n          setNumKeyArr.map(setNumKey => <CardDark key={setKey + setNumKey} sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\n            <SetEffectDisplay key={setKey + setNumKey} setKey={setKey} setNumKey={setNumKey} />\n          </CardDark>)\n        )}\n      </Stack>\n    </CardContent>\n  </CardLight>\n}\n","import { Favorite, FavoriteBorder } from \"@mui/icons-material\";\nimport { Badge, Box, CardActionArea, Chip, Grid, IconButton, Stack, Typography } from \"@mui/material\";\nimport { useCallback, useContext, useRef } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Assets from \"../../../../Assets/Assets\";\nimport ArtifactCardNano from \"../../../../Components/Artifact/ArtifactCardNano\";\nimport CardLight from \"../../../../Components/Card/CardLight\";\nimport CharacterCardPico from \"../../../../Components/Character/CharacterCardPico\";\nimport StatDisplayComponent from \"../../../../Components/Character/StatDisplayComponent\";\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\";\nimport SqBadge from \"../../../../Components/SqBadge\";\nimport { StarsDisplay } from \"../../../../Components/StarDisplay\";\nimport StatIcon from \"../../../../Components/StatIcon\";\nimport WeaponCardNano from \"../../../../Components/Weapon/WeaponCardNano\";\nimport { CharacterContext } from \"../../../../Context/CharacterContext\";\nimport { DataContext } from \"../../../../Context/DataContext\";\nimport { TalentSheetElementKey } from \"../../../../Data/Characters/CharacterSheet\";\nimport { getLevelString } from \"../../../../Data/LevelData\";\nimport { DatabaseContext } from \"../../../../Database/Database\";\nimport { uiInput as input } from \"../../../../Formula\";\nimport useCharacterReducer from \"../../../../ReactHooks/useCharacterReducer\";\nimport useCharMeta from \"../../../../ReactHooks/useCharMeta\";\nimport { allSlotKeys, Ascension, ElementKey } from \"../../../../Types/consts\";\nimport { range } from \"../../../../Util/Util\";\nimport EquipmentSection from \"./EquipmentSection\";\n\nexport default function TabOverview() {\n  const scrollRef = useRef<HTMLDivElement>()\n  const onScroll = useCallback(() => scrollRef?.current?.scrollIntoView?.({ behavior: \"smooth\" }), [scrollRef])\n\n  return <Stack spacing={1}>\n    <Grid container spacing={1} sx={{ justifyContent: \"center\" }}>\n      <Grid item xs={8} sm={5} md={4} lg={2.3}  >\n        <CharacterProfileCard />\n      </Grid>\n      <Grid item xs={12} sm={7} md={8} lg={9.7} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }} >\n        <EquipmentRow onClick={onScroll} />\n        <CardLight sx={{ flexGrow: 1, p: 1 }}>\n          <StatDisplayComponent />\n        </CardLight>\n      </Grid>\n    </Grid >\n    <Box ref={scrollRef}>\n      <EquipmentSection />\n    </Box>\n  </Stack>\n}\nfunction EquipmentRow({ onClick }: { onClick: () => void }) {\n  const { character: { equippedWeapon } } = useContext(CharacterContext)\n  const { data, } = useContext(DataContext)\n\n  return <Grid container spacing={1} columns={{ xs: 2, sm: 2, md: 3, lg: 6, xl: 6 }}>\n    <Grid item xs={1}>\n      <WeaponCardNano weaponId={equippedWeapon} BGComponent={CardLight} onClick={onClick} />\n    </Grid>\n    {allSlotKeys.map(slotKey =>\n      <Grid item key={slotKey} xs={1} >\n        <ArtifactCardNano artifactId={data.get(input.art[slotKey].id).value} slotKey={slotKey} BGComponent={CardLight} onClick={onClick} />\n      </Grid>)}\n  </Grid>\n}\n/* Image card with star and name and level */\nfunction CharacterProfileCard() {\n  const { database } = useContext(DatabaseContext)\n  const { characterSheet, character: { key: characterKey, team } } = useContext(CharacterContext)\n  const { data, } = useContext(DataContext)\n  const characterDispatch = useCharacterReducer(characterKey)\n  const navigate = useNavigate()\n  const charEle = data.get(input.charEle).value as ElementKey\n  const weaponTypeKey = characterSheet.weaponTypeKey\n  const level = data.get(input.lvl).value\n  const ascension = data.get(input.asc).value as Ascension\n  const constellation = data.get(input.constellation).value\n  const tlvl = {\n    auto: data.get(input.total.auto).value,\n    skill: data.get(input.total.skill).value,\n    burst: data.get(input.total.burst).value,\n  }\n  const tBoost = {\n    auto: data.get(input.bonus.auto).value,\n    skill: data.get(input.bonus.skill).value,\n    burst: data.get(input.bonus.burst).value,\n  }\n  const { favorite } = useCharMeta(characterKey)\n  return <CardLight sx={{ height: \"100%\" }} >\n    <Box sx={{ position: \"relative\" }}>\n      <Box sx={{ position: \"absolute\", width: \"100%\", height: \"100%\" }}>\n        <Typography variant=\"h6\" sx={{ position: \"absolute\", left: \"50%\", bottom: 0, transform: \"translate(-50%, -50%)\", opacity: 0.75 }}>\n          <StarsDisplay stars={characterSheet.rarity} colored />\n        </Typography>\n        <Box sx={{ position: \"absolute\", left: \"50%\", bottom: \"5%\", transform: \"translate(-50%, -50%)\", opacity: 0.85, width: \"100%\", display: \"flex\", justifyContent: \"center\", px: 1 }}>\n          <Chip color={charEle} sx={{ height: \"auto\" }}\n            label={<Typography variant=\"h6\" sx={{ display: \"flex\", gap: 1, alignItems: \"center\" }} >\n              {StatIcon[charEle]}\n              <Box sx={{ whiteSpace: \"normal\", textAlign: \"center\" }}>{characterSheet.name}</Box>\n              <ImgIcon src={Assets.weaponTypes?.[weaponTypeKey]} />\n            </Typography>} />\n        </Box>\n        <Box sx={{ position: \"absolute\", left: 0, top: 0 }}>\n          <IconButton sx={{ p: 1 }} color=\"error\" onClick={() => database.charMeta.set(characterKey, { favorite: !favorite })}>\n            {favorite ? <Favorite /> : <FavoriteBorder />}\n          </IconButton>\n        </Box>\n        <Typography sx={{ p: 1, position: \"absolute\", right: 0, top: 0, opacity: 0.8 }}>\n          <SqBadge>{getLevelString(level, ascension)}</SqBadge>\n        </Typography>\n      </Box>\n      <Box src={characterSheet.cardImg} component=\"img\" width=\"100%\" height=\"auto\" />\n    </Box>\n    <Box>\n      <CardActionArea sx={{ p: 1 }} onClick={() => navigate(\"talent\")}>\n        <Grid container spacing={1} mt={-1}>\n          {([\"auto\", \"skill\", \"burst\"] as TalentSheetElementKey[]).map(tKey =>\n            <Grid item xs={4} key={tKey}>\n              <Badge badgeContent={tlvl[tKey]} color={tBoost[tKey] ? \"info\" : \"secondary\"}\n                overlap=\"circular\"\n                anchorOrigin={{\n                  vertical: 'bottom',\n                  horizontal: 'right',\n                }}\n                sx={{\n                  width: \"100%\",\n                  height: \"100%\",\n                  \"& > .MuiBadge-badge\": {\n                    fontSize: \"1.25em\",\n                    padding: \".25em .4em\",\n                    borderRadius: \".5em\",\n                    lineHeight: 1,\n                    height: \"1.25em\"\n                  }\n                }}>\n                <Box component=\"img\" src={characterSheet.getTalentOfKey(tKey)?.img} width=\"100%\" height=\"auto\" />\n              </Badge>\n            </Grid>)}\n        </Grid>\n      </CardActionArea>\n      <Typography sx={{ textAlign: \"center\", mt: 1 }} variant=\"h6\">{characterSheet.constellationName}</Typography>\n      <Grid container spacing={1}>\n        {range(1, 6).map(i =>\n          <Grid item xs={4} key={i}>\n            <CardActionArea onClick={() => characterDispatch({ constellation: i === constellation ? i - 1 : i })}>\n              <Box component=\"img\" src={characterSheet.getTalentOfKey(`constellation${i}` as TalentSheetElementKey)?.img}\n                sx={{\n                  ...(constellation >= i ? {} : { filter: \"brightness(50%)\" })\n                }}\n                width=\"100%\" height=\"auto\" />\n            </CardActionArea>\n          </Grid>)}\n      </Grid>\n      <CardActionArea sx={{ p: 1 }} onClick={() => navigate(\"teambuffs\")}>\n        <Grid container columns={3} spacing={1}>\n          {range(0, 2).map(i => <Grid key={i} item xs={1} height=\"100%\"><CharacterCardPico characterKey={team[i]} index={i} /></Grid>)}\n        </Grid>\n      </CardActionArea>\n    </Box>\n  </CardLight >\n}\n","import { Box, CardActionArea, CardContent, Grid, MenuItem, Typography, useMediaQuery, useTheme } from \"@mui/material\";\nimport { useCallback, useContext, useMemo } from 'react';\nimport CardDark from \"../../../Components/Card/CardDark\";\nimport CardLight from \"../../../Components/Card/CardLight\";\nimport ConditionalWrapper from \"../../../Components/ConditionalWrapper\";\nimport DocumentDisplay from \"../../../Components/DocumentDisplay\";\nimport DropdownButton from \"../../../Components/DropdownMenu/DropdownButton\";\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\nimport { CharacterContext } from \"../../../Context/CharacterContext\";\nimport { DataContext } from '../../../Context/DataContext';\nimport { FormulaDataContext } from \"../../../Context/FormulaDataContext\";\nimport { TalentSheetElementKey } from \"../../../Data/Characters/CharacterSheet\";\nimport { uiInput as input } from \"../../../Formula\";\nimport { NumNode } from \"../../../Formula/type\";\nimport { NodeDisplay } from '../../../Formula/uiData';\nimport useCharacterReducer from \"../../../ReactHooks/useCharacterReducer\";\nimport { DocumentSection } from \"../../../Types/sheet\";\nimport { range } from \"../../../Util/Util\";\n\nconst talentSpacing = {\n  xs: 12,\n  sm: 6,\n  md: 4\n}\n\nexport default function CharacterTalentPane() {\n  const { character, characterSheet } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n  const characterDispatch = useCharacterReducer(character.key)\n  const skillBurstList = [[\"auto\", \"Normal/Charged Attack\"], [\"skill\", \"Elemental Skill\"], [\"burst\", \"Elemental Burst\"]] as [TalentSheetElementKey, string][]\n  const passivesList: [tKey: TalentSheetElementKey, tText: string, asc: number][] = [[\"passive1\", \"Unlocked at Ascension 1\", 1], [\"passive2\", \"Unlocked at Ascension 4\", 4], [\"passive3\", \"Unlocked by Default\", 0]]\n  const ascension = data.get(input.asc).value\n  const constellation = data.get(input.constellation).value\n\n  const theme = useTheme();\n  const grlg = useMediaQuery(theme.breakpoints.up('lg'));\n  const constellationCards = useMemo(() => range(1, 6).map(i =>\n    <SkillDisplayCard\n      talentKey={`constellation${i}` as TalentSheetElementKey}\n      subtitle={`Constellation Lv. ${i}`}\n      onClickTitle={() => characterDispatch({ constellation: i === constellation ? i - 1 : i })}\n    />), [constellation, characterDispatch])\n  return <>\n    <ReactionDisplay />\n    <Grid container spacing={1}>\n      {/* constellations for 4column */}\n      {grlg && <Grid item xs={12} md={12} lg={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }} >\n        <CardLight><CardContent><Typography variant=\"h6\" sx={{ textAlign: \"center\" }}>Constellation Lv. {constellation}</Typography></CardContent></CardLight>\n        {constellationCards.map((c, i) => <Box key={i} sx={{ opacity: constellation >= (i + 1) ? 1 : 0.5 }} >{c}</Box>)}\n      </Grid>}\n      <Grid item xs={12} md={12} lg={9} container spacing={1} >\n        {/* auto, skill, burst */}\n        {skillBurstList.map(([tKey, tText]) =>\n          <Grid item key={tKey} {...talentSpacing} >\n            <SkillDisplayCard\n              talentKey={tKey}\n              subtitle={tText}\n            />\n          </Grid>)}\n        {!!characterSheet.getTalentOfKey(\"sprint\",) && <Grid item {...talentSpacing} >\n          <SkillDisplayCard\n            talentKey=\"sprint\"\n            subtitle=\"Alternative Sprint\"\n          />\n        </Grid>}\n        {!!characterSheet.getTalentOfKey(\"passive\") && <Grid item {...talentSpacing} >\n          <SkillDisplayCard\n            talentKey=\"passive\"\n            subtitle=\"Passive\"\n          />\n        </Grid>}\n        {/* passives */}\n        {passivesList.map(([tKey, tText, asc]) => {\n          let enabled = ascension >= asc\n          if (!characterSheet.getTalentOfKey(tKey)) return null\n          return <Grid item key={tKey} style={{ opacity: enabled ? 1 : 0.5 }} {...talentSpacing} >\n            <SkillDisplayCard\n              talentKey={tKey}\n              subtitle={tText}\n            />\n          </Grid>\n        })}\n      </Grid>\n      {/* constellations for < 4 columns */}\n      {!grlg && <Grid item xs={12} md={12} lg={3} container spacing={1} >\n        <Grid item xs={12}>\n          <CardLight><CardContent><Typography variant=\"h6\" sx={{ textAlign: \"center\" }}>Constellation Lv. {constellation}</Typography></CardContent></CardLight>\n        </Grid>\n        {constellationCards.map((c, i) => <Grid item key={i} sx={{ opacity: constellation >= (i + 1) ? 1 : 0.5 }} {...talentSpacing} >{c}</Grid>)}\n      </Grid>}\n    </Grid>\n  </>\n}\nfunction ReactionDisplay() {\n  const { data } = useContext(DataContext)\n  const { setFormulaData } = useContext(FormulaDataContext)\n  const reaction = data.getDisplay().reaction as { [key: string]: NodeDisplay }\n  return <CardLight>\n    <CardContent>\n      <Grid container spacing={1}>\n        {Object.entries(reaction).filter(([_, node]) => !node.isEmpty).map(([key, node]) => {\n          return <Grid item key={key}>\n            <CardDark><CardContent sx={{ p: 1, \"&:last-child\": { pb: 1 } }}>\n              <NodeFieldDisplay node={node} data={data} setFormulaData={setFormulaData} />\n            </CardContent></CardDark>\n          </Grid>\n        })}\n      </Grid>\n    </CardContent>\n  </CardLight>\n}\n\nconst talentLimits = [1, 1, 2, 4, 6, 8, 10]\ntype SkillDisplayCardProps = {\n  talentKey: TalentSheetElementKey,\n  subtitle: string,\n  onClickTitle?: (any) => any\n}\nfunction SkillDisplayCard({ talentKey, subtitle, onClickTitle }: SkillDisplayCardProps) {\n  const { character: { talent }, characterSheet, characterDispatch } = useContext(CharacterContext)\n  const { data } = useContext(DataContext)\n\n  const actionWrapeprFunc = useCallback(\n    children => <CardActionArea onClick={onClickTitle}>{children}</CardActionArea>,\n    [onClickTitle],\n  )\n\n  const setTalentLevel = useCallback((tKey: TalentSheetElementKey, newTalentLevelKey: number) =>\n    characterDispatch({ talent: { ...talent, [tKey]: newTalentLevelKey } }), [talent, characterDispatch])\n\n  let header: Displayable | null = null\n\n  if (talentKey in talent) {\n    const levelBoost = data.get(input.bonus[talentKey] as NumNode).value\n    const level = data.get(input.total[talentKey]).value\n    const asc = data.get(input.asc).value\n\n    header = <DropdownButton fullWidth title={`Talent Lv. ${level}`} color={levelBoost ? \"info\" : \"primary\"} sx={{ borderRadius: 0 }}>\n      {range(1, talentLimits[asc]).map(i =>\n        <MenuItem key={i} selected={talent[talentKey] === (i)} disabled={talent[talentKey] === (i)} onClick={() => setTalentLevel(talentKey, i)}>Talent Lv. {i + levelBoost}</MenuItem>)}\n    </DropdownButton>\n  }\n  const talentSheet = characterSheet.getTalentOfKey(talentKey)\n\n  // Hide header if the header matches the current talent\n  const hideHeader = (section: DocumentSection): boolean => {\n    let headerAction = section.header?.action\n    if (headerAction && (typeof headerAction !== \"string\")) {\n      const key: string = headerAction.props.children.props.key18\n      return key.includes(talentKey)\n    }\n    return false\n  }\n\n  return <CardLight sx={{ height: \"100%\" }}>\n    {header}\n    <CardContent>\n      <ConditionalWrapper condition={!!onClickTitle} wrapper={actionWrapeprFunc} >\n        <Grid container sx={{ flexWrap: \"nowrap\" }}>\n          <Grid item>\n            <Box component=\"img\" src={talentSheet?.img} sx={{ width: 60, height: \"auto\" }} />\n          </Grid>\n          <Grid item flexGrow={1} sx={{ pl: 1 }}>\n            <Typography variant=\"h6\">{talentSheet?.name}</Typography>\n            <Typography variant=\"subtitle1\">{subtitle}</Typography>\n          </Grid>\n        </Grid>\n      </ConditionalWrapper>\n      {/* Display document sections */}\n      {talentSheet?.sections ? <DocumentDisplay sections={talentSheet.sections} hideDesc hideHeader={hideHeader} /> : null}\n    </CardContent>\n  </CardLight>\n}\n","import { PersonAdd } from \"@mui/icons-material\";\nimport { AutocompleteProps, CardContent, CardHeader, Divider, Grid, Skeleton, Typography, Box } from \"@mui/material\";\nimport { Suspense, useCallback, useContext, useMemo } from 'react';\nimport { useTranslation } from \"react-i18next\";\nimport CardLight from \"../../../Components/Card/CardLight\";\nimport CharacterCard from \"../../../Components/Character/CharacterCard\";\nimport ThumbSide from \"../../../Components/Character/ThumbSide\";\nimport ColorText from \"../../../Components/ColoredText\";\nimport DocumentDisplay from \"../../../Components/DocumentDisplay\";\nimport { NodeFieldDisplay } from \"../../../Components/FieldDisplay\";\nimport GeneralAutocomplete, { GeneralAutocompleteOption } from \"../../../Components/GeneralAutocomplete\";\nimport InfoTooltip from \"../../../Components/InfoTooltip\";\nimport { CharacterContext, CharacterContextObj } from \"../../../Context/CharacterContext\";\nimport { DataContext, dataContextObj } from \"../../../Context/DataContext\";\nimport { FormulaDataContext } from \"../../../Context/FormulaDataContext\";\nimport { ArtifactSheet } from \"../../../Data/Artifacts/ArtifactSheet\";\nimport CharacterSheet from \"../../../Data/Characters/CharacterSheet\";\nimport { resonanceSheets } from \"../../../Data/Resonance\";\nimport { DatabaseContext } from \"../../../Database/Database\";\nimport { NodeDisplay } from \"../../../Formula/uiData\";\nimport useCharSelectionCallback from \"../../../ReactHooks/useCharSelectionCallback\";\nimport useDBMeta from \"../../../ReactHooks/useDBMeta\";\nimport usePromise from \"../../../ReactHooks/usePromise\";\nimport { CharacterKey, charKeyToCharName } from \"../../../Types/consts\";\nimport { objPathValue, range } from \"../../../Util/Util\";\n\nexport default function TabTeambuffs() {\n  return <Box display=\"flex\" flexDirection=\"column\" gap={1} alignItems=\"stretch\">\n    <Grid container spacing={1}>\n      <Grid item xs={12} md={6} lg={3} sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\n        <TeamBuffDisplay />\n        <ResonanceDisplay />\n      </Grid>\n      {range(0, 2).map(i => <Grid item xs={12} md={6} lg={3} key={i}>\n        <TeammateDisplay index={i} />\n      </Grid>)}\n    </Grid>\n  </Box>\n}\nexport function TeamBuffDisplay() {\n  const { data, oldData } = useContext(DataContext)\n  const { setFormulaData } = useContext(FormulaDataContext)\n  const teamBuffs = data.getTeamBuff()\n  const nodes: Array<[string[], NodeDisplay<number>]> = []\n  Object.entries(teamBuffs.total ?? {}).forEach(([key, node]) =>\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"total\", key], node]))\n  Object.entries(teamBuffs.premod ?? {}).forEach(([key, node]) =>\n    !node.isEmpty && node.value !== 0 && nodes.push([[\"premod\", key], node]))\n  Object.entries(teamBuffs.enemy ?? {}).forEach(([key, node]) =>\n    !node.isEmpty && typeof node.value === \"number\" && node.value !== 0 && nodes.push([[\"enemy\", key], node as NodeDisplay<number>]))\n  if (!nodes.length) return null\n  return <CardLight>\n    <CardContent>\n      <Typography>Team Buffs</Typography>\n    </CardContent>\n    <Divider />\n    <CardContent>\n      <Grid container>\n        {nodes.map(([path, n]) => n && <Grid item xs={12} key={JSON.stringify(n.info)} >\n          <NodeFieldDisplay node={n} oldValue={objPathValue(oldData?.getTeamBuff(), path)?.value} data={data} setFormulaData={setFormulaData} />\n        </Grid>)}\n      </Grid>\n    </CardContent>\n  </CardLight>\n}\nfunction ResonanceDisplay() {\n  const { t } = useTranslation(\"page_character\")\n  const { data } = useContext(DataContext)\n  const { character: { team } } = useContext(CharacterContext)\n  const teamCount = team.reduce((a, t) => a + (t ? 1 : 0), 1)\n  return <>\n    <CardLight>\n      <CardHeader title={<span>{t<string>(\"tabTeambuff.team_reso\")} <strong><ColorText color={teamCount >= 4 ? \"success\" : \"warning\"}>({teamCount}/4)</ColorText></strong> <InfoTooltip title={<Typography>{t`tabTeambuff.resonance_tip`}</Typography>} /></span>}\n        titleTypographyProps={{ variant: \"subtitle2\" }} />\n    </CardLight>\n    {resonanceSheets.map((res, i) => {\n      const icon = <InfoTooltip title={<Typography>{res.desc}</Typography>} />\n      const title = <span>{res.name} {icon}</span>\n      return <CardLight key={i} sx={{ opacity: res.canShow(data) ? 1 : 0.5, }}>\n        <CardHeader title={title} action={res.icon} titleTypographyProps={{ variant: \"subtitle2\" }} />\n        {res.canShow(data) && <Divider />}\n        {res.canShow(data) && <CardContent>\n          <DocumentDisplay sections={res.sections} teamBuffOnly hideDesc />\n        </CardContent>}\n      </CardLight>\n    })}\n  </>\n}\nfunction TeammateDisplay({ index }: { index: number }) {\n  const { teamData } = useContext(DataContext)\n  const { t } = useTranslation(\"page_character\")\n  const { character: active, character: { key: activeCharacterKey }, characterDispatch } = useContext(CharacterContext)\n  const teamMateKey = active.team[index]\n  const team = useMemo(() => [activeCharacterKey, ...active.team].filter((t, i) => (i - 1) !== index), [active.team, activeCharacterKey, index])\n  const onClickHandler = useCharSelectionCallback()\n  const setTeammate = useCallback((charKey: CharacterKey | \"\") => characterDispatch({ type: \"team\", index, charKey }), [index, characterDispatch])\n\n  const dataBundle = teamData[teamMateKey]\n  const teammateCharacterContext: CharacterContextObj | undefined = useMemo(() => dataBundle && {\n    character: { ...dataBundle.character, conditional: active.teamConditional[teamMateKey] ?? {} },\n    characterSheet: dataBundle.characterSheet,\n    characterDispatch: (state) => {\n      if (!teamMateKey) return\n      if (!(\"conditional\" in state)) return\n      const { conditional } = state\n      characterDispatch({ type: \"teamConditional\", teamMateKey: teamMateKey, conditional })\n    }\n  }, [active, teamMateKey, dataBundle, characterDispatch])\n  const teamMateDataContext: dataContextObj | undefined = useMemo(() => dataBundle && {\n    data: dataBundle.target,\n    teamData: teamData,\n  }, [dataBundle, teamData])\n  return <CardLight>\n    <TeammateAutocomplete characterKey={teamMateKey} team={team}\n      setChar={setTeammate}\n      label={t(\"teammate\", { count: index + 1 })}\n    />\n    {teamMateKey && teammateCharacterContext && <CharacterContext.Provider value={teammateCharacterContext}>\n      {teamMateDataContext && <DataContext.Provider value={teamMateDataContext}>\n        <CharacterCard characterKey={teamMateKey}\n          onClickHeader={onClickHandler}\n          // Need to wrap these elements with the providers for them to use the correct functions.\n          artifactChildren={<CharacterContext.Provider value={teammateCharacterContext}>\n            <DataContext.Provider value={teamMateDataContext}>\n              <CharArtifactCondDisplay />\n            </DataContext.Provider>\n          </CharacterContext.Provider>}\n          weaponChildren={<CharacterContext.Provider value={teammateCharacterContext}>\n            <DataContext.Provider value={teamMateDataContext}>\n              <CharWeaponCondDisplay />\n            </DataContext.Provider>\n          </CharacterContext.Provider>}\n          characterChildren={<CharacterContext.Provider value={teammateCharacterContext}>\n            <DataContext.Provider value={teamMateDataContext}>\n              <CharTalentCondDisplay />\n            </DataContext.Provider>\n          </CharacterContext.Provider>}\n          isTeammateCard\n        />\n      </DataContext.Provider>}\n    </CharacterContext.Provider>}\n  </CardLight>\n}\nfunction CharArtifactCondDisplay() {\n  const { data, } = useContext(DataContext)\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\n  const sections = useMemo(() => artifactSheets &&\n    Object.entries(ArtifactSheet.setEffects(artifactSheets, data))\n      .flatMap(([setKey, setNums]) =>\n        setNums.flatMap(sn => artifactSheets(setKey)!.setEffectDocument(sn)!))\n    , [artifactSheets, data])\n  if (!sections) return null\n  return <DocumentDisplay sections={sections} teamBuffOnly={true} />\n}\nfunction CharWeaponCondDisplay() {\n  const { character: { key: charKey } } = useContext(CharacterContext)\n  const { teamData } = useContext(DataContext)\n  const weaponSheet = teamData[charKey]!.weaponSheet\n  if (!weaponSheet.document) return null\n  return <DocumentDisplay sections={weaponSheet.document} teamBuffOnly={true} />\n}\nfunction CharTalentCondDisplay() {\n  const { character: { key: charKey } } = useContext(CharacterContext)\n  const { teamData } = useContext(DataContext)\n  const characterSheet = teamData[charKey]!.characterSheet\n  const sections = Object.values(characterSheet.talent).flatMap(sts => sts.sections)\n  if (!sections) return null\n  return <DocumentDisplay sections={sections} teamBuffOnly={true} />\n}\n\nfunction TeammateAutocomplete({ characterKey, team, label, setChar, autoCompleteProps = {} }:\n  { characterKey, team: Array<CharacterKey | \"\">, label: string, setChar: (k: CharacterKey | \"\") => void, autoCompleteProps?: Omit<AutocompleteProps<GeneralAutocompleteOption<CharacterKey | \"\">, false, true, false>, \"renderInput\" | \"onChange\" | \"options\"> }) {\n  const { t } = useTranslation([\"charNames_gen\", \"page_character\", \"sheet_gen\"])\n  const { database } = useContext(DatabaseContext)\n  const { gender } = useDBMeta()\n  const characterSheets = usePromise(() => CharacterSheet.getAll, [])\n  const toText = useCallback((key: CharacterKey): string => key.startsWith(\"Traveler\") ? `${t(`charNames_gen:${charKeyToCharName(key, gender)}`)} (${t(`sheet_gen:element.${characterSheets?.(key, gender)?.elementKey}`)})` : t(`charNames_gen:${key}`), [characterSheets, t, gender])\n  const toImg = useCallback((key: CharacterKey | \"\") => key === \"\" ? <PersonAdd /> : characterSheets ? <ThumbSide src={characterSheets(key, gender)?.thumbImgSide} sx={{ pr: 1 }} /> : <></>, [characterSheets, gender])//\n  const isFavorite = useCallback((key: CharacterKey) => database.charMeta.get(key).favorite, [database])\n  const onDisable = useCallback(({ key }: { key: CharacterKey | \"\" }) => team.filter(t => t && t !== characterKey).includes(key) || (key.startsWith(\"Traveler\") && team.some((t, i) => t.startsWith(\"Traveler\"))), [team, characterKey])\n  const values: GeneralAutocompleteOption<CharacterKey | \"\">[] = useMemo(() => [{\n    key: \"\",\n    label: t`page_character:none`,\n  },\n  ...database.chars.keys\n    .map(v => ({ key: v, label: toText(v), favorite: isFavorite(v) }))\n    .sort((a, b) => {\n      if (a.favorite && !b.favorite) return -1\n      if (!a.favorite && b.favorite) return 1\n      return a.label.localeCompare(b.label)\n    })\n  ], [t, toText, isFavorite, database])\n  return <Suspense fallback={<Skeleton variant=\"text\" width={100} />}><GeneralAutocomplete size=\"small\" label={label} options={values} valueKey={characterKey} clearKey=\"\" onChange={setChar} getOptionDisabled={onDisable} toImg={toImg} {...autoCompleteProps} /></Suspense>\n}\n","import { faStar } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { CopyAll, DeleteForever, Info, Refresh } from \"@mui/icons-material\";\nimport { Box, Button, ButtonGroup, CardHeader, Divider, Grid, ListItem, MenuItem, Skeleton, Slider, Stack, ToggleButton, Typography } from \"@mui/material\";\nimport React, { Suspense, useCallback, useContext, useDeferredValue, useEffect, useMemo, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useLocation } from \"react-router-dom\";\nimport { ArtifactSetSingleAutocomplete } from \"../../../../Components/Artifact/ArtifactAutocomplete\";\nimport ArtifactSetTooltip from \"../../../../Components/Artifact/ArtifactSetTooltip\";\nimport SetEffectDisplay from \"../../../../Components/Artifact/SetEffectDisplay\";\nimport { slotIconSVG } from \"../../../../Components/Artifact/SlotNameWIthIcon\";\nimport BootstrapTooltip from \"../../../../Components/BootstrapTooltip\";\nimport CardDark from \"../../../../Components/Card/CardDark\";\nimport CardLight from \"../../../../Components/Card/CardLight\";\nimport StatDisplayComponent from \"../../../../Components/Character/StatDisplayComponent\";\nimport ColorText from \"../../../../Components/ColoredText\";\nimport CustomNumberInput from \"../../../../Components/CustomNumberInput\";\nimport DocumentDisplay from \"../../../../Components/DocumentDisplay\";\nimport DropdownButton from \"../../../../Components/DropdownMenu/DropdownButton\";\nimport { FieldDisplayList, NodeFieldDisplay } from \"../../../../Components/FieldDisplay\";\nimport FontAwesomeSvgIcon from \"../../../../Components/FontAwesomeSvgIcon\";\nimport ImgIcon from \"../../../../Components/Image/ImgIcon\";\nimport LevelSelect from \"../../../../Components/LevelSelect\";\nimport RefinementDropdown from \"../../../../Components/RefinementDropdown\";\nimport SolidToggleButtonGroup from \"../../../../Components/SolidToggleButtonGroup\";\nimport { StatColoredWithUnit, StatWithUnit } from \"../../../../Components/StatDisplay\";\nimport StatIcon from \"../../../../Components/StatIcon\";\nimport { CharacterContext } from \"../../../../Context/CharacterContext\";\nimport { DataContext, dataContextObj } from \"../../../../Context/DataContext\";\nimport Artifact, { maxArtifactLevel } from \"../../../../Data/Artifacts/Artifact\";\nimport { ArtifactSheet } from \"../../../../Data/Artifacts/ArtifactSheet\";\nimport WeaponSheet from \"../../../../Data/Weapons/WeaponSheet\";\nimport { initCharTC } from \"../../../../Database/DataManagers/CharacterTCData\";\nimport { DatabaseContext } from \"../../../../Database/Database\";\nimport { uiInput as input } from \"../../../../Formula\";\nimport { computeUIData, dataObjForWeapon } from \"../../../../Formula/api\";\nimport { constant, percent } from \"../../../../Formula/utils\";\nimport KeyMap, { cacheValueString } from \"../../../../KeyMap\";\nimport useBoolState from \"../../../../ReactHooks/useBoolState\";\nimport usePromise from \"../../../../ReactHooks/usePromise\";\nimport useTeamData from \"../../../../ReactHooks/useTeamData\";\nimport { ICachedArtifact, MainStatKey, SubstatKey } from \"../../../../Types/artifact\";\nimport { ICharTC, ICharTCArtifactSlot } from \"../../../../Types/character\";\nimport { allSlotKeys, ArtifactRarity, ArtifactSetKey, SetNum, SlotKey, SubstatType, substatType, WeaponTypeKey } from \"../../../../Types/consts\";\nimport { ICachedWeapon } from \"../../../../Types/weapon\";\nimport { deepClone, objectMap } from \"../../../../Util/Util\";\nimport { defaultInitialWeaponKey } from \"../../../../Util/WeaponUtil\";\nimport useCharTC from \"./useCharTC\";\nimport { FormulaDataContext } from \"../../../../Context/FormulaDataContext\";\nconst WeaponSelectionModal = React.lazy(() => import('../../../../Components/Weapon/WeaponSelectionModal'))\n\ntype ISet = Partial<Record<ArtifactSetKey, 1 | 2 | 4>>\nexport default function TabTheorycraft() {\n  const { database } = useContext(DatabaseContext)\n  const { data: oldData } = useContext(DataContext)\n  const { character, character: { key: characterKey, compareData }, characterSheet, characterDispatch } = useContext(CharacterContext)\n  const data = useCharTC(characterKey, defaultInitialWeaponKey(characterSheet.weaponTypeKey))\n  const setData = useCallback((data: ICharTC) => database.charTCs.set(characterKey, data), [characterKey, database])\n  const resetData = useCallback(() => {\n    setData(initCharTC(defaultInitialWeaponKey(characterSheet.weaponTypeKey)))\n  }, [setData, characterSheet])\n  const setWeapon = useCallback(\n    (action: Partial<ICharTC[\"weapon\"]>) => {\n      setData({ ...data, weapon: { ...data.weapon, ...action } })\n    },\n    [setData, data],\n  )\n\n  const copyFrom = useCallback(\n    (eWeapon: ICachedWeapon, build: ICachedArtifact[]) => {\n      const newData = initCharTC(eWeapon.key)\n      newData.artifact.substats.type = data.artifact.substats.type\n\n      newData.weapon.level = eWeapon.level\n      newData.weapon.ascension = eWeapon.ascension\n      newData.weapon.refinement = eWeapon.refinement\n\n      const sets = {}\n      build.forEach(art => {\n        if (!art) return\n        const { slotKey, setKey, substats, mainStatKey, level, rarity } = art\n        newData.artifact.slots[slotKey].level = level\n        newData.artifact.slots[slotKey].statKey = mainStatKey\n        newData.artifact.slots[slotKey].rarity = rarity\n        sets[setKey] = (sets[setKey] ?? 0) + 1\n        substats.forEach(substat => {\n          if (substat.key) newData.artifact.substats.stats[substat.key] = (newData.artifact.substats.stats[substat.key] ?? 0) + substat.accurateValue\n        })\n      })\n      newData.artifact.sets = Object.fromEntries(Object.entries(sets).map(([key, value]) => [key,\n        value === 3 ? 2 :\n          value === 5 ? 4 :\n            value === 1 && !(key as string).startsWith(\"PrayersFor\") ? 0 : value\n      ]).filter(([key, value]) => value))\n      setData(newData)\n    },\n    [data, setData],\n  )\n  const location = useLocation()\n  const { build: locBuild } = (location.state as { build: string[] } | undefined) ?? { build: undefined }\n  useEffect(() => {\n    if (!locBuild) return\n    const eWeapon = database.weapons.get(character.equippedWeapon)!\n    copyFrom(eWeapon, locBuild.map(i => database.arts.get(i)!))\n    // WARNING: if copyFrom is included, it will cause a render loop due to its setData <---> data\n    // eslint-disable-next-line\n  }, [locBuild, database])\n\n  const copyFromEquipped = useCallback(\n    () => {\n      const eWeapon = database.weapons.get(character.equippedWeapon)!\n      copyFrom(eWeapon, Object.values(character.equippedArtifacts).map(a => database.arts.get(a)!).filter(a => a))\n    },\n    [database, character.equippedArtifacts, character.equippedWeapon, copyFrom],\n  )\n\n  const weapon: ICachedWeapon = useMemo(() => {\n    return {\n      ...data.weapon,\n      location: \"\",\n      lock: false,\n      id: \"\"\n    }\n  }, [data])\n  const setArtifact = useCallback((artifact: ICharTC[\"artifact\"]) => {\n    const data_ = deepClone(data)\n    data_.artifact = artifact\n    setData(data_)\n  }, [data, setData])\n\n  const setSubstatsType = useCallback((t: SubstatType) => {\n    const data_ = deepClone(data)\n    data_.artifact.substats.type = t\n    setData(data_)\n  }, [data, setData])\n\n  const setSubstats = useCallback((setSubstats: Record<SubstatKey, number>) => {\n    const data_ = deepClone(data)\n    data_.artifact.substats.stats = setSubstats\n    setData(data_)\n  }, [data, setData])\n\n  const deferredData = useDeferredValue(data)\n  const overriderArtData = useMemo(() => {\n    const stats = { ...deferredData.artifact.substats.stats }\n    Object.values(deferredData.artifact.slots).forEach(({ statKey, rarity, level }) =>\n      stats[statKey] = (stats[statKey] ?? 0) + Artifact.mainStatValue(statKey, rarity, level))\n    return {\n      art: objectMap(stats, (v, k) => k.endsWith(\"_\") ? percent(v / 100) : constant(v)),\n      artSet: objectMap(deferredData.artifact.sets, v => constant(v)),\n    }\n  }, [deferredData])\n\n  const overrideWeapon: ICachedWeapon = useMemo(() => ({\n    id: \"\",\n    location: \"\",\n    key: data.weapon.key,\n    level: data.weapon.level,\n    ascension: data.weapon.ascension,\n    refinement: data.weapon.refinement,\n    lock: false\n  }), [data])\n  const teamData = useTeamData(characterKey, 0, overriderArtData, overrideWeapon)\n\n  const { target: charUIData } = teamData?.[characterKey] ?? {}\n\n  const dataContextValue: dataContextObj | undefined = useMemo(() => {\n    if (!teamData || !charUIData) return undefined\n    return {\n      data: charUIData,\n      teamData,\n    }\n  }, [charUIData, teamData])\n  const dataContextValueWithOld: dataContextObj | undefined = useMemo(() => {\n    if (!dataContextValue) return undefined\n    return {\n      ...dataContextValue,\n      oldData: compareData ? oldData : undefined,\n    }\n  }, [dataContextValue, compareData, oldData])\n  return <Stack spacing={1}>\n    <CardLight>\n      <Box sx={{ display: \"flex\", gap: 1, p: 1 }}>\n        <Box sx={{ flexGrow: 1, display: \"flex\", gap: 1 }}>\n          <Button color=\"info\" onClick={copyFromEquipped} startIcon={<CopyAll />}>Copy from equipped</Button>\n          <Button color=\"error\" onClick={resetData} startIcon={<Refresh />}>Reset</Button>\n        </Box>\n        <SolidToggleButtonGroup exclusive value={compareData} onChange={(e, v) => characterDispatch({ compareData: v })} size=\"small\">\n          <ToggleButton value={false} disabled={!compareData}>Show TC stats</ToggleButton>\n          <ToggleButton value={true} disabled={compareData}>Compare vs. equipped</ToggleButton>\n        </SolidToggleButtonGroup>\n      </Box>\n    </CardLight>\n    {dataContextValue ? <DataContext.Provider value={dataContextValue}>\n      <Grid container spacing={1} sx={{ justifyContent: \"center\" }}>\n        <Grid item sx={{ flexGrow: -1 }}  >\n          <WeaponEditorCard weapon={weapon} setWeapon={setWeapon} weaponTypeKey={characterSheet.weaponTypeKey} />\n          <ArtifactMainLevelCard artifactData={data.artifact} setArtifactData={setArtifact} />\n        </Grid>\n        <Grid item sx={{ flexGrow: 1 }}  >\n          <ArtifactSubCard substats={data.artifact.substats.stats} setSubstats={setSubstats} substatsType={data.artifact.substats.type} setSubstatsType={setSubstatsType} mainStatKeys={Object.values(data.artifact.slots).map(s => s.statKey)} />\n        </Grid>\n      </Grid >\n    </DataContext.Provider> : <Skeleton variant='rectangular' width='100%' height={500} />}\n    <CardLight sx={{ flexGrow: 1, p: 1 }}>\n      {dataContextValueWithOld ? <DataContext.Provider value={dataContextValueWithOld}>\n        <StatDisplayComponent />\n      </DataContext.Provider> : <Skeleton variant='rectangular' width='100%' height={500} />}\n    </CardLight>\n\n  </Stack>\n}\n\nfunction WeaponEditorCard({ weapon, setWeapon, weaponTypeKey }: { weapon: ICachedWeapon, weaponTypeKey: WeaponTypeKey, setWeapon: (action: Partial<ICharTC[\"weapon\"]>) => void }) {\n  const { key, level = 0, refinement = 1, ascension = 0 } = weapon\n  const weaponSheet = usePromise(() => WeaponSheet.get(key), [key])\n  const [show, onShow, onHide] = useBoolState()\n  const { data } = useContext(DataContext)\n  const { setFormulaData } = useContext(FormulaDataContext)\n  const weaponUIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\n  return <CardLight sx={{ p: 1, mb: 1 }} >\n    <WeaponSelectionModal ascension={ascension} show={show} onHide={onHide} onSelect={k => setWeapon({ key: k })} weaponTypeFilter={weaponTypeKey} />\n    <Box display=\"flex\" flexDirection=\"column\" gap={1}>\n      <Box display=\"flex\" gap={1}>\n        {weaponSheet && <Box\n          className={`grad-${weaponSheet.rarity}star`}\n          component=\"img\"\n          src={weaponSheet.getImg(weapon.ascension)}\n          sx={{ flexshrink: 1, flexBasis: 0, maxWidth: \"30%\", borderRadius: 1 }}\n        />}\n        <Stack spacing={1} flexGrow={1}>\n          <Button fullWidth color=\"info\" sx={{ flexGrow: 1 }} onClick={onShow}><Box sx={{ maxWidth: \"10em\" }}>{weaponSheet?.name}</Box></Button>\n          {weaponSheet?.hasRefinement && <RefinementDropdown refinement={refinement} setRefinement={r => setWeapon({ refinement: r })} />}\n        </Stack>\n      </Box>\n      {weaponSheet && <LevelSelect level={level} ascension={ascension} setBoth={setWeapon} useLow={!weaponSheet.hasRefinement} />}\n      <CardDark >\n        <CardHeader title={\"Main Stats\"} titleTypographyProps={{ variant: \"subtitle2\" }} />\n        <Divider />\n        {weaponUIData && <FieldDisplayList>\n          {[input.weapon.main, input.weapon.sub, input.weapon.sub2].map((node, i) => {\n            const n = weaponUIData.get(node)\n            if (n.isEmpty || !n.value) return null\n            return <NodeFieldDisplay key={JSON.stringify(n.info)} node={n} component={ListItem} data={data} setFormulaData={setFormulaData} />\n          })}\n        </FieldDisplayList>}\n      </CardDark>\n      {data && weaponSheet?.document && <DocumentDisplay sections={weaponSheet.document} />}\n    </Box>\n  </CardLight >\n}\n\nfunction ArtifactMainLevelCard({ artifactData, setArtifactData }:\n  { artifactData: ICharTC[\"artifact\"], setArtifactData: (a: ICharTC[\"artifact\"]) => void }) {\n  const setSlot = useCallback((slotKey: SlotKey) => (slot: ICharTCArtifactSlot) => {\n    const artifactData_ = deepClone(artifactData)\n    artifactData_.slots[slotKey] = slot\n    setArtifactData(artifactData_)\n  }, [artifactData, setArtifactData])\n\n  const setArtSet = useCallback((artSet: ISet) => {\n    const artifactData_ = deepClone(artifactData)\n    artifactData_.sets = artSet\n    setArtifactData(artifactData_)\n  }, [artifactData, setArtifactData])\n\n  return <Stack spacing={1} >\n    <CardLight sx={{ p: 1 }}>\n      <Stack spacing={1}>\n        {allSlotKeys.map(s => <ArtifactMainLevelSlot key={s} slotKey={s} slot={artifactData.slots[s]} setSlot={setSlot(s)} />)}\n      </Stack>\n    </CardLight>\n    <Suspense fallback={<Skeleton variant='rectangular' width='100%' height={200} />}>\n      <ArtifactSetsEditor artSet={artifactData.sets} setArtSet={setArtSet} />\n    </Suspense>\n  </Stack>\n}\nfunction ArtifactMainLevelSlot({ slotKey, slot, setSlot: setSlotProp }: { slotKey: SlotKey, slot: ICharTCArtifactSlot, setSlot: (s: ICharTCArtifactSlot) => void }) {\n  const { level, statKey, rarity } = slot\n  const keys = Artifact.slotMainStats(slotKey)\n  const setSlot = useCallback((action: Partial<ICharTCArtifactSlot>) => {\n    setSlotProp({ ...slot, ...action })\n  }, [slot, setSlotProp])\n  const setRarity = useCallback(\n    (r: ArtifactRarity) => {\n      const mLvl = maxArtifactLevel[r] ?? 0\n      if (level > mLvl) setSlot({ rarity: r, level: mLvl })\n      else setSlot({ rarity: r })\n    }, [level, setSlot])\n\n  return <Box display=\"flex\" gap={1} justifyContent=\"space-between\" alignItems=\"center\">\n    <FontAwesomeSvgIcon icon={slotIconSVG[slotKey]} />\n    <CardDark sx={{ height: \"100%\", minWidth: \"5em\", flexGrow: 1, display: \"flex\" }}>\n      {keys.length === 1 ?\n        <Box p={1} justifyContent=\"center\" alignItems=\"center\" width=\"100%\" display=\"flex\" gap={1}>{StatIcon[keys[0]]}{KeyMap.getStr(keys[0])}</Box> :\n        <DropdownButton sx={{ px: 0 }} fullWidth title={<StatWithUnit statKey={statKey} />} color={KeyMap.getVariant(statKey) ?? \"success\"}>\n          {keys.map(msk =>\n            <MenuItem key={msk} disabled={statKey === msk} onClick={() => setSlot({ statKey: msk })}>\n              <StatColoredWithUnit statKey={msk} />\n            </MenuItem>)}\n        </DropdownButton>}\n    </CardDark>\n    <DropdownButton sx={{ px: 0 }} title={<span>{rarity} <FontAwesomeIcon icon={faStar} /></span>} >\n      {[5, 4, 3].map(r =>\n        <MenuItem key={r} disabled={rarity === r} onClick={() => setRarity(r as ArtifactRarity)}>\n          <span>{r} <FontAwesomeIcon icon={faStar} /></span>\n        </MenuItem>)}\n    </DropdownButton>\n    <CustomNumberInput startAdornment=\"+\" value={level} color={Artifact.levelVariant(level)} onChange={l => l !== undefined && setSlot({ level: l })} sx={{ borderRadius: 1, pl: 1, my: 0, height: \"100%\" }} inputProps={{ sx: { pl: 0.5, width: \"2em\" }, max: 20, min: 0 }} />\n    <CardDark sx={{ height: \"100%\", minWidth: \"4em\" }}>\n      <Box p={1} textAlign=\"center\">{`${cacheValueString(Artifact.mainStatValue(statKey, rarity, level), KeyMap.unit(statKey))}${KeyMap.unit(statKey)}`}</Box>\n    </CardDark>\n  </Box>\n}\n\nfunction ArtifactSetsEditor({ artSet, setArtSet }: { artSet: ISet, setArtSet(artSet: ISet) }) {\n  const artifactSheets = usePromise(() => ArtifactSheet.getAll, [])\n  const setSet = useCallback((setKey: ArtifactSetKey | \"\") => {\n    if (!setKey || !artifactSheets) return\n    setArtSet({ ...artSet, [setKey]: parseInt(Object.keys(artifactSheets(setKey).setEffects)[0]) })\n  }, [artSet, setArtSet, artifactSheets])\n\n  const setValue = useCallback((setKey: ArtifactSetKey) => (value: 1 | 2 | 4) => setArtSet({ ...artSet, [setKey]: value }), [artSet, setArtSet])\n  const deleteValue = useCallback((setKey: ArtifactSetKey) => () => {\n    const { [setKey]: _, ...rest } = artSet\n    setArtSet({ ...rest })\n  }, [artSet, setArtSet])\n\n  const remaining = 5 - Object.values(artSet).reduce((a, b) => a + b, 0)\n\n  return <Stack spacing={1} sx={{ flexGrow: 1 }}>\n    {Object.entries(artSet).map(([setKey, value]) => <ArtifactSetEditor key={setKey} setKey={setKey} value={value} setValue={setValue(setKey)} deleteValue={deleteValue(setKey)} remaining={remaining} />)}\n    <CardLight sx={{ flexGrow: 1 }}>\n      <ArtifactSetSingleAutocomplete\n        showDefault\n        disableClearable\n        size=\"small\"\n        artSetKey={\"\"}\n        setArtSetKey={setSet}\n        sx={(theme) => ({\n          flexGrow: 1,\n          \".MuiFilledInput-root\": {\n            borderBottomRightRadius: theme.shape.borderRadius,\n            borderBottomLeftRadius: theme.shape.borderRadius\n          }\n        })}\n        defaultText={\"New Artifact Set\"}\n        disable={(setKey) => Object.keys(artSet).includes(setKey) || !artifactSheets?.(setKey) || Object.keys(artifactSheets(setKey).setEffects).every(n => parseInt(n) > remaining)}\n      />\n    </CardLight>\n\n  </Stack>\n}\nfunction ArtifactSetEditor({ setKey, value, setValue, deleteValue, remaining }: { setKey: ArtifactSetKey, value: 1 | 2 | 4, setValue: (v: 1 | 2 | 4) => void, deleteValue: () => void, remaining: number }) {\n  const artifactSheet = usePromise(() => ArtifactSheet.get(setKey), [])\n\n  /* Assumes that all conditionals are from 4-Set. needs to change if there are 2-Set conditionals */\n  const set4CondNums = useMemo(() => {\n    if (value < 4 || !artifactSheet) return []\n    return Object.keys(artifactSheet.setEffects).filter(setNumKey => artifactSheet.setEffects[setNumKey]?.document.some(doc => \"states\" in doc))\n  }, [artifactSheet, value])\n\n  if (!artifactSheet) return null\n  return <CardLight>\n    <Box display=\"flex\">\n      <ArtifactSetTooltip artifactSheet={artifactSheet} numInSet={value}>\n        <Box flexGrow={1} p={1} display=\"flex\" gap={1} alignItems=\"center\">\n          <ImgIcon size={2} sx={{ m: -1 }} src={artifactSheet.defIconSrc} />\n          <Box >{artifactSheet.setName}</Box>\n          <Info />\n        </Box>\n      </ArtifactSetTooltip>\n      <ButtonGroup>\n        <DropdownButton size=\"small\" title={<Box whiteSpace=\"nowrap\">{value}-set</Box>}>\n          {Object.keys(artifactSheet.setEffects).map(setKey => parseInt(setKey)).map(setKey =>\n            <MenuItem key={setKey} disabled={value === setKey || setKey > (remaining + value)} onClick={() => setValue(setKey as 1 | 2 | 4)}>{setKey}-set</MenuItem>\n          )}\n        </DropdownButton>\n        <Button color=\"error\" size=\"small\" onClick={deleteValue}>\n          <DeleteForever />\n        </Button>\n      </ButtonGroup>\n    </Box>\n    {!!set4CondNums.length && <Stack spacing={1} sx={{ p: 1 }}>\n      {set4CondNums.map(setNumKey =>\n        <SetEffectDisplay key={setNumKey} setKey={setKey} setNumKey={parseInt(setNumKey) as SetNum} hideHeader conditionalsOnly />\n      )}\n    </Stack>}\n  </CardLight>\n}\nfunction ArtifactSubCard({ substats, setSubstats, substatsType, setSubstatsType, mainStatKeys }: { substats: Record<SubstatKey, number>, setSubstats: (substats: Record<SubstatKey, number>) => void, substatsType: SubstatType, setSubstatsType: (t: SubstatType) => void, mainStatKeys: MainStatKey[] }) {\n  const setValue = useCallback((key: SubstatKey) => (v: number) => setSubstats({ ...substats, [key]: v }), [substats, setSubstats])\n  const { t } = useTranslation(\"page_character\")\n  const rv = Object.entries(substats).reduce((t, [k, v]) => t + (v / Artifact.substatValue(k)), 0) * 100\n  const rolls = Object.entries(substats).reduce((t, [k, v]) => t + (v / Artifact.substatValue(k, undefined, substatsType)), 0)\n  return <CardLight sx={{ p: 1, height: \"100%\" }}>\n    <Box sx={{ mb: 1, display: \"flex\", gap: 1 }}>\n      <DropdownButton fullWidth title={t(`tabTheorycraft.substatType.${substatsType}`)}>\n        {substatType.map(st => <MenuItem key={st} disabled={substatsType === st} onClick={() => setSubstatsType(st)}>{t(`tabTheorycraft.substatType.${st}`)}</MenuItem>)}\n      </DropdownButton>\n      <BootstrapTooltip title={<Typography>{t`tabTheorycraft.maxTotalRolls`}</Typography>} placement=\"top\">\n        <CardDark sx={{ textAlign: \"center\", py: 0.5, px: 1, minWidth: \"15em\", whiteSpace: \"nowrap\", display: \"flex\", gap: 2, justifyContent: \"flex-end\", alignItems: \"center\" }}>\n          <ColorText color={rolls > 45 ? \"warning\" : undefined} >Rolls: <strong>{rolls.toFixed(0)}</strong></ColorText>\n          <ColorText color={rolls > 45 ? \"warning\" : undefined} >RV: <strong>{rv.toFixed(1)}%</strong></ColorText>\n        </CardDark>\n      </BootstrapTooltip>\n    </Box>\n    <Stack spacing={1}>\n      {Object.entries(substats).map(([k, v]) => <ArtifactSubstatEditor key={k} statKey={k} value={v} setValue={setValue(k)} substatsType={substatsType} mainStatKeys={mainStatKeys} />)}\n    </Stack>\n  </CardLight>\n}\nfunction ArtifactSubstatEditor({ statKey, value, setValue, substatsType, mainStatKeys }: { statKey: SubstatKey, value: number, setValue: (v: number) => void, substatsType: SubstatType, mainStatKeys: MainStatKey[] }) {\n  const { t } = useTranslation(\"page_character\")\n  const substatValue = Artifact.substatValue(statKey, 5, substatsType)\n  const [rolls, setRolls] = useState(() => value / substatValue)\n  useEffect(() => setRolls(value / substatValue), [value, substatValue])\n\n  const unit = KeyMap.unit(statKey)\n  const displayValue = rolls * substatValue\n\n  const rv = (rolls * substatValue) / Artifact.substatValue(statKey) * 100\n  const numMains = mainStatKeys.reduce((t, ms) => t + (ms === statKey ? 1 : 0), 0)\n  const maxRolls = (5 - numMains) * 6\n  // 0.0001 to nudge float comparasion\n  const invalid = (rolls - 0.0001) > maxRolls\n  const setRValue = useCallback((r: number) => setValue(r * substatValue), [setValue, substatValue])\n\n  return <Stack spacing={0.5}>\n    <Box display=\"flex\" gap={1} justifyContent=\"space-between\" alignItems=\"center\">\n      <CardDark sx={{ p: 0.5, minWidth: \"11em\", flexGrow: 1, display: \"flex\", gap: 1, alignItems: \"center\", justifyContent: \"center\" }}>\n        {StatIcon[statKey]}{KeyMap.getStr(statKey)}{KeyMap.unit(statKey)}\n      </CardDark>\n      <BootstrapTooltip title={<Typography>{t(numMains ? `tabTheorycraft.maxRollsMain` : `tabTheorycraft.maxRolls`, { value: maxRolls })}</Typography>} placement=\"top\">\n        <CardDark sx={{ textAlign: \"center\", p: 0.5, minWidth: \"8em\" }}>\n          <ColorText color={invalid ? \"warning\" : undefined}>RV: <strong>{rv.toFixed(1)}%</strong></ColorText>\n        </CardDark>\n      </BootstrapTooltip>\n    </Box>\n    <Box display=\"flex\" gap={1} justifyContent=\"space-between\" alignItems=\"center\">\n      <CustomNumberInput\n        color={displayValue ? \"success\" : \"primary\"}\n        float={KeyMap.unit(statKey) === \"%\"}\n        endAdornment={KeyMap.unit(statKey) || <Box width=\"1em\" component=\"span\" />}\n        value={parseFloat(displayValue.toFixed(2))}\n        onChange={v => v !== undefined && setValue(v)}\n        sx={{ borderRadius: 1, px: 1, height: \"100%\", width: \"6em\" }}\n        inputProps={{ sx: { textAlign: \"right\" }, min: 0 }} />\n      <CardDark sx={{ px: 2, flexGrow: 1, display: \"flex\", gap: 1, alignItems: \"center\", justifyContent: \"center\" }}>\n        <Slider\n          size=\"small\"\n          value={rolls}\n          max={maxRolls}\n          min={0}\n          step={1}\n          marks\n          onChange={(e, v) => setRolls(v as number)}\n          onChangeCommitted={(e, v) => setRValue(v as number)}\n        />\n      </CardDark>\n      <CustomNumberInput\n        color={value ? (invalid ? \"warning\" : \"success\") : \"primary\"}\n        float\n        startAdornment={<Box sx={{ whiteSpace: \"nowrap\", width: \"7em\", display: \"flex\", justifyContent: \"space-between\" }}><span>{cacheValueString(substatValue, unit)}{unit}</span><span>x</span></Box>}\n        value={parseFloat(rolls.toFixed(2))}\n        onChange={v => v !== undefined && setValue(v * substatValue)}\n        sx={{ borderRadius: 1, px: 1, my: 0, height: \"100%\", width: \"7em\" }}\n        inputProps={{ sx: { textAlign: \"right\", pr: 0.5, }, min: 0, step: 1 }} />\n    </Box>\n  </Stack>\n}\n","import { useContext, useEffect, useState } from \"react\"\nimport { DatabaseContext } from \"../../../../Database/Database\"\nimport { CharacterKey, WeaponKey } from \"../../../../Types/consts\"\n\nexport default function useCharTC(characterKey: CharacterKey, defWeapon: WeaponKey) {\n  const { database } = useContext(DatabaseContext)\n  const [charTC, setCharTC] = useState(() => database.charTCs.getWithInit(characterKey, defWeapon))\n  useEffect(() => setCharTC(database.charTCs.getWithInit(characterKey, defWeapon)), [database, characterKey, defWeapon])\n  useEffect(() =>\n    characterKey ? database.charTCs.follow(characterKey, (k, r, v) => r === \"update\" && setCharTC(v)) : undefined,\n    [characterKey, setCharTC, database])\n  return charTC\n}\n","import { MenuItem } from '@mui/material';\nimport { useContext } from 'react';\nimport ColorText from '../../Components/ColoredText';\nimport DropdownButton from '../../Components/DropdownMenu/DropdownButton';\nimport { CharacterContext } from '../../Context/CharacterContext';\nimport { stg } from '../../Data/SheetUtil';\nimport useCharSelectionCallback from '../../ReactHooks/useCharSelectionCallback';\nimport { allElements, travelerElements, TravelerKey, TravelerToElement } from '../../Types/consts';\n\nexport default function TravelerElementSelect() {\n  const { character } = useContext(CharacterContext)\n  const { key } = character\n  const setCharacter = useCharSelectionCallback()\n  if (!(key.startsWith(\"Traveler\"))) return null\n\n  const elementKey = allElements.find(e => key.toLowerCase().includes(e))!\n\n  return <DropdownButton color={elementKey} title={<strong>{stg(`element.${elementKey}`)}</strong>}>\n    {travelerElements.map(eleKey =>\n      <MenuItem key={eleKey} selected={elementKey === eleKey} disabled={elementKey === eleKey} onClick={() => setCharacter(TravelerToElement(key as TravelerKey, eleKey))}>\n        <strong><ColorText color={eleKey}>{stg(`element.${eleKey}`)}</ColorText></strong></MenuItem>)}\n  </DropdownButton>\n}\n","import { Female, Male } from '@mui/icons-material';\nimport { Button } from '@mui/material';\nimport { useCallback, useContext } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { CharacterContext } from '../../Context/CharacterContext';\nimport { DatabaseContext } from '../../Database/Database';\nimport useDBMeta from '../../ReactHooks/useDBMeta';\n\nexport default function TravelerGenderSelect() {\n  const { t } = useTranslation(\"ui\")\n  const { database } = useContext(DatabaseContext)\n  const { character } = useContext(CharacterContext)\n  const { key } = character\n  const { gender } = useDBMeta()\n  const toggleGender = useCallback(() => database.dbMeta.set({ gender: gender === \"F\" ? \"M\" : \"F\" }), [gender, database])\n  if (!(key.startsWith(\"Traveler\"))) return null\n  return <Button onClick={toggleGender} startIcon={gender === \"F\" ? <Female /> : <Male />}><strong>{t(`gender.${gender}`)}</strong>  </Button>\n}\n","import { BarChart, Calculate, FactCheck, Groups, Person, Science, TrendingUp } from '@mui/icons-material';\nimport { Box, Button, CardContent, Skeleton, Tab, Tabs } from '@mui/material';\nimport { Suspense, useCallback, useContext, useEffect, useMemo, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Link as RouterLink, Navigate, Route, Routes, useMatch, useNavigate, useParams } from 'react-router-dom';\nimport CardDark from '../../Components/Card/CardDark';\nimport CardLight from '../../Components/Card/CardLight';\nimport CloseButton from '../../Components/CloseButton';\nimport { HitModeToggle, InfusionAuraDropdown, ReactionToggle } from '../../Components/HitModeEditor';\nimport LevelSelect from '../../Components/LevelSelect';\nimport SqBadge from '../../Components/SqBadge';\nimport { CharacterContext, CharacterContextObj } from '../../Context/CharacterContext';\nimport { DataContext, dataContextObj } from '../../Context/DataContext';\nimport { FormulaDataContext, FormulaDataWrapper } from '../../Context/FormulaDataContext';\nimport { ChartData, GraphContext, GraphContextObj } from '../../Context/GraphContext';\nimport CharacterSheet from '../../Data/Characters/CharacterSheet';\nimport { DatabaseContext } from '../../Database/Database';\nimport useBoolState from '../../ReactHooks/useBoolState';\nimport useCharacter from '../../ReactHooks/useCharacter';\nimport useCharacterReducer from '../../ReactHooks/useCharacterReducer';\nimport useDBMeta from '../../ReactHooks/useDBMeta';\nimport usePromise from '../../ReactHooks/usePromise';\nimport useTeamData from '../../ReactHooks/useTeamData';\nimport useTitle from '../../ReactHooks/useTitle';\nimport { CharacterKey, charKeyToCharName } from '../../Types/consts';\nimport { CustomMultiTargetButton } from '../CustomMultiTarget';\nimport CharSelectDropdown from './CharSelectDropdown';\nimport FormulaModal from './FormulaModal';\nimport StatModal from './StatModal';\nimport TabBuild from './Tabs/TabOptimize';\nimport TabOverview from './Tabs/TabOverview';\nimport TabTalent from './Tabs/TabTalent';\nimport TabTeambuffs from './Tabs/TabTeambuffs';\nimport TabTheorycraft from './Tabs/TabTheorycraft';\nimport TravelerElementSelect from './TravelerElementSelect';\nimport TravelerGenderSelect from './TravelerGenderSelect';\n\nexport default function CharacterDisplay() {\n  const navigate = useNavigate();\n  const { database } = useContext(DatabaseContext)\n  const onClose = useCallback(() => navigate(\"/characters\"), [navigate])\n  let { characterKey } = useParams<{ characterKey?: CharacterKey }>();\n  const invalidKey = !database.chars.keys.includes(characterKey as CharacterKey)\n  if (invalidKey)\n    return <Navigate to=\"/characters\" />\n\n  return <Box my={1} display=\"flex\" flexDirection=\"column\" gap={1}>\n    <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={1000} />}>\n      {characterKey && <CharacterDisplayCard characterKey={characterKey} onClose={onClose} />}\n    </Suspense>\n  </Box>\n}\n\ntype CharacterDisplayCardProps = {\n  characterKey: CharacterKey,\n  onClose?: () => void,\n}\nfunction CharacterDisplayCard({ characterKey, onClose }: CharacterDisplayCardProps) {\n  const character = useCharacter(characterKey)\n  const { gender } = useDBMeta()\n  const characterSheet = usePromise(() => CharacterSheet.get(characterKey, gender), [characterKey, gender])\n  const teamData = useTeamData(characterKey)\n  const { target: charUIData } = teamData?.[characterKey] ?? {}\n  let { params: { tab = \"overview\" } } = useMatch({ path: \"/characters/:charKey/:tab\", end: false }) ?? { params: { tab: \"overview\" } }\n  const { t } = useTranslation([\"charNames_gen\", \"page_character\"])\n\n  useTitle(useMemo(() => `${t(`charNames_gen:${charKeyToCharName(characterKey, gender)}`)} - ${t(`page_character:tabs.${tab}`)}`, [t, characterKey, gender, tab]))\n\n  const characterDispatch = useCharacterReducer(character?.key ?? \"\")\n\n  const dataContextValue: dataContextObj | undefined = useMemo(() => {\n    if (!teamData || !charUIData) return undefined\n    return {\n      data: charUIData,\n      teamData,\n      oldData: undefined,\n    }\n  }, [charUIData, teamData])\n\n  const characterContextValue: CharacterContextObj | undefined = useMemo(() => {\n    if (!character || !characterSheet) return undefined\n    return {\n      character,\n      characterSheet,\n      characterDispatch\n    }\n  }, [character, characterSheet, characterDispatch])\n\n  const [chartData, setChartData] = useState(undefined as ChartData | undefined)\n  const [graphBuilds, setGraphBuilds] = useState<string[][]>()\n  const graphContextValue: GraphContextObj | undefined = useMemo(() => {\n    return {\n      chartData,\n      setChartData,\n      graphBuilds,\n      setGraphBuilds\n    }\n  }, [chartData, graphBuilds])\n\n  // Clear state when switching characters\n  useEffect(() => {\n    setChartData(undefined)\n    setGraphBuilds(undefined)\n  }, [characterKey])\n\n  return <CardDark >\n    {dataContextValue && characterContextValue && graphContextValue\n      ? <CharacterContext.Provider value={characterContextValue}><DataContext.Provider value={dataContextValue}><GraphContext.Provider value={graphContextValue}>\n        <FormulaDataWrapper><CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\n          <Box display=\"flex\" >\n            <Box display=\"flex\" gap={1} flexWrap=\"wrap\" flexGrow={1}>\n              <CharSelectDropdown />\n              <TravelerElementSelect />\n              <TravelerGenderSelect />\n              <DetailStatButton />\n              <CustomMultiTargetButton />\n              <FormulasButton />\n            </Box>\n            {!!onClose && <CloseButton onClick={onClose} />}\n          </Box>\n          <Box display=\"flex\" gap={1} flexWrap=\"wrap\">\n            {character && <LevelSelect level={character.level} ascension={character.ascension} setBoth={characterDispatch} />}\n            <HitModeToggle size=\"small\" />\n            <InfusionAuraDropdown />\n            <ReactionToggle size=\"small\" />\n          </Box>\n          <CardLight>\n            <TabNav tab={tab} />\n          </CardLight>\n          <CharacterPanel />\n          <CardLight>\n            <TabNav tab={tab} />\n          </CardLight>\n        </CardContent></FormulaDataWrapper>\n      </GraphContext.Provider></DataContext.Provider></CharacterContext.Provider>\n      : <Skeleton variant='rectangular' width='100%' height={1000} />\n    }\n  </CardDark >\n}\nfunction CharacterPanel() {\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" width=\"100%\" height={500} />}>\n    <Routes>\n      {/* Character Panel */}\n      <Route index element={<TabOverview />} />\n      <Route path=\"/talent\" element={<TabTalent />} />\n      <Route path=\"/teambuffs\" element={<TabTeambuffs />} />\n      <Route path=\"/optimize\" element={<TabBuild />} />\n      <Route path=\"/theorycraft\" element={<TabTheorycraft />} />\n    </Routes>\n  </Suspense>\n}\nfunction TabNav({ tab }: { tab: string }) {\n  const { t } = useTranslation(\"page_character\")\n  return <Tabs\n    value={tab}\n    variant=\"scrollable\"\n    allowScrollButtonsMobile\n    sx={{\n      \"& .MuiTab-root:hover\": {\n        transition: \"background-color 0.25s ease\",\n        backgroundColor: \"rgba(255,255,255,0.1)\"\n      },\n    }}\n  >\n    <Tab sx={{ minWidth: \"20%\" }} value=\"overview\" label={t(\"tabs.overview\")} icon={<Person />} component={RouterLink} to=\"\" />\n    <Tab sx={{ minWidth: \"20%\" }} value=\"talent\" label={t(\"tabs.talent\")} icon={<FactCheck />} component={RouterLink} to=\"talent\" />\n    <Tab sx={{ minWidth: \"20%\" }} value=\"teambuffs\" label={t(\"tabs.teambuffs\")} icon={<Groups />} component={RouterLink} to=\"teambuffs\" />\n    <Tab sx={{ minWidth: \"20%\" }} value=\"optimize\" label={t(\"tabs.optimize\")} icon={<TrendingUp />} component={RouterLink} to=\"optimize\" />\n    <Tab sx={{ minWidth: \"20%\" }} value=\"theorycraft\" label={t(\"tabs.theorycraft\")} icon={<Science />} component={RouterLink} to=\"theorycraft\" />\n  </Tabs>\n}\n\n\nfunction DetailStatButton() {\n  const { t } = useTranslation(\"page_character\")\n  const [open, onOpen, onClose] = useBoolState()\n  const { character: { bonusStats } } = useContext(CharacterContext)\n  const bStatsNum = Object.keys(bonusStats).length\n  return <>\n    <Button color=\"info\" startIcon={<BarChart />} onClick={onOpen}>\n      {t`addStats.title`}{!!bStatsNum && <SqBadge sx={{ ml: 1 }} color=\"success\" >{bStatsNum}</SqBadge>}\n    </Button>\n    <StatModal open={open} onClose={onClose} />\n  </>\n}\nfunction FormulasButton() {\n  const { onModalOpen } = useContext(FormulaDataContext)\n  return <>\n    <Button color=\"info\" startIcon={<Calculate />} onClick={onModalOpen}>Formulas {\"&\"} Calcs</Button>\n    <FormulaModal />\n  </>\n}\n","import { faEdit, faTrashAlt } from \"@fortawesome/free-solid-svg-icons\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { Lock, LockOpen } from \"@mui/icons-material\"\nimport { Box, Button, ButtonGroup, CardActionArea, CardContent, IconButton, Skeleton, Tooltip, Typography } from \"@mui/material\"\nimport { Suspense, useCallback, useContext, useMemo } from \"react\"\nimport { useTranslation } from \"react-i18next\"\nimport Assets from \"../Assets/Assets\"\nimport CardLight from \"../Components/Card/CardLight\"\nimport { LocationAutocomplete } from \"../Components/Character/LocationAutocomplete\"\nimport LocationName from \"../Components/Character/LocationName\"\nimport ConditionalWrapper from \"../Components/ConditionalWrapper\"\nimport ImgIcon from \"../Components/Image/ImgIcon\"\nimport { StarsDisplay } from \"../Components/StarDisplay\"\nimport CharacterSheet from \"../Data/Characters/CharacterSheet\"\nimport { ascensionMaxLevel } from \"../Data/LevelData\"\nimport WeaponSheet from \"../Data/Weapons/WeaponSheet\"\nimport { DatabaseContext } from \"../Database/Database\"\nimport { uiInput as input } from \"../Formula\"\nimport { computeUIData, dataObjForWeapon } from \"../Formula/api\"\nimport { nodeVStr } from \"../Formula/uiData\"\nimport usePromise from \"../ReactHooks/usePromise\"\nimport useWeapon from \"../ReactHooks/useWeapon\"\nimport { LocationKey } from \"../Types/consts\"\n\ntype WeaponCardProps = { weaponId: string, onClick?: (weaponId: string) => void, onEdit?: (weaponId: string) => void, onDelete?: (weaponId: string) => void, canEquip?: boolean, extraButtons?: JSX.Element }\nexport default function WeaponCard({ weaponId, onClick, onEdit, onDelete, canEquip = false, extraButtons }: WeaponCardProps) {\n  const { t } = useTranslation([\"page_weapon\", \"ui\"]);\n  const { database } = useContext(DatabaseContext)\n  const databaseWeapon = useWeapon(weaponId)\n  const weapon = databaseWeapon\n  const weaponSheet = usePromise(() => weapon?.key ? WeaponSheet.get(weapon.key) : undefined, [weapon?.key])\n\n  const filter = useCallback((cs: CharacterSheet) => cs.weaponTypeKey === weaponSheet?.weaponType, [weaponSheet])\n\n  const wrapperFunc = useCallback(children => <CardActionArea onClick={() => onClick?.(weaponId)} >{children}</CardActionArea>, [onClick, weaponId],)\n  const falseWrapperFunc = useCallback(children => <Box >{children}</Box>, [])\n  const setLocation = useCallback((k: LocationKey) => weaponId && database.weapons.set(weaponId, { location: k }), [database, weaponId])\n\n  const UIData = useMemo(() => weaponSheet && weapon && computeUIData([weaponSheet.data, dataObjForWeapon(weapon)]), [weaponSheet, weapon])\n\n  if (!weapon || !weaponSheet || !UIData) return null;\n  const { level, ascension, refinement, id, location = \"\", lock } = weapon\n  const weaponTypeKey = UIData.get(input.weapon.type).value!\n  const stats = [input.weapon.main, input.weapon.sub, input.weapon.sub2].map(x => UIData.get(x))\n  const img = weaponSheet.getImg(ascension)\n\n  return <Suspense fallback={<Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\", minHeight: 300 }} />}>\n    <CardLight sx={{ height: \"100%\", display: \"flex\", flexDirection: \"column\", justifyContent: \"space-between\" }}>\n      <ConditionalWrapper condition={!!onClick} wrapper={wrapperFunc} falseWrapper={falseWrapperFunc}>\n        <Box className={`grad-${weaponSheet.rarity}star`} sx={{ position: \"relative\", pt: 2, px: 2, }}>\n          {!onClick && <IconButton color=\"primary\" onClick={() => database.weapons.set(id, { lock: !lock })} sx={{ position: \"absolute\", right: 0, bottom: 0, zIndex: 2 }}>\n            {lock ? <Lock /> : <LockOpen />}\n          </IconButton>}\n          <Box sx={{ position: \"relative\", zIndex: 1 }}>\n            <Box component=\"div\" sx={{ display: \"flex\", alignItems: \"center\", gap: 1, mb: 1 }}>\n              <ImgIcon sx={{ fontSize: \"1.5em\" }} src={Assets.weaponTypes?.[weaponTypeKey]} />\n              <Typography noWrap sx={{ textAlign: \"center\", backgroundColor: \"rgba(100,100,100,0.35)\", borderRadius: \"1em\", px: 1 }}><strong>{weaponSheet.name}</strong></Typography>\n            </Box>\n            <Typography component=\"span\" variant=\"h5\">Lv. {level}</Typography>\n            <Typography component=\"span\" variant=\"h5\" color=\"text.secondary\">/{ascensionMaxLevel[ascension]}</Typography>\n            <Typography variant=\"h6\">Refinement <strong>{refinement}</strong></Typography>\n            <Typography><StarsDisplay stars={weaponSheet.rarity} colored /></Typography>\n          </Box>\n          <Box sx={{ height: \"100%\", position: \"absolute\", right: 0, top: 0 }}>\n            <Box\n              component=\"img\"\n              src={img ?? \"\"}\n              width=\"auto\"\n              height=\"100%\"\n              sx={{ float: \"right\" }}\n            />\n          </Box>\n        </Box>\n        <CardContent>\n          {stats.map(node => {\n            if (!node.info.name) return null\n            return <Box key={JSON.stringify(node.info)} sx={{ display: \"flex\" }}>\n              <Typography flexGrow={1}>{node.info.icon} {node.info.name}</Typography>\n              <Typography>{nodeVStr(node)}</Typography>\n            </Box>\n          })}\n        </CardContent>\n      </ConditionalWrapper>\n      <Box sx={{ p: 1, display: \"flex\", gap: 1, justifyContent: \"space-between\", alignItems: \"center\" }}>\n        <Box sx={{ flexGrow: 1 }}>\n          {canEquip\n            ? <LocationAutocomplete location={location} setLocation={setLocation} filter={filter} autoCompleteProps={{ getOptionDisabled: t => !t.key, disableClearable: true }} />\n            : <LocationName location={location} />}\n        </Box>\n        <ButtonGroup sx={{ height: \"100%\" }}>\n          {!!onEdit && <Tooltip title={<Typography>{t`page_weapon:edit`}</Typography>} placement=\"top\" arrow>\n            <Button color=\"info\" onClick={() => onEdit(id)} >\n              <FontAwesomeIcon icon={faEdit} className=\"fa-fw\" />\n            </Button>\n          </Tooltip>}\n          {!!onDelete && <Button color=\"error\" onClick={() => onDelete(id)} disabled={!!location || lock} >\n            <FontAwesomeIcon icon={faTrashAlt} className=\"fa-fw\" />\n          </Button>}\n          {extraButtons}\n        </ButtonGroup>\n      </Box>\n    </CardLight>\n  </Suspense>\n}\n"],"names":["MenuItemWithImage","value","image","text","theme","isSelected","addlElement","props","MenuItem","ListItemIcon","ListItemText","primaryTypographyProps","style","fontWeight","typography","fontWeightMedium","fontWeightRegular","ArtifactMultiAutocomplete","allArtifactKeysWithGrouper","selectedArtifactKeys","setArtifactKeys","getName","getImage","label","useTheme","options","useMemo","map","key","grouper","Autocomplete","autoHighlight","multiple","disableCloseOnSelect","onChange","_","v","getOptionLabel","option","isOptionEqualToValue","renderInput","params","TextField","variant","InputLabelProps","color","palette","primary","length","type","renderOption","KeyMap","includes","renderTags","selected","getTagProps","index","element","allElementsWithPhy","ele","undefined","Chip","icon","ArtifactSetMultiAutocomplete","artSetKeys","setArtSetKeys","artifactSheets","usePromise","ArtifactSheet","t","useTranslation","allArtifactSetsAndRarities","Object","entries","flatMap","rarity","set","sort","sortByRarityAndName","defIcon","groupBy","toString","renderGroup","group","List","component","Box","ListSubheader","sx","top","stars","children","ArtifactMainStatMultiAutocomplete","mainStatKeys","setMainStatKeys","allMainStatKeys","StatIcon","ArtifactSubstatMultiAutocomplete","substatKeys","setSubstatKeys","allSubstatKeys","ArtifactSingleAutocomplete","selectedArtifactKey","setArtifactKey","disable","showDefault","defaultText","defaultIcon","concat","clearIcon","event","newValue","reason","getOptionDisabled","startAdornment","hasValue","ArtifactSetSingleAutocomplete","artSetKey","setArtSetKey","a","b","aName","i18n","bName","ArtifactLevelSlider","levelLow","levelHigh","setLow","setHigh","setBoth","dark","disabled","showLevelText","useState","sliderLow","setsliderLow","sliderHigh","setsliderHigh","setSlider","useCallback","e","TypeError","l","h","useEffect","width","display","alignItems","bgcolor","val","clamp","px","pl","inputProps","textAlign","flexGrow","mx","getAriaLabel","onChangeCommitted","valueLabelDisplay","min","max","step","marks","CardHeaderCustom","avatar","title","action","gap","p","ConditionalSelector","conditional","keys","states","SimpleConditionalSelector","ExclusiveConditionalSelector","MultipleConditionalSelector","useContext","CharacterContext","character","characterDispatch","data","DataContext","setConditional","conditionalValues","deepClone","layeredAssignment","path","deletePropPath","conditionalValue","get","stateKey","badge","getStateBadge","name","condName","getCondName","Button","fullWidth","size","borderRadius","onClick","startIcon","CheckBox","CheckBoxOutlineBlank","state","SqBadge","DropdownButton","Divider","st","ButtonGroup","orientation","disableElevation","isElement","disp","stateName","badgeColor","badgeText","ml","key18","ns","values","Translate","useBadge","ConditionalDisplay","fields","hideHeader","hideDesc","condVal","CardDark","evalIfFunc","HeaderDisplay","header","CardContent","pb","DocumentDisplay","sections","teamBuffOnly","sectionDisplays","s","i","canShow","teamBuff","SectionDisplay","section","filter","flexDirection","FieldsSectionDisplay","TextSectionDisplay","hideDivider","description","displayTitle","InfoTooltip","Typography","LevelSelect","level","ascension","useLow","ascensionMaxLevels","ascensionMaxLevelLow","ascensionMaxLevel","setLevel","maxLevelLow","maxLevel","findIndex","ascenML","setAscension","lowerAscension","contentDark","main","height","whiteSpace","ambiguousLevelLow","ambiguousLevel","milestoneLevelsLow","milestoneLevels","lv","as","RefinementDropdown","refinement","setRefinement","allRefinement","r","DisabledButton","styled","backgroundColor","secondary","TextButton","GraphContext","createContext","CharacterSelectionModal","React","CharSelectDropdown","characterSheet","showModal","setshowModal","setCharacter","useCharSelectionCallback","Suspense","fallback","show","onHide","onSelect","ThumbSide","src","thumbImgSide","FormulaModal","modalOpen","FormulaDataContext","setFormulaData","onCloseHandler","ModalWrapper","open","onClose","CardHeader","CloseButton","pt","CalculationDisplay","contextData","getDisplaySections","Skeleton","mr","mb","Nodes","FormulaCalc","displayNs","sectionKey","database","DatabaseContext","getDisplayHeader","every","isEmpty","CardLight","ImgIcon","m","node","FormulaAccordian","contextNode","expanded","setExpanded","handleChange","isExpanded","scrollRef","useRef","setTimeout","current","scrollIntoView","behavior","Accordion","ref","AccordionSummary","expandIcon","ExpandMore","info","nodeVStr","allAmpReactions","AmpReactionModeText","reaction","trigger","subVariant","AccordionDetails","formulas","subform","expand","other","IconButton","transform","marginLeft","transition","transitions","create","duration","shortest","FlexButtonGroup","StatInput","placeholder","defaultValue","onValueChange","percent","onReset","restProps","CustomNumberInput","flexBasis","float","endAdornment","flexShrink","Replay","EnemyExpandCard","setexpanded","toggle","eLvlNode","input","eDefRed","eDefIgn","enemyOverride","flexWrap","EnemyResText","justifyContent","Collapse","in","timeout","unmountOnExit","EnemyEditor","content","isFinite","bsProps","xs","md","eLvl","enemyLevel","enemyDefIgn_","enemyDefRed_","Grid","container","spacing","item","href","target","rel","contentLight","statKey","eleKey","elementImmunity","Number","MAX_VALUE","Infinity","cols","lg","StatModal","Stack","BonusStatsEditor","MainStatsCards","allInputPremodKeys","wrapperFunc","bonusStats","setFilter","columns","StatEditorList","statKeys","statFilters","setStatFilters","mainSubKeys","mainReadNodes","k","mainEditKeys","otherStatKeys","allEleDmgKeys","allEleResKeys","miscStatkeys","StatDisplayContent","nodes","extra","oldData","FieldDisplay","rn","ListItem","oldValue","JSON","stringify","specialNode","charEle","elementKey","isMelee","otherStatReadNodes","n","miscStatReadNodes","StatDisplayCard","py","OptimizationTargetContext","filterFeasiblePerm","artSetPerm","pruneAll","minimum","arts","numTop","exclusion","forced","should","deps","pruneNodeRange","reaffine","pruneOrder","pruneArtRange","count","some","x","newArts","newNodes","pruneExclusion","maxValues","mapFormulas","f","operation","operands","pass","fail","thres","threshold","forceRename","affineNodes","Set","topLevelAffine","visit","isAffine","add","forEach","op","has","dynKeys","forEachNodes","nonConst","assertUnreachable","base","nextDynKey","affine","affineMap","Map","customRead","accu","reaffineArt","stat","constantFold","dyn","objectMap","constant","fromEntries","result","objectKeyMap","allSlotKeys","slot","id","offsets","baseValue","progress","allowRainbow","rainbow","noSwitchIn","noSwitchOut","list","newList","art","otherBetterEqual","otherMaybeBetter","otherBetter","canSwitch","baseRange","wrap","artRanges","computeArtRange","otherArtRanges","addArtRange","read","newRange","computeNodeRange","nodeRange","operandRanges","newOperands","op1","op2","j","ranges","range","reads","Error","computeMinMax","allOperations","reduce","c","sum","NaN","minMaxes","Math","mergeBuilds","builds","maxNum","slice","mergePlot","plots","scale","round","plot","build","filters","_artSets","artSets","available","kind","sets","exclusionToAllowed","populateShapes","indexOfShape","check","shape","check_free","remaining","rainbows","isolated","missing","rejected","required","allowedSet","allowedCounts","counts","push","find","groupped","used","requiredRainbows","usableRainbows","delete","replacing","allowedRainbows","shapes","noFilter","SetEffectDisplay","setKey","setNumKey","conditionalsOnly","sheet","document","setEffectDocument","useBuildSetting","characterKey","buildSettings","buildSetting","setBuildSetting","follow","buildSettingDispatch","ArtifactSetConfig","dataContext","artSetExclusion","setOpen","onOpen","useForceUpdate","dbDirty","forceUpdate","followAny","artKeysByRarity","reverse","artSlotCount","slotKey","artKeys","getNumSlots","allowRainbow2","allowRainbow4","allow2","allow4","exclude2","exclude4","artifactCondCount","allArtifactSets","fakeDataContextObj","UIData","artSet","resetArtConds","tconditional","setAllExclusion","setnum","exclude","artSetExclusion_","faChartLine","className","faBan","Settings","Trans","i18nKey","AllSetAllowExcludeCard","setNum","numAllow","numExclude","gutterBottom","num","endIcon","ArtifactSetCard","slotCount","large","setExclusionSet","slots","set4CondNums","setEffects","doc","opacity","defIconSrc","paddingTop","artifactSlotIcon","parseInt","tot","levels","AssumeFullLevelToggle","mainStatAssumptionLevel","setmainStatAssumptionLevel","lvl","BonusStatsCard","bonusStatsKeys","Monospace","fontFamily","BorderLinearProgress","LinearProgress","BuildAlert","status","tested","skipped","failed","total","startTime","finishTime","characterName","hasTotal","generatingBuilds","unskipped","testedString","toLocaleString","unskippedString","skippedText","durationString","timeStringMs","performance","now","subtitle","Alert","severity","toFixed","ArtifactCardNano","artifactId","pSlotKey","showLocation","BGComponent","useArtifact","actionWrapperFunc","CardActionArea","Assets","mainStatKey","substats","location","mainStatLevel","mainStatUnit","alpha","ConditionalWrapper","condition","wrapper","position","ArtifactTooltip","slotIcons","maxHeight","maxWidth","pointerEvents","Artifact","LocationIcon","charKey","chars","LocationToCharacterKey","overflow","bottom","zIndex","BootstrapTooltip","placement","disableInteractive","cacheValueString","SubstatDisplay","numRolls","rolls","rollColor","unit","alignContent","gender","useDBMeta","CharacterSheet","marginTop","BusinessCenter","StatDisplayComponent","optimizationTarget","Masonry","sm","xl","Section","displayNsReads","nodeKey","emphasize","WeaponCardNano","weaponId","weapon","useWeapon","weaponSheet","WeaponSheet","computeUIData","dataObjForWeapon","WeaponNameTooltip","getImg","hasRefinement","WeaponStat","ArtifactSetBadges","artifacts","currentlyEquipped","setToSlots","arti","acc","curr","slotarr1","slotarr","ArtifactSetBadge","artifactSheet","numInSet","setActive","ArtifactSetTooltip","BuildDisplayItem","compareBuild","extraButtonsRight","extraButtonsLeft","equippedArtifacts","newOld","setNewOld","close","equipBuild","window","confirm","aid","charKeyToLocCharKey","weapons","statProviderContext","dataContext_","artifactIdsBySlot","artiId","weaponNano","artNanos","oldId","newId","CompareArtifactModal","BuildHeader","Checkroom","onEquip","containerProps","minWidth","ArtifactCard","canExclude","canEquip","editorProps","disableSet","disableSlot","ChevronRight","fontSize","useBuildResult","buildResult","setBuildResult","buildResultDispatch","CustomDot","cx","cy","payload","selectedPoint","radiusSelected","radiusUnselected","colorSelected","colorUnselected","y","CustomShape","fill","stroke","points","CustomTooltip","xLabel","xUnit","yLabel","yUnit","setSelectedPoint","addBuildToList","graphBuilds","tooltipProps","canAddBuild","artiIds","artifactIds","artifactsBySlot","artiObj","clickAwayHandler","active","ClickAwayListener","onClickAway","stopPropagation","direction","ArtifactCardPico","artifactObj","valueString","EnhancedPoint","trueY","highlighted","this","ChartCard","plotBase","setPlotBase","showTooltip","chartData","setGraphBuilds","showDownload","setshowDownload","showMin","setshowMin","setSliderLow","setSliderHigh","_e","displayData","downloadData","sliderMin","sliderMax","currentBuild","objectKeyValueMap","highlightedBuildsSlotMap","convertArtiIdsToArtiSlotMap","enhancedDatum","datumSlotMap","highlightedSlotMap","minimumData","point","last","pop","allData","plotBaseNode","objPathValue","getDisplay","buttonText","OptimizationTargetSelector","setTarget","Download","DataDisplay","Chart","plotNode","valueNode","Slider","valueLabelFormat","TextArea","resize","minHeight","readOnly","selectionStart","selectionEnd","optTargetColor","highlightedColor","currentColor","lineColor","chartOnClick","chartX","chartY","clickedX","clickedY","nearestDomPtData","Array","from","querySelectorAll","domPtA","domPtB","dataset","aChartX","aChartY","aDistance","sqrt","bChartX","bChartY","d","xValue","yValue","getNearestPoint","xLabelValue","getLabelFromNode","yLabelValue","ResponsiveContainer","ComposedChart","cursor","CartesianGrid","strokeDasharray","XAxis","dataKey","domain","tick","tickFormatter","Label","dy","YAxis","allowDecimals","angle","dx","Tooltip","wrapperStyle","Legend","Line","connectNulls","strokeWidth","isAnimationActive","dot","activeDot","Scatter","partialArtiSlotMap","textSuffix","artifactsSlotsToSelectMainStats","MainStatSelectionCard","MainStatSelectionCardFactory","mainStatKeySlotKey","mainStatKeySlotKey_","useMemoEq","arrayEq","numSel","mt","MainStatSelectionCardInnerFactoryAbstractBuilderMethod","OptimizationTargetEditorList","oldPath","oldIndex","statFilters_","oldPathStr","oldFilterArr","pathStr","filterArr","splice","delTarget","setTargetValue","setTargetDisabled","settings","setting","OptimizationTargetEditorItem","parse","setValue","setDisabled","buttonStyle","buildConstraintNode","isPercent","showEmptyTargets","DeleteForever","StatFilterCard","UseEquipped","useEquippedArts","useBoolState","displayOptimize","tempEquipmentPriority","equipmentPriority","setTO","to","ck","setPrio","setPrioRank","fromIndex","toIndex","arr","removePrio","addPrio","resetPrio","numAbove","indexOf","numUseEquippedChar","numUnlisted","SelectItem","rank","maxRank","setRank","onRemove","NewItem","onAdd","useCharacter","equippedWeapon","KeyboardDoubleArrowUp","KeyboardArrowUp","KeyboardArrowDown","KeyboardDoubleArrowDown","Close","CharacterCardPico","WeaponCardPico","aId","char","Add","UseExcluded","artsDirty","useExcludedArts","numExcludedArt","dynamic","setReadNodeKeys","dynamicData","compactArtifacts","allowPartial","flower","plume","goblet","circlet","sands","mainStatVal","endsWith","substat","accurateValue","factory","eq","next","TabBuild","compareData","setChartData","buildStatus","setBuildStatus","setArtsDirty","threads","defThreads","setDisplayOptimize","maxWorkers","setMaxWorkers","useCharacterReducer","onClickTeammate","noArtifact","maxBuildsToShow","buildDate","teamData","useTeamData","optimizationTargetNode","isSM","useMediaQueryUp","cancelToken","generateBuilds","getThreshold","fetchContinueWork","fetchPruningWork","fetchRequestWork","requestFilters","command","unprunedFilters","done","minCount","minFilterCount","buildValues","cantTakeList","ek","filteredArts","mainStats","split","getTeamData","workerData","uiDataForTeam","assign","mergeData","unoptimizedOptimizationTargetNode","targetNode","valueFilter","filterNode","cancelled","Promise","unoptimizedNodes","setPerms","plotBaseNumNode","prepruneArts","optimize","maxRequestFilterInFlight","Symbol","iterator","idleWorkers","splittingWorkers","workers","finalizedList","worker","Worker","URL","setup","maxBuilds","postMessage","countCommand","finalize","finalized","onmessage","source","terminate","pruned","prepruned","console","log","work","then","buildTimer","setInterval","any","all","results","clearInterval","plotData","Date","targetSelector","clownEmoji","CharacterCard","selector0","maxBuildsToShowList","selector1","selector","TrendingUp","card","SolidToggleButtonGroup","exclusive","ToggleButton","getLabel0","getLabel1","bl","BuildList","getLabel","setBuilds","ccc","Provider","Link","RouterLink","deleteBuild","builds_","DataContextWrapper","BuildItemWrapper","join","useLocation","navigate","useNavigate","toTC","paths","pathname","Science","dirty","setDirty","buildsArts","providerValue","CompareBuildButton","artId","onShow","CompareContent","arrow","Difference","newArt","artmap","dataProviderValue","numToShowMap","ArtifactFilterDisplay","lazy","ArtifactSwapModal","onChangeId","clickHandler","filterOptionReducer","slotKeys","useReducer","initialFilterOption","filterOption","filterOptionDispatch","brPt","filterConfigs","artifactFilterConfigs","artIdList","filterFunc","filterFunction","disableSlotFilter","extraButtons","rarityHandler","handleMultiSelect","allRarities","WeaponSwapModal","weaponTypeKey","weaponSheets","setRarity","searchTerm","setSearchTerm","deferredSearchTerm","useDeferredValue","weaponIdList","weaponType","weaponFilterConfigs","sortFunction","weaponSortMap","weaponSortConfigs","star","autoFocus","InputProps","WeaponCard","WeaponEditor","EquipmentSection","setweaponId","showWeapon","hideWeapon","breakpoint","useMediaQuery","breakpoints","up","weaponDoc","rvFilter","useCharMeta","deferredRvFilter","deferredRvSet","footer","LargeWeaponSwapButton","ArtifactSectionCard","onEdit","WeaponSwapButton","effFilter","ArtifactSwapButton","ArtSwapCard","SwapHoriz","hasEquipped","unequipArts","setRVFilter","charMeta","deferredrvFilter","artid","currentEfficiency","maxEfficiency","currentEfficiency_","maxEfficiency_","rvField","PercentBadge","valid","rvmField","borderBottomRightRadius","borderBottomLeftRadius","SubstatToggle","selectedKeys","field","TabOverview","onScroll","CharacterProfileCard","EquipmentRow","team","constellation","tlvl","auto","skill","burst","tBoost","favorite","left","colored","Favorite","FavoriteBorder","right","getLevelString","cardImg","tKey","Badge","badgeContent","overlap","anchorOrigin","vertical","horizontal","padding","lineHeight","getTalentOfKey","img","constellationName","talentSpacing","CharacterTalentPane","grlg","constellationCards","SkillDisplayCard","talentKey","onClickTitle","ReactionDisplay","tText","asc","enabled","talentLimits","talent","actionWrapeprFunc","setTalentLevel","newTalentLevelKey","levelBoost","talentSheet","headerAction","TabTeambuffs","TeamBuffDisplay","ResonanceDisplay","TeammateDisplay","teamBuffs","getTeamBuff","premod","enemy","teamCount","titleTypographyProps","resonanceSheets","res","desc","activeCharacterKey","teamMateKey","onClickHandler","setTeammate","dataBundle","teammateCharacterContext","teamConditional","teamMateDataContext","TeammateAutocomplete","setChar","onClickHeader","artifactChildren","CharArtifactCondDisplay","weaponChildren","CharWeaponCondDisplay","characterChildren","CharTalentCondDisplay","isTeammateCard","sn","sts","autoCompleteProps","characterSheets","toText","startsWith","charKeyToCharName","toImg","PersonAdd","pr","isFavorite","onDisable","localeCompare","GeneralAutocomplete","valueKey","clearKey","WeaponSelectionModal","TabTheorycraft","defWeapon","charTCs","getWithInit","charTC","setCharTC","useCharTC","defaultInitialWeaponKey","setData","resetData","initCharTC","setWeapon","copyFrom","eWeapon","newData","artifact","stats","locBuild","copyFromEquipped","lock","setArtifact","data_","setSubstatsType","setSubstats","deferredData","overriderArtData","overrideWeapon","charUIData","dataContextValue","dataContextValueWithOld","CopyAll","Refresh","WeaponEditorCard","ArtifactMainLevelCard","artifactData","setArtifactData","ArtifactSubCard","substatsType","weaponUIData","weaponTypeFilter","flexshrink","setSlot","artifactData_","setArtSet","ArtifactMainLevelSlot","ArtifactSetsEditor","setSlotProp","mLvl","maxArtifactLevel","FontAwesomeSvgIcon","slotIconSVG","msk","faStar","my","setSet","deleteValue","rest","ArtifactSetEditor","disableClearable","setName","Info","rv","substatType","ArtifactSubstatEditor","substatValue","setRolls","displayValue","numMains","ms","maxRolls","invalid","setRValue","parseFloat","TravelerElementSelect","allElements","toLowerCase","stg","travelerElements","TravelerToElement","TravelerGenderSelect","toggleGender","dbMeta","Female","Male","CharacterDisplay","useParams","CharacterDisplayCard","useMatch","end","tab","useTitle","characterContextValue","graphContextValue","DetailStatButton","CustomMultiTarget","FormulasButton","TabNav","CharacterPanel","Tabs","allowScrollButtonsMobile","Tab","Person","FactCheck","Groups","bStatsNum","BarChart","onModalOpen","Calculate","onDelete","cs","falseWrapperFunc","setLocation","falseWrapper","noWrap","faEdit","faTrashAlt"],"sourceRoot":""}