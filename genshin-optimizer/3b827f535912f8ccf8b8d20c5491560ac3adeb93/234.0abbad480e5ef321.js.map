{"version":3,"file":"234.0abbad480e5ef321.js","mappings":"4QAYMA,GAAoBC,EAAAA,EAAAA,GAAkB,IAAIC,EAAAA,KACjC,SAASC,EAAa,GAA0D,IAA1D,MAAEC,EAAK,OAAEC,EAAM,SAAEC,GAAuC,EAA1BC,GAAK,YACtE,MAAMC,GAAQC,EAAAA,EAAAA,KACRC,IAAMC,EAAAA,EAAAA,GAAcH,EAAMI,YAAYC,GAAG,OAC/C,OAAO,QAAC,IAAsB,eAACC,WAAS,EAACV,MAAOA,GAAWG,EAAK,UAC7DL,EAAAA,GAAAA,KAAsBa,IAAE,aAAI,QAAC,IAAY,CAAUX,MAAOW,EAAIC,GAAI,CAAEC,EAAGP,EAAK,OAAIQ,EAAWC,SAAUT,EAAK,EAAI,MAAOU,QAAS,OAAQC,IAAKX,EAAK,EAAI,GAAKY,QAAS,IAAMhB,EAASN,EAAkBI,EAAOW,IAAK,WAC9M,QAAC,IAAO,CAACQ,IAAuB,OAApB,EAAEC,EAAAA,EAAAA,kBAAkB,EAAlB,EAAqBT,GAAKU,KAAM,EAAGC,YAAU,KAAG,QAAC,IAAI,CAACC,MAAOtB,EAAOU,GAAKU,KAAK,YAD9CV,EAEjC,MAEnB,C,mWCDA,MAAMa,EAAuBC,EAAAA,MAAW,IAAM,iCAExCC,GAAeC,EAAAA,EAAAA,OAAK,IAAM,yDAE1BC,EAAU,CAAEtB,GAAI,EAAGuB,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,GAC5CC,EAAe,CAAE3B,GAAI,GAAIuB,GAAI,GAAIC,GAAI,GAAIC,GAAI,GAAIC,GAAI,IAErDE,EAAWC,OAAOC,KAAKC,EAAAA,IACd,SAASC,IACtB,MAAM,EAAEC,IAAMC,EAAAA,EAAAA,IAAe,CAAC,cAAe,KAAM,qBAC7C,SAAEC,IAAaC,EAAAA,EAAAA,YAAWC,EAAAA,IACzBC,EAAOC,IAAYC,EAAAA,EAAAA,UAASL,EAASM,cAAcC,QAC1DC,EAAAA,EAAAA,YAAU,IAAMR,EAASM,cAAcG,QAAO,CAACC,EAAGC,IAAWP,EAASO,MAAU,CAACX,IAEjF,MAAOY,EAAoBC,IAAyBR,EAAAA,EAAAA,WAAS,IACtDS,EAASC,IAAeC,EAAAA,EAAAA,KACzBC,GAAeC,EAAAA,EAAAA,QAAuB,OACrCC,EAAWC,IAAgBf,EAAAA,EAAAA,UAAS,IAE3CG,EAAAA,EAAAA,YAAU,KACRa,EAAAA,GAAAA,KAAa,CAAEC,QAAS,WAAYC,KAAM,YACnCvB,EAASwB,QAAQC,WAAU,CAACC,EAAGhB,KAAa,QAANA,GAAqB,WAANA,IAAmBK,QAC9E,CAACA,EAAaf,IAEjB,MAAM2B,GAAOC,EAAAA,EAAAA,KACPC,EAAkBrC,EAAamC,GAE/BG,GAAeC,EAAAA,EAAAA,cAAYC,UAC/B,MAAMC,EAASjC,EAASwB,QAAQjB,IAAI2B,GACpC,IAAKD,EAAQ,OACb,MAAME,EAAOrC,EAAG,mBAAkBmC,EAAOC,OAEpCE,OAAOC,QAAQvC,EAAE,eAAgB,CAAEvC,MAAO4E,OAC/CnC,EAASwB,QAAQc,OAAOJ,GACpB/B,EAAMoC,eAAiBL,GACzBlC,EAASM,cAAckC,IAAI,CAAED,aAAc,KAAK,GACjD,CAACpC,EAAMoC,aAAcvC,EAAUF,IAE5B2C,GAAaV,EAAAA,EAAAA,cAAaG,IAC9BlC,EAASM,cAAckC,IAAI,CAAED,aAAcL,GAAM,GAChD,CAAClC,IAEE0C,GAAYX,EAAAA,EAAAA,cAAaY,IAC7BF,EAAWzC,EAASwB,QAAQoB,KAAIC,EAAAA,EAAAA,IAAcF,IAAY,GACzD,CAAC3C,EAAUyC,KAEPK,EAAYC,IAAiB1C,EAAAA,EAAAA,UAAS,IACvC2C,GAAqBC,EAAAA,EAAAA,kBAAiBH,IAEtC,SAAEI,EAAQ,UAAEC,EAAS,WAAEC,GAAU,OAAEC,IAAWlD,GAC9C,aAAEmD,GAAY,eAAEC,KAAmBC,EAAAA,EAAAA,UAAQ,KAAM,MACrD,MAAMhC,EAAUxB,EAASwB,QAAQiC,OAC3BF,EAAiB/B,EAAQkC,OACzBJ,EAAe9B,EAClBmC,QAAOC,EAAAA,EAAAA,GAAe,CAAER,cAAYC,UAAQlB,KAAMa,IAAsBa,EAAAA,EAAAA,QACxEC,MAAKC,EAAAA,EAAAA,GAAoC,OAAxB,EAACnE,EAAAA,GAAcsD,IAAS,EAAI,GAAIC,GAAWa,EAAAA,EAAAA,QAC5DC,KAAIhC,GAAUA,EAAOiC,KACxB,OAAOpD,GAAW,CAAEwC,eAAcC,iBAAgB,GACjD,CAACzC,EAASd,EAAUkD,EAAUC,EAAWE,GAAQD,GAAYJ,KAE1D,gBAAEmB,GAAe,SAAEC,GAAQ,iBAAEC,KAAqBb,EAAAA,EAAAA,UAAQ,KAC9D,MAAMY,EAAWE,KAAKC,KAAKjB,GAAaI,OAAS7B,GAC3CwC,GAAmBG,EAAAA,EAAAA,IAAMrD,EAAW,EAAGiD,EAAW,GACxD,MAAO,CAAED,gBAAiBb,GAAamB,MAAMJ,EAAmBxC,GAAkBwC,EAAmB,GAAKxC,GAAkBuC,WAAUC,mBAAkB,GACvJ,CAACf,GAAcnC,EAAWU,IAGvB6C,GAAepB,GAAaI,SAAWH,GAAkB,GAAED,GAAaI,UAAUH,KAAoB,GAAEA,KACxGoB,IAAU5C,EAAAA,EAAAA,cACd,CAAC6C,EAAyBrH,KAAkB,MACtB,OAApB,EAAA0D,EAAa4D,UAAb,EAAsBC,eAAe,CAAEC,SAAU,WACjD3D,EAAa7D,EAAQ,EAAE,GAEzB,CAAC6D,EAAcH,IAGX+D,IAAkBjD,EAAAA,EAAAA,cAAY,IAAM/B,EAASM,cAAckC,IAAI,CAAED,aAAc,MAAO,CAACvC,KAEvF,aAAEuC,IAAiBpC,GAGzBK,EAAAA,EAAAA,YAAU,KACH+B,KACAvC,EAASwB,QAAQjB,IAAIgC,KACxByC,KAAiB,GAClB,CAAChF,EAAUuC,GAAcyC,KAE5B,MAAMC,IAAezB,EAAAA,EAAAA,UAAQ,KAC3B0B,EAAAA,EAAAA,GAAS7H,EAAAA,IAAmB8H,GAAMzF,OAAO0F,QAAQpF,EAASwB,QAAQ6D,MAAMC,SAAQ,EAAEpB,EAAIjC,MACpF,MAAMsD,GAAMC,EAAAA,EAAAA,IAAevD,EAAOC,KAAKkB,WACvC+B,EAAGI,GAAKE,QACJnC,GAAaoC,SAASxB,IAAKiB,EAAGI,GAAKV,SAAS,OAC7C,CAAC7E,EAAUsD,KAEZqC,IAAqBnC,EAAAA,EAAAA,UAAQ,KACjC0B,EAAAA,EAAAA,GAASU,EAAAA,IAAaT,GAAMzF,OAAO0F,QAAQpF,EAASwB,QAAQ6D,MAAMC,SAAQ,EAAEpB,EAAIjC,MAC9E,MAAM4D,GAAKL,EAAAA,EAAAA,IAAevD,EAAOC,KAAKmB,OACtC8B,EAAGU,GAAIJ,QACHnC,GAAaoC,SAASxB,IAAKiB,EAAGU,GAAIhB,SAAS,OAC5C,CAAC7E,EAAUsD,KAElB,OAAO,QAAC,IAAG,CAACwC,GAAI,EAAGvH,QAAQ,OAAOwH,cAAc,SAASvH,IAAK,EAAE,WAC9D,QAAC,EAAAwH,SAAQ,CAACC,UAAU,EAAM,UACxB,QAAClH,EAAoB,CAACmH,KAAMtF,EAAoBuF,OAAQ,IAAMtF,GAAsB,GAAQuF,SAAU1D,OAGxG,QAAC,EAAAsD,SAAQ,CAACC,UAAU,EAAM,UACxB,QAAChH,EAAY,CACXoH,SAAU9D,GACV+D,QAAM,EACNC,QAASvB,QAIb,QAAC,IAAQ,CAACwB,IAAKvF,EAAa,UAAC,QAAC,IAAW,CAAC9C,GAAI,CAAEI,QAAS,OAAQwH,cAAe,SAAUvH,IAAK,GAAI,WACjG,QAAC,IAAG,CAACD,QAAQ,OAAOkI,SAAS,OAAOjI,IAAK,EAAGkI,WAAW,UAAS,WAC9D,QAAC,IAAY,CAACjJ,SAAU2F,GAAcpD,EAASM,cAAckC,IAAI,CAAEY,eAAe7F,MAAO6F,GAAY5F,OAAQyH,GAAcrG,KAAK,WAChI,QAAC,IAAY,CAACT,GAAI,CAAEwI,OAAQ,QAAUlJ,SAAU4F,GAAUrD,EAASM,cAAckC,IAAI,CAAEa,WAAW9F,MAAO8F,GAAQ7F,OAAQmI,GAAoB/G,KAAK,WAClJ,QAAC,IAAG,CAACgI,SAAU,KACf,QAAC,IAAS,CACRC,WAAS,EACTjI,KAAK,QACLrB,MAAOuF,EACPrF,SAAWqJ,GAAwC/D,EAAc+D,EAAEC,OAAOxJ,OAC1EuB,MAAOgB,EAAE,cACT3B,GAAI,CAAEwI,OAAQ,QACdK,WAAY,CACV7I,GAAI,CAAEwI,OAAQ,eAIpB,QAAC,IAAG,CAACpI,QAAQ,OAAO0I,eAAe,gBAAgBP,WAAW,WAAWD,SAAS,OAAM,WACtF,QAAC,IAAU,CAACS,MAAO9C,GAAU7C,KAAM8C,GAAmB,EAAG5G,SAAUkH,MACnE,QAACwC,EAAa,CAACC,WAAYjD,GAAgBT,OAAQ+B,MAAOf,GAAc5E,EAAGA,KAC3E,QAAC,IAAY,CAAC3B,GAAI,CAAEwI,OAAQ,QAAUlH,SAAUA,EAC9ClC,MAAO2F,EAAUzF,SAAUyF,GAAYlD,EAASM,cAAckC,IAAI,CAAEU,aACpEC,UAAWA,EAAWkE,YAAalE,GAAanD,EAASM,cAAckC,IAAI,CAAEW,yBAInF,QAAC,EAAA6C,SAAQ,CAACC,UAAU,QAAC,IAAQ,CAACqB,QAAQ,cAAcnJ,GAAI,CAAEoJ,MAAO,OAAQZ,OAAQ,OAAQa,UAAW,OAAU,WAC5G,QAAC,IAAM,CAACC,WAAS,EAAChJ,QAAS,IAAMoC,GAAsB,GAAO6G,MAAM,OAAOC,WAAW,QAAC,IAAG,IAAI,SAAG7H,EAAE,4BACnG,QAAC,KAAI,CAAC8H,WAAS,EAACC,QAAS,EAAG1I,QAASA,EAAQ,SAC1CgF,GAAgBF,KAAIoC,IACnB,QAAC,KAAI,CAACyB,MAAI,EAAgBjK,GAAI,EAAE,UAC9B,QAAC,IAAU,CACTwI,SAAUA,EACV0B,SAAUjG,EACVkG,OAAQvF,EACRwF,UAAQ,KALI5B,UAUrBjC,GAAW,IAAK,QAAC,IAAQ,WAAC,QAAC,IAAW,WACrC,QAAC,KAAI,CAACwD,WAAS,EAAClB,WAAW,WAAU,WACnC,QAAC,KAAI,CAACoB,MAAI,EAAClB,SAAU,EAAE,UACrB,QAAC,IAAU,CAACM,MAAO9C,GAAU7C,KAAM8C,GAAmB,EAAG5G,SAAUkH,QAErE,QAAC,KAAI,CAACmD,MAAI,YACR,QAACX,EAAa,CAACC,WAAYjD,GAAgBT,OAAQ+B,MAAOf,GAAc5E,EAAGA,eAKrF,CACA,SAASqH,GAAc,WAAEC,EAAU,MAAE3B,EAAK,IACxC,OAAO,QAAC,IAAU,CAACiC,MAAM,iBAAgB,UACvC,QAAC,KAAK,CAAC5H,EAAMoI,QAAQ,aAAahB,MAAOE,EAAY7J,MAAOkI,EAAM,UAAE,YAC1D,sBAAI,CAAEyB,MAAOE,KAAgC,WAAS,CAAE7J,MAAOkI,GAAQ,eAGrF,C,4DC7Le,SAAS0C,EAAUC,EAA+B,IAC/D,MAAM,SAAEpI,IAAaC,EAAAA,EAAAA,YAAWC,EAAAA,IACzB+B,EAAQoG,IAAahI,EAAAA,EAAAA,UAASL,EAASwB,QAAQjB,IAAI6H,IAK1D,OAJA5H,EAAAA,EAAAA,YAAU,IAAM6H,EAAUrI,EAASwB,QAAQjB,IAAI6H,KAAY,CAACpI,EAAUoI,KACtE5H,EAAAA,EAAAA,YAAU,IACR4H,EAAWpI,EAASwB,QAAQf,OAAO2H,GAAU,CAAC1G,EAAGhB,EAAG4H,IAAY,WAAN5H,GAAkB2H,EAAUC,UAAMjK,GAC5F,CAAC+J,EAAUC,EAAWrI,IACjBiC,CACT,C,kDCLO,SAASiD,EAA6CvF,EAAoB4I,GAC/E,MAAMpD,EAKR,SAAyDxF,GACvD,OAAOD,OAAO8I,YAAY7I,EAAKsE,KAAIvC,GAAK,CAACA,EAAG,CAAE+D,MAAO,EAAGZ,QAAS,MACnE,CAPa4D,CAAY9I,GAEvB,OADA4I,EAAGpD,GAQ4DuD,EAPpCvD,GAQpBwD,EAAAA,EAAAA,IAAUD,GAAK,EAAGjD,QAAOZ,aAAcA,IAAYY,EAAS,GAAEA,IAAW,GAAEZ,KAAWY,MAD/F,IAAiEiD,CANjE,C","sources":["webpack:///./src/app/Components/ToggleButton/WeaponToggle.tsx","webpack:///./src/app/PageWeapon/index.tsx","webpack:///./src/app/ReactHooks/useWeapon.tsx","webpack:///./src/app/Util/totalUtils.ts"],"sourcesContent":["import { Chip, ToggleButton, useMediaQuery, useTheme } from \"@mui/material\";\r\nimport Assets from \"../../Assets/Assets\";\r\nimport { allWeaponTypeKeys, WeaponTypeKey } from \"@genshin-optimizer/consts\";\r\nimport { handleMultiSelect } from \"../../Util/MultiSelect\";\r\nimport ImgIcon from \"../Image/ImgIcon\";\r\nimport SolidToggleButtonGroup, { SolidToggleButtonGroupProps } from \"../SolidToggleButtonGroup\";\r\ntype WeaponToggleProps = Omit<SolidToggleButtonGroupProps, \"onChange\" | \"value\"> & {\r\n  onChange: (value: WeaponTypeKey[]) => void\r\n  value: WeaponTypeKey[],\r\n  totals: Record<WeaponTypeKey, Displayable>\r\n}\r\n\r\nconst weaponTypeHandler = handleMultiSelect([...allWeaponTypeKeys])\r\nexport default function WeaponToggle({ value, totals, onChange, ...props }: WeaponToggleProps) {\r\n  const theme = useTheme();\r\n  const xs = !useMediaQuery(theme.breakpoints.up('sm'));\r\n  return <SolidToggleButtonGroup exclusive value={value} {...props}>\r\n    {allWeaponTypeKeys.map(wt => <ToggleButton key={wt} value={wt} sx={{ p: xs ? 1 : undefined, minWidth: xs ? 0 : \"7em\", display: \"flex\", gap: xs ? 0 : 1 }} onClick={() => onChange(weaponTypeHandler(value, wt))}>\r\n      <ImgIcon src={Assets.weaponTypes?.[wt]} size={2} sideMargin /><Chip label={totals[wt]} size=\"small\" />\r\n    </ToggleButton>)}\r\n  </SolidToggleButtonGroup>\r\n}\r\n","import { allRarities, allWeaponTypeKeys, WeaponKey } from '@genshin-optimizer/consts';\r\nimport { Add } from '@mui/icons-material';\r\nimport { Box, Button, CardContent, Grid, Pagination, Skeleton, TextField, Typography } from '@mui/material';\r\nimport React, { ChangeEvent, lazy, Suspense, useCallback, useContext, useDeferredValue, useEffect, useMemo, useRef, useState } from 'react';\r\nimport ReactGA from 'react-ga4';\r\nimport { Trans, useTranslation } from 'react-i18next';\r\nimport CardDark from '../Components/Card/CardDark';\r\nimport SortByButton from '../Components/SortByButton';\r\nimport RarityToggle from '../Components/ToggleButton/RarityToggle';\r\nimport WeaponToggle from '../Components/ToggleButton/WeaponToggle';\r\nimport { getWeaponSheet } from '../Data/Weapons';\r\nimport { DatabaseContext } from '../Database/Database';\r\nimport useForceUpdate from '../ReactHooks/useForceUpdate';\r\nimport useMediaQueryUp from '../ReactHooks/useMediaQueryUp';\r\nimport { filterFunction, sortFunction } from '../Util/SortByFilters';\r\nimport { catTotal } from '../Util/totalUtils';\r\nimport { clamp } from '../Util/Util';\r\nimport { weaponFilterConfigs, weaponSortConfigs, weaponSortMap } from '../Util/WeaponSort';\r\nimport { initialWeapon } from '../Util/WeaponUtil';\r\nimport WeaponCard from './WeaponCard';\r\nconst WeaponSelectionModal = React.lazy(() => import('../Components/Weapon/WeaponSelectionModal'))\r\n// Lazy load the weapon display\r\nconst WeaponEditor = lazy(() => import('./WeaponEditor'))\r\n\r\nconst columns = { xs: 1, sm: 2, md: 3, lg: 3, xl: 4 }\r\nconst numToShowMap = { xs: 10, sm: 12, md: 24, lg: 24, xl: 24 }\r\n\r\nconst sortKeys = Object.keys(weaponSortMap)\r\nexport default function PageWeapon() {\r\n  const { t } = useTranslation([\"page_weapon\", \"ui\", \"weaponNames_gen\"])\r\n  const { database } = useContext(DatabaseContext)\r\n  const [state, setState] = useState(database.displayWeapon.get())\r\n  useEffect(() => database.displayWeapon.follow((r, dbMeta) => setState(dbMeta)), [database])\r\n\r\n  const [newWeaponModalShow, setnewWeaponModalShow] = useState(false)\r\n  const [dbDirty, forceUpdate] = useForceUpdate()\r\n  const invScrollRef = useRef<HTMLDivElement>(null)\r\n  const [pageIndex, setPageIndex] = useState(0)\r\n  //set follow, should run only once\r\n  useEffect(() => {\r\n    ReactGA.send({ hitType: \"pageview\", page: '/weapon' })\r\n    return database.weapons.followAny((k, r) => (r === \"new\" || r === \"remove\") && forceUpdate())\r\n  }, [forceUpdate, database])\r\n\r\n  const brPt = useMediaQueryUp()\r\n  const maxNumToDisplay = numToShowMap[brPt]\r\n\r\n  const deleteWeapon = useCallback(async (key: string) => {\r\n    const weapon = database.weapons.get(key)\r\n    if (!weapon) return\r\n    const name = t(`weaponNames_gen:${weapon.key}`)\r\n\r\n    if (!window.confirm(t(\"removeWeapon\", { value: name }))) return\r\n    database.weapons.remove(key)\r\n    if (state.editWeaponId === key)\r\n      database.displayWeapon.set({ editWeaponId: \"\" })\r\n  }, [state.editWeaponId, database, t])\r\n\r\n  const editWeapon = useCallback((key: string | undefined) => {\r\n    database.displayWeapon.set({ editWeaponId: key })\r\n  }, [database])\r\n\r\n  const newWeapon = useCallback((weaponKey: WeaponKey) => {\r\n    editWeapon(database.weapons.new(initialWeapon(weaponKey)))\r\n  }, [database, editWeapon])\r\n\r\n  const [searchTerm, setSearchTerm] = useState(\"\")\r\n  const deferredSearchTerm = useDeferredValue(searchTerm)\r\n\r\n  const { sortType, ascending, weaponType, rarity } = state\r\n  const { weaponIdList, totalWeaponNum } = useMemo(() => {\r\n    const weapons = database.weapons.values\r\n    const totalWeaponNum = weapons.length\r\n    const weaponIdList = weapons\r\n      .filter(filterFunction({ weaponType, rarity, name: deferredSearchTerm }, weaponFilterConfigs()))\r\n      .sort(sortFunction(weaponSortMap[sortType] ?? [], ascending, weaponSortConfigs()))\r\n      .map(weapon => weapon.id)\r\n    return dbDirty && { weaponIdList, totalWeaponNum }\r\n  }, [dbDirty, database, sortType, ascending, rarity, weaponType, deferredSearchTerm])\r\n\r\n  const { weaponIdsToShow, numPages, currentPageIndex } = useMemo(() => {\r\n    const numPages = Math.ceil(weaponIdList.length / maxNumToDisplay)\r\n    const currentPageIndex = clamp(pageIndex, 0, numPages - 1)\r\n    return { weaponIdsToShow: weaponIdList.slice(currentPageIndex * maxNumToDisplay, (currentPageIndex + 1) * maxNumToDisplay), numPages, currentPageIndex }\r\n  }, [weaponIdList, pageIndex, maxNumToDisplay])\r\n\r\n  // Pagination\r\n  const totalShowing = weaponIdList.length !== totalWeaponNum ? `${weaponIdList.length}/${totalWeaponNum}` : `${totalWeaponNum}`\r\n  const setPage = useCallback(\r\n    (_: ChangeEvent<unknown>, value: number) => {\r\n      invScrollRef.current?.scrollIntoView({ behavior: \"smooth\" })\r\n      setPageIndex(value - 1);\r\n    },\r\n    [setPageIndex, invScrollRef]\r\n  )\r\n\r\n  const resetEditWeapon = useCallback(() => database.displayWeapon.set({ editWeaponId: \"\" }), [database])\r\n\r\n  const { editWeaponId } = state\r\n\r\n  // Validate weaponId to be an actual weapon\r\n  useEffect(() => {\r\n    if (!editWeaponId) return\r\n    if (!database.weapons.get(editWeaponId))\r\n      resetEditWeapon()\r\n  }, [database, editWeaponId, resetEditWeapon])\r\n\r\n  const weaponTotals = useMemo(() =>\r\n    catTotal(allWeaponTypeKeys, ct => Object.entries(database.weapons.data).forEach(([id, weapon]) => {\r\n      const wtk = getWeaponSheet(weapon.key).weaponType\r\n      ct[wtk].total++\r\n      if (weaponIdList.includes(id)) ct[wtk].current++\r\n    })), [database, weaponIdList])\r\n\r\n  const weaponRarityTotals = useMemo(() =>\r\n    catTotal(allRarities, ct => Object.entries(database.weapons.data).forEach(([id, weapon]) => {\r\n      const wr = getWeaponSheet(weapon.key).rarity\r\n      ct[wr].total++\r\n      if (weaponIdList.includes(id)) ct[wr].current++\r\n    })), [database, weaponIdList])\r\n\r\n  return <Box my={1} display=\"flex\" flexDirection=\"column\" gap={1}>\r\n    <Suspense fallback={false}>\r\n      <WeaponSelectionModal show={newWeaponModalShow} onHide={() => setnewWeaponModalShow(false)} onSelect={newWeapon} />\r\n    </Suspense>\r\n    {/* Editor/character detail display */}\r\n    <Suspense fallback={false}>\r\n      <WeaponEditor\r\n        weaponId={editWeaponId}\r\n        footer\r\n        onClose={resetEditWeapon}\r\n      />\r\n    </Suspense>\r\n\r\n    <CardDark ref={invScrollRef}><CardContent sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n      <Box display=\"flex\" flexWrap=\"wrap\" gap={1} alignItems=\"stretch\">\r\n        <WeaponToggle onChange={weaponType => database.displayWeapon.set({ weaponType })} value={weaponType} totals={weaponTotals} size=\"small\" />\r\n        <RarityToggle sx={{ height: \"100%\" }} onChange={rarity => database.displayWeapon.set({ rarity })} value={rarity} totals={weaponRarityTotals} size=\"small\" />\r\n        <Box flexGrow={1} />\r\n        <TextField\r\n          autoFocus\r\n          size=\"small\"\r\n          value={searchTerm}\r\n          onChange={(e: ChangeEvent<HTMLTextAreaElement>) => setSearchTerm(e.target.value)}\r\n          label={t(\"weaponName\")}\r\n          sx={{ height: \"100%\" }}\r\n          InputProps={{\r\n            sx: { height: \"100%\" }\r\n          }}\r\n        />\r\n      </Box>\r\n      <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"flex-end\" flexWrap=\"wrap\">\r\n        <Pagination count={numPages} page={currentPageIndex + 1} onChange={setPage} />\r\n        <ShowingWeapon numShowing={weaponIdsToShow.length} total={totalShowing} t={t} />\r\n        <SortByButton sx={{ height: \"100%\" }} sortKeys={sortKeys}\r\n          value={sortType} onChange={sortType => database.displayWeapon.set({ sortType })}\r\n          ascending={ascending} onChangeAsc={ascending => database.displayWeapon.set({ ascending })}\r\n        />\r\n      </Box>\r\n    </CardContent></CardDark>\r\n    <Suspense fallback={<Skeleton variant=\"rectangular\" sx={{ width: \"100%\", height: \"100%\", minHeight: 500 }} />}>\r\n      <Button fullWidth onClick={() => setnewWeaponModalShow(true)} color=\"info\" startIcon={<Add />} >{t(\"page_weapon:addWeapon\")}</Button>\r\n      <Grid container spacing={1} columns={columns}>\r\n        {weaponIdsToShow.map(weaponId =>\r\n          <Grid item key={weaponId} xs={1} >\r\n            <WeaponCard\r\n              weaponId={weaponId}\r\n              onDelete={deleteWeapon}\r\n              onEdit={editWeapon}\r\n              canEquip\r\n            />\r\n          </Grid>)}\r\n      </Grid>\r\n    </Suspense>\r\n    {numPages > 1 && <CardDark><CardContent>\r\n      <Grid container alignItems=\"flex-end\">\r\n        <Grid item flexGrow={1}>\r\n          <Pagination count={numPages} page={currentPageIndex + 1} onChange={setPage} />\r\n        </Grid>\r\n        <Grid item>\r\n          <ShowingWeapon numShowing={weaponIdsToShow.length} total={totalShowing} t={t} />\r\n        </Grid>\r\n      </Grid>\r\n    </CardContent></CardDark>}\r\n  </Box>\r\n}\r\nfunction ShowingWeapon({ numShowing, total, t }) {\r\n  return <Typography color=\"text.secondary\">\r\n    <Trans t={t} i18nKey=\"showingNum\" count={numShowing} value={total} >\r\n      Showing <b>{{ count: numShowing } as TransObject}</b> out of {{ value: total }} Weapons\r\n    </Trans>\r\n  </Typography>\r\n}\r\n","import { useContext, useEffect, useState } from \"react\";\r\nimport { DatabaseContext } from \"../Database/Database\";\r\n\r\nexport default function useWeapon(weaponID: string | undefined = \"\") {\r\n  const { database } = useContext(DatabaseContext)\r\n  const [weapon, setWeapon] = useState(database.weapons.get(weaponID))\r\n  useEffect(() => setWeapon(database.weapons.get(weaponID)), [database, weaponID])\r\n  useEffect(() =>\r\n    weaponID ? database.weapons.follow(weaponID, (k, r, v) => r === \"update\" && setWeapon(v)) : undefined,\r\n    [weaponID, setWeapon, database])\r\n  return weapon\r\n}\r\n","import { objectMap } from \"./Util\"\r\ntype Entry = {\r\n  total: number,\r\n  current: number,\r\n}\r\n// A helper function to generate a `current/total` formated string object with categories\r\nexport function catTotal<T extends string | number | symbol>(keys: readonly T[], cb: (ct: Record<T, Entry>) => void) {\r\n  const ct = catTotalObj(keys)\r\n  cb(ct)\r\n  return catTotalToStringObj(ct)\r\n}\r\n\r\nfunction catTotalObj<T extends string | number | symbol>(keys: readonly T[]): Record<T, Entry> {\r\n  return Object.fromEntries(keys.map(k => [k, { total: 0, current: 0 }])) as Record<T, Entry>\r\n}\r\n\r\nfunction catTotalToStringObj<T extends string | number | symbol>(tot: Record<T, Entry>) {\r\n  return objectMap(tot, ({ total, current }) => current === total ? `${total}` : `${current}/${total}`) as Record<T, string>\r\n}\r\n"],"names":["weaponTypeHandler","handleMultiSelect","allWeaponTypeKeys","WeaponToggle","value","totals","onChange","props","theme","useTheme","xs","useMediaQuery","breakpoints","up","exclusive","wt","sx","p","undefined","minWidth","display","gap","onClick","src","Assets","size","sideMargin","label","WeaponSelectionModal","React","WeaponEditor","lazy","columns","sm","md","lg","xl","numToShowMap","sortKeys","Object","keys","weaponSortMap","PageWeapon","t","useTranslation","database","useContext","DatabaseContext","state","setState","useState","displayWeapon","get","useEffect","follow","r","dbMeta","newWeaponModalShow","setnewWeaponModalShow","dbDirty","forceUpdate","useForceUpdate","invScrollRef","useRef","pageIndex","setPageIndex","ReactGA","hitType","page","weapons","followAny","k","brPt","useMediaQueryUp","maxNumToDisplay","deleteWeapon","useCallback","async","weapon","key","name","window","confirm","remove","editWeaponId","set","editWeapon","newWeapon","weaponKey","new","initialWeapon","searchTerm","setSearchTerm","deferredSearchTerm","useDeferredValue","sortType","ascending","weaponType","rarity","weaponIdList","totalWeaponNum","useMemo","values","length","filter","filterFunction","weaponFilterConfigs","sort","sortFunction","weaponSortConfigs","map","id","weaponIdsToShow","numPages","currentPageIndex","Math","ceil","clamp","slice","totalShowing","setPage","_","current","scrollIntoView","behavior","resetEditWeapon","weaponTotals","catTotal","ct","entries","data","forEach","wtk","getWeaponSheet","total","includes","weaponRarityTotals","allRarities","wr","my","flexDirection","Suspense","fallback","show","onHide","onSelect","weaponId","footer","onClose","ref","flexWrap","alignItems","height","flexGrow","autoFocus","e","target","InputProps","justifyContent","count","ShowingWeapon","numShowing","onChangeAsc","variant","width","minHeight","fullWidth","color","startIcon","container","spacing","item","onDelete","onEdit","canEquip","i18nKey","useWeapon","weaponID","setWeapon","v","cb","fromEntries","catTotalObj","tot","objectMap"],"sourceRoot":""}